<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Capítulo 3 Tidyverse | Ciencia de Datos y Machine Learning</title>
  <meta name="description" content="Capítulo 3 Tidyverse | Ciencia de Datos y Machine Learning" />
  <meta name="generator" content="bookdown 0.27 and GitBook 2.6.7" />

  <meta property="og:title" content="Capítulo 3 Tidyverse | Ciencia de Datos y Machine Learning" />
  <meta property="og:type" content="book" />
  
  <meta property="og:description" content="Capítulo 3 Tidyverse | Ciencia de Datos y Machine Learning" />
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Capítulo 3 Tidyverse | Ciencia de Datos y Machine Learning" />
  
  <meta name="twitter:description" content="Capítulo 3 Tidyverse | Ciencia de Datos y Machine Learning" />
  




  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="introducción-a-r.html"/>
<link rel="next" href="visualización.html"/>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>
<script src="libs/htmlwidgets-1.5.4/htmlwidgets.js"></script>
<link href="libs/str_view-0.1.0/str_view.css" rel="stylesheet" />
<script src="libs/str_view-binding-1.4.0/str_view.js"></script>
<script src="libs/plotly-binding-4.10.0/plotly.js"></script>
<script src="libs/typedarray-0.1/typedarray.min.js"></script>
<link href="libs/crosstalk-1.2.0/css/crosstalk.min.css" rel="stylesheet" />
<script src="libs/crosstalk-1.2.0/js/crosstalk.min.js"></script>
<link href="libs/plotly-htmlwidgets-css-2.5.1/plotly-htmlwidgets.css" rel="stylesheet" />
<script src="libs/plotly-main-2.5.1/plotly-latest.min.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./"><img src="img/aserta-logo.png" width="280"></a></li|
|:-:|  
<center>Ciencia de Datos y Machine Learning</center>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>BIENVENIDA</a>
<ul>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#objetivo"><i class="fa fa-check"></i>Objetivo</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#alcances-del-curso"><i class="fa fa-check"></i>Alcances del curso</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#instructores"><i class="fa fa-check"></i>Instructores</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#temario"><i class="fa fa-check"></i>Temario</a>
<ul>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#módulo-1-introducción-a-r-22-hrs"><i class="fa fa-check"></i>Módulo 1: Introducción a R (22 hrs)</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#módulo-2-introducción-a-ciencia-de-datos-18-hrs"><i class="fa fa-check"></i>Módulo 2: Introducción a Ciencia de Datos (18 hrs)</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#módulo-3-machine-learning-supervisado-38-hrs"><i class="fa fa-check"></i>Módulo 3: Machine Learning: Supervisado (38 hrs)</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#módulo-4-machine-learning-no-supervisado-12-hrs"><i class="fa fa-check"></i>Módulo 4: Machine Learning: No Supervisado (12 hrs)</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#requisitos"><i class="fa fa-check"></i>Requisitos</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#duración-y-evaluación-del-curso"><i class="fa fa-check"></i>Duración y evaluación del curso</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#recursos-y-dinámica-de-clase"><i class="fa fa-check"></i>Recursos y dinámica de clase</a></li>
</ul></li>
<li class="part"><span><b>Parte 1: Introducción</b></span></li>
<li class="chapter" data-level="1" data-path="conceptos-de-ciencia-de-datos.html"><a href="conceptos-de-ciencia-de-datos.html"><i class="fa fa-check"></i><b>1</b> Conceptos de Ciencia de Datos</a>
<ul>
<li class="chapter" data-level="1.1" data-path="conceptos-de-ciencia-de-datos.html"><a href="conceptos-de-ciencia-de-datos.html#qué-es-ciencia-de-datos"><i class="fa fa-check"></i><b>1.1</b> ¿Qué es Ciencia de Datos?</a>
<ul>
<li class="chapter" data-level="" data-path="conceptos-de-ciencia-de-datos.html"><a href="conceptos-de-ciencia-de-datos.html#definiendo-conceptos"><i class="fa fa-check"></i>Definiendo conceptos:</a></li>
</ul></li>
<li class="chapter" data-level="1.2" data-path="conceptos-de-ciencia-de-datos.html"><a href="conceptos-de-ciencia-de-datos.html#objetivos"><i class="fa fa-check"></i><b>1.2</b> Objetivos</a></li>
<li class="chapter" data-level="1.3" data-path="conceptos-de-ciencia-de-datos.html"><a href="conceptos-de-ciencia-de-datos.html#requisitos-1"><i class="fa fa-check"></i><b>1.3</b> Requisitos</a></li>
<li class="chapter" data-level="1.4" data-path="conceptos-de-ciencia-de-datos.html"><a href="conceptos-de-ciencia-de-datos.html#aplicaciones"><i class="fa fa-check"></i><b>1.4</b> Aplicaciones</a></li>
<li class="chapter" data-level="1.5" data-path="conceptos-de-ciencia-de-datos.html"><a href="conceptos-de-ciencia-de-datos.html#tipos-de-algoritmos"><i class="fa fa-check"></i><b>1.5</b> Tipos de algoritmos</a>
<ul>
<li class="chapter" data-level="1.5.1" data-path="conceptos-de-ciencia-de-datos.html"><a href="conceptos-de-ciencia-de-datos.html#aprendizaje-supervisado"><i class="fa fa-check"></i><b>1.5.1</b> Aprendizaje supervisado</a></li>
<li class="chapter" data-level="1.5.2" data-path="conceptos-de-ciencia-de-datos.html"><a href="conceptos-de-ciencia-de-datos.html#aprendizaje-no-supervisado"><i class="fa fa-check"></i><b>1.5.2</b> Aprendizaje no supervisado</a></li>
<li class="chapter" data-level="1.5.3" data-path="conceptos-de-ciencia-de-datos.html"><a href="conceptos-de-ciencia-de-datos.html#aprendizaje-por-refuerzo"><i class="fa fa-check"></i><b>1.5.3</b> Aprendizaje por refuerzo</a></li>
</ul></li>
<li class="chapter" data-level="1.6" data-path="conceptos-de-ciencia-de-datos.html"><a href="conceptos-de-ciencia-de-datos.html#perfiles-de-un-equipo"><i class="fa fa-check"></i><b>1.6</b> Perfiles de un equipo</a>
<ul>
<li class="chapter" data-level="" data-path="conceptos-de-ciencia-de-datos.html"><a href="conceptos-de-ciencia-de-datos.html#ingeniero-de-datos"><i class="fa fa-check"></i>1) Ingeniero de datos</a></li>
<li class="chapter" data-level="" data-path="conceptos-de-ciencia-de-datos.html"><a href="conceptos-de-ciencia-de-datos.html#decisor"><i class="fa fa-check"></i>2) Decisor</a></li>
<li class="chapter" data-level="" data-path="conceptos-de-ciencia-de-datos.html"><a href="conceptos-de-ciencia-de-datos.html#analista"><i class="fa fa-check"></i>3) Analista</a></li>
<li class="chapter" data-level="" data-path="conceptos-de-ciencia-de-datos.html"><a href="conceptos-de-ciencia-de-datos.html#analista-experto"><i class="fa fa-check"></i>4) Analista experto</a></li>
<li class="chapter" data-level="" data-path="conceptos-de-ciencia-de-datos.html"><a href="conceptos-de-ciencia-de-datos.html#estadístico"><i class="fa fa-check"></i>5) Estadístico</a></li>
<li class="chapter" data-level="" data-path="conceptos-de-ciencia-de-datos.html"><a href="conceptos-de-ciencia-de-datos.html#ingeniero-de-machine-learning"><i class="fa fa-check"></i>6) Ingeniero de Machine Learning</a></li>
<li class="chapter" data-level="" data-path="conceptos-de-ciencia-de-datos.html"><a href="conceptos-de-ciencia-de-datos.html#científico-de-datos"><i class="fa fa-check"></i>7) Científico de Datos</a></li>
<li class="chapter" data-level="" data-path="conceptos-de-ciencia-de-datos.html"><a href="conceptos-de-ciencia-de-datos.html#gerente-de-análisis-líder-de-ciencia-de-datos"><i class="fa fa-check"></i>8) Gerente de Análisis / Líder de Ciencia de Datos</a></li>
<li class="chapter" data-level="" data-path="conceptos-de-ciencia-de-datos.html"><a href="conceptos-de-ciencia-de-datos.html#experto-cualitativo-científico-social"><i class="fa fa-check"></i>9) Experto Cualitativo / Científico Social</a></li>
<li class="chapter" data-level="" data-path="conceptos-de-ciencia-de-datos.html"><a href="conceptos-de-ciencia-de-datos.html#investigador"><i class="fa fa-check"></i>10) Investigador</a></li>
<li class="chapter" data-level="" data-path="conceptos-de-ciencia-de-datos.html"><a href="conceptos-de-ciencia-de-datos.html#extra-personal-adicional"><i class="fa fa-check"></i>Extra) Personal Adicional</a></li>
<li class="chapter" data-level="" data-path="conceptos-de-ciencia-de-datos.html"><a href="conceptos-de-ciencia-de-datos.html#google-data-career-path"><i class="fa fa-check"></i>Google Data Career Path</a></li>
</ul></li>
<li class="chapter" data-level="1.7" data-path="conceptos-de-ciencia-de-datos.html"><a href="conceptos-de-ciencia-de-datos.html#flujo-de-trabajo-en-ml"><i class="fa fa-check"></i><b>1.7</b> Flujo de trabajo en <em>ML</em></a></li>
<li class="chapter" data-level="1.8" data-path="conceptos-de-ciencia-de-datos.html"><a href="conceptos-de-ciencia-de-datos.html#ciclo-de-un-proyecto"><i class="fa fa-check"></i><b>1.8</b> Ciclo de un proyecto</a></li>
<li class="chapter" data-level="1.9" data-path="conceptos-de-ciencia-de-datos.html"><a href="conceptos-de-ciencia-de-datos.html#taller-de-scoping"><i class="fa fa-check"></i><b>1.9</b> Taller de Scoping</a>
<ul>
<li class="chapter" data-level="1.9.1" data-path="conceptos-de-ciencia-de-datos.html"><a href="conceptos-de-ciencia-de-datos.html#data-maturity-framework"><i class="fa fa-check"></i><b>1.9.1</b> Data Maturity Framework</a></li>
<li class="chapter" data-level="1.9.2" data-path="conceptos-de-ciencia-de-datos.html"><a href="conceptos-de-ciencia-de-datos.html#scoping"><i class="fa fa-check"></i><b>1.9.2</b> Scoping</a></li>
<li class="chapter" data-level="" data-path="conceptos-de-ciencia-de-datos.html"><a href="conceptos-de-ciencia-de-datos.html#ejemplos"><i class="fa fa-check"></i>Ejemplos</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="2" data-path="introducción-a-r.html"><a href="introducción-a-r.html"><i class="fa fa-check"></i><b>2</b> Introducción a R</a>
<ul>
<li class="chapter" data-level="2.1" data-path="introducción-a-r.html"><a href="introducción-a-r.html#cómo-obtener-r"><i class="fa fa-check"></i><b>2.1</b> ¿Cómo obtener <em>R</em>?</a></li>
<li class="chapter" data-level="2.2" data-path="introducción-a-r.html"><a href="introducción-a-r.html#qué-es-rstudio"><i class="fa fa-check"></i><b>2.2</b> ¿Qué es RStudio?</a></li>
<li class="chapter" data-level="2.3" data-path="introducción-a-r.html"><a href="introducción-a-r.html#r-como-lenguaje-orientado-a-objetos"><i class="fa fa-check"></i><b>2.3</b> <em>R</em> como lenguaje orientado a objetos</a></li>
<li class="chapter" data-level="2.4" data-path="introducción-a-r.html"><a href="introducción-a-r.html#estructuras-de-almacenamiento"><i class="fa fa-check"></i><b>2.4</b> Estructuras de almacenamiento</a>
<ul>
<li class="chapter" data-level="2.4.1" data-path="introducción-a-r.html"><a href="introducción-a-r.html#operadores-de-asignación"><i class="fa fa-check"></i><b>2.4.1</b> Operadores de asignación</a></li>
<li class="chapter" data-level="2.4.2" data-path="introducción-a-r.html"><a href="introducción-a-r.html#variables"><i class="fa fa-check"></i><b>2.4.2</b> Variables</a></li>
<li class="chapter" data-level="2.4.3" data-path="introducción-a-r.html"><a href="introducción-a-r.html#vectores"><i class="fa fa-check"></i><b>2.4.3</b> Vectores</a></li>
<li class="chapter" data-level="2.4.4" data-path="introducción-a-r.html"><a href="introducción-a-r.html#matrices"><i class="fa fa-check"></i><b>2.4.4</b> Matrices</a></li>
<li class="chapter" data-level="2.4.5" data-path="introducción-a-r.html"><a href="introducción-a-r.html#arreglos"><i class="fa fa-check"></i><b>2.4.5</b> Arreglos</a></li>
<li class="chapter" data-level="2.4.6" data-path="introducción-a-r.html"><a href="introducción-a-r.html#data-frames"><i class="fa fa-check"></i><b>2.4.6</b> Data Frames</a></li>
<li class="chapter" data-level="2.4.7" data-path="introducción-a-r.html"><a href="introducción-a-r.html#listas"><i class="fa fa-check"></i><b>2.4.7</b> Listas</a></li>
<li class="chapter" data-level="2.4.8" data-path="introducción-a-r.html"><a href="introducción-a-r.html#ejercicios"><i class="fa fa-check"></i><b>2.4.8</b> Ejercicios</a></li>
</ul></li>
<li class="chapter" data-level="2.5" data-path="introducción-a-r.html"><a href="introducción-a-r.html#funbas"><i class="fa fa-check"></i><b>2.5</b> Funciones básicas de R</a>
<ul>
<li class="chapter" data-level="2.5.1" data-path="introducción-a-r.html"><a href="introducción-a-r.html#qué-es-una-función-de-r"><i class="fa fa-check"></i><b>2.5.1</b> ¿Qué es una función de R?</a></li>
<li class="chapter" data-level="2.5.2" data-path="introducción-a-r.html"><a href="introducción-a-r.html#operaciones-básicas"><i class="fa fa-check"></i><b>2.5.2</b> Operaciones básicas</a></li>
<li class="chapter" data-level="2.5.3" data-path="introducción-a-r.html"><a href="introducción-a-r.html#pruebas-lógicas"><i class="fa fa-check"></i><b>2.5.3</b> Pruebas lógicas</a></li>
<li class="chapter" data-level="2.5.4" data-path="introducción-a-r.html"><a href="introducción-a-r.html#operadores-lógicos"><i class="fa fa-check"></i><b>2.5.4</b> Operadores lógicos</a></li>
<li class="chapter" data-level="2.5.5" data-path="introducción-a-r.html"><a href="introducción-a-r.html#funciones-sobre-vectores"><i class="fa fa-check"></i><b>2.5.5</b> Funciones sobre vectores</a></li>
<li class="chapter" data-level="2.5.6" data-path="introducción-a-r.html"><a href="introducción-a-r.html#función-rep"><i class="fa fa-check"></i><b>2.5.6</b> Función <code>rep</code></a></li>
<li class="chapter" data-level="2.5.7" data-path="introducción-a-r.html"><a href="introducción-a-r.html#función-seq"><i class="fa fa-check"></i><b>2.5.7</b> Función <code>seq</code></a></li>
<li class="chapter" data-level="2.5.8" data-path="introducción-a-r.html"><a href="introducción-a-r.html#ejercicios-1"><i class="fa fa-check"></i><b>2.5.8</b> EJERCICIOS</a></li>
</ul></li>
<li class="chapter" data-level="2.6" data-path="introducción-a-r.html"><a href="introducción-a-r.html#bucles"><i class="fa fa-check"></i><b>2.6</b> Estructuras de control</a>
<ul>
<li class="chapter" data-level="2.6.1" data-path="introducción-a-r.html"><a href="introducción-a-r.html#instrucción-if"><i class="fa fa-check"></i><b>2.6.1</b> Instrucción <code>if</code></a></li>
<li class="chapter" data-level="2.6.2" data-path="introducción-a-r.html"><a href="introducción-a-r.html#instrucción-if-else"><i class="fa fa-check"></i><b>2.6.2</b> Instrucción <code>if</code> <code>else</code></a></li>
<li class="chapter" data-level="2.6.3" data-path="introducción-a-r.html"><a href="introducción-a-r.html#instrucción-ifelse"><i class="fa fa-check"></i><b>2.6.3</b> Instrucción <code>ifelse</code></a></li>
<li class="chapter" data-level="2.6.4" data-path="introducción-a-r.html"><a href="introducción-a-r.html#instrucción-for"><i class="fa fa-check"></i><b>2.6.4</b> Instrucción <code>for</code></a></li>
<li class="chapter" data-level="2.6.5" data-path="introducción-a-r.html"><a href="introducción-a-r.html#instrucción-while"><i class="fa fa-check"></i><b>2.6.5</b> Instrucción <code>while</code></a></li>
<li class="chapter" data-level="2.6.6" data-path="introducción-a-r.html"><a href="introducción-a-r.html#instrucción-repeat"><i class="fa fa-check"></i><b>2.6.6</b> Instrucción <code>repeat</code></a></li>
</ul></li>
<li class="chapter" data-level="2.7" data-path="introducción-a-r.html"><a href="introducción-a-r.html#estilo"><i class="fa fa-check"></i><b>2.7</b> Guía de estilo</a>
<ul>
<li class="chapter" data-level="2.7.1" data-path="introducción-a-r.html"><a href="introducción-a-r.html#nombres-de-los-archivos"><i class="fa fa-check"></i><b>2.7.1</b> Nombres de los archivos</a></li>
<li class="chapter" data-level="2.7.2" data-path="introducción-a-r.html"><a href="introducción-a-r.html#nombres-de-los-objetos"><i class="fa fa-check"></i><b>2.7.2</b> Nombres de los objetos</a></li>
<li class="chapter" data-level="2.7.3" data-path="introducción-a-r.html"><a href="introducción-a-r.html#longitud-de-una-línea-de-código"><i class="fa fa-check"></i><b>2.7.3</b> Longitud de una línea de código</a></li>
<li class="chapter" data-level="2.7.4" data-path="introducción-a-r.html"><a href="introducción-a-r.html#espacios"><i class="fa fa-check"></i><b>2.7.4</b> Espacios</a></li>
<li class="chapter" data-level="2.7.5" data-path="introducción-a-r.html"><a href="introducción-a-r.html#asignación"><i class="fa fa-check"></i><b>2.7.5</b> Asignación</a></li>
<li class="chapter" data-level="2.7.6" data-path="introducción-a-r.html"><a href="introducción-a-r.html#punto-y-coma"><i class="fa fa-check"></i><b>2.7.6</b> Punto y coma</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="3" data-path="tidyverse.html"><a href="tidyverse.html"><i class="fa fa-check"></i><b>3</b> Tidyverse</a>
<ul>
<li class="chapter" data-level="3.1" data-path="tidyverse.html"><a href="tidyverse.html#lectura-de-archivos"><i class="fa fa-check"></i><b>3.1</b> Lectura de archivos</a>
<ul>
<li class="chapter" data-level="3.1.1" data-path="tidyverse.html"><a href="tidyverse.html#archivos-csv"><i class="fa fa-check"></i><b>3.1.1</b> Archivos <em>csv</em></a></li>
<li class="chapter" data-level="3.1.2" data-path="tidyverse.html"><a href="tidyverse.html#archivos-txt"><i class="fa fa-check"></i><b>3.1.2</b> Archivos txt</a></li>
<li class="chapter" data-level="3.1.3" data-path="tidyverse.html"><a href="tidyverse.html#archivos-xls-y-xlsx"><i class="fa fa-check"></i><b>3.1.3</b> Archivos <em>xls</em> y <em>xlsx</em></a></li>
<li class="chapter" data-level="3.1.4" data-path="tidyverse.html"><a href="tidyverse.html#archivos-json"><i class="fa fa-check"></i><b>3.1.4</b> Archivos json</a></li>
<li class="chapter" data-level="3.1.5" data-path="tidyverse.html"><a href="tidyverse.html#archivos-rds"><i class="fa fa-check"></i><b>3.1.5</b> Archivos rds</a></li>
<li class="chapter" data-level="3.1.6" data-path="tidyverse.html"><a href="tidyverse.html#bases-de-datos"><i class="fa fa-check"></i><b>3.1.6</b> Bases de Datos</a></li>
<li class="chapter" data-level="3.1.7" data-path="tidyverse.html"><a href="tidyverse.html#oracle-database"><i class="fa fa-check"></i><b>3.1.7</b> Oracle Database</a></li>
</ul></li>
<li class="chapter" data-level="3.2" data-path="tidyverse.html"><a href="tidyverse.html#consultas-de-datos"><i class="fa fa-check"></i><b>3.2</b> Consultas de datos</a>
<ul>
<li class="chapter" data-level="3.2.1" data-path="tidyverse.html"><a href="tidyverse.html#seleccionar-columnas"><i class="fa fa-check"></i><b>3.2.1</b> Seleccionar columnas</a></li>
<li class="chapter" data-level="3.2.2" data-path="tidyverse.html"><a href="tidyverse.html#filtrar-observaciones"><i class="fa fa-check"></i><b>3.2.2</b> Filtrar observaciones</a></li>
<li class="chapter" data-level="3.2.3" data-path="tidyverse.html"><a href="tidyverse.html#ordenar-registros"><i class="fa fa-check"></i><b>3.2.3</b> Ordenar registros</a></li>
<li class="chapter" data-level="3.2.4" data-path="tidyverse.html"><a href="tidyverse.html#agregar-modificar"><i class="fa fa-check"></i><b>3.2.4</b> Agregar / Modificar</a></li>
<li class="chapter" data-level="3.2.5" data-path="tidyverse.html"><a href="tidyverse.html#resumen-estadístico"><i class="fa fa-check"></i><b>3.2.5</b> Resumen estadístico</a></li>
<li class="chapter" data-level="3.2.6" data-path="tidyverse.html"><a href="tidyverse.html#agrupamiento"><i class="fa fa-check"></i><b>3.2.6</b> Agrupamiento</a></li>
<li class="chapter" data-level="3.2.7" data-path="tidyverse.html"><a href="tidyverse.html#cruces-de-tablas"><i class="fa fa-check"></i><b>3.2.7</b> Cruces de tablas</a></li>
</ul></li>
<li class="chapter" data-level="3.3" data-path="tidyverse.html"><a href="tidyverse.html#orden-y-estructura"><i class="fa fa-check"></i><b>3.3</b> Orden y estructura</a>
<ul>
<li class="chapter" data-level="3.3.1" data-path="tidyverse.html"><a href="tidyverse.html#pivote-horizontal"><i class="fa fa-check"></i><b>3.3.1</b> Pivote horizontal</a></li>
<li class="chapter" data-level="3.3.2" data-path="tidyverse.html"><a href="tidyverse.html#pivote-vertical"><i class="fa fa-check"></i><b>3.3.2</b> Pivote vertical</a></li>
<li class="chapter" data-level="3.3.3" data-path="tidyverse.html"><a href="tidyverse.html#unión-de-columnas"><i class="fa fa-check"></i><b>3.3.3</b> Unión de columnas</a></li>
<li class="chapter" data-level="3.3.4" data-path="tidyverse.html"><a href="tidyverse.html#separador-de-columnas"><i class="fa fa-check"></i><b>3.3.4</b> Separador de columnas</a></li>
</ul></li>
<li class="chapter" data-level="3.4" data-path="tidyverse.html"><a href="tidyverse.html#manipulación-de-texto"><i class="fa fa-check"></i><b>3.4</b> Manipulación de texto</a>
<ul>
<li class="chapter" data-level="3.4.1" data-path="tidyverse.html"><a href="tidyverse.html#caracteres-especiales"><i class="fa fa-check"></i><b>3.4.1</b> Caracteres especiales</a></li>
<li class="chapter" data-level="3.4.2" data-path="tidyverse.html"><a href="tidyverse.html#tamaño-de-cadena"><i class="fa fa-check"></i><b>3.4.2</b> Tamaño de cadena</a></li>
<li class="chapter" data-level="3.4.3" data-path="tidyverse.html"><a href="tidyverse.html#concatenar"><i class="fa fa-check"></i><b>3.4.3</b> Concatenar</a></li>
<li class="chapter" data-level="3.4.4" data-path="tidyverse.html"><a href="tidyverse.html#extraer-y-reemplazar"><i class="fa fa-check"></i><b>3.4.4</b> Extraer y reemplazar</a></li>
<li class="chapter" data-level="3.4.5" data-path="tidyverse.html"><a href="tidyverse.html#expresiones-regulares"><i class="fa fa-check"></i><b>3.4.5</b> Expresiones regulares</a></li>
<li class="chapter" data-level="3.4.6" data-path="tidyverse.html"><a href="tidyverse.html#detectar-coincidencias"><i class="fa fa-check"></i><b>3.4.6</b> Detectar coincidencias</a></li>
<li class="chapter" data-level="3.4.7" data-path="tidyverse.html"><a href="tidyverse.html#contabilizar-coincidencias"><i class="fa fa-check"></i><b>3.4.7</b> Contabilizar coincidencias</a></li>
<li class="chapter" data-level="3.4.8" data-path="tidyverse.html"><a href="tidyverse.html#extraer-coincidencias"><i class="fa fa-check"></i><b>3.4.8</b> Extraer coincidencias</a></li>
<li class="chapter" data-level="3.4.9" data-path="tidyverse.html"><a href="tidyverse.html#reemplazar-coincidencias"><i class="fa fa-check"></i><b>3.4.9</b> Reemplazar coincidencias</a></li>
<li class="chapter" data-level="3.4.10" data-path="tidyverse.html"><a href="tidyverse.html#divisiones-mediante-patrones"><i class="fa fa-check"></i><b>3.4.10</b> Divisiones mediante patrones</a></li>
<li class="chapter" data-level="3.4.11" data-path="tidyverse.html"><a href="tidyverse.html#localización-de-coincidencias"><i class="fa fa-check"></i><b>3.4.11</b> Localización de coincidencias</a></li>
</ul></li>
<li class="chapter" data-level="3.5" data-path="tidyverse.html"><a href="tidyverse.html#manipulación-de-tiempo"><i class="fa fa-check"></i><b>3.5</b> Manipulación de tiempo</a>
<ul>
<li class="chapter" data-level="3.5.1" data-path="tidyverse.html"><a href="tidyverse.html#lectura-y-creación-de-datos-temporales"><i class="fa fa-check"></i><b>3.5.1</b> Lectura y creación de datos temporales</a></li>
<li class="chapter" data-level="3.5.2" data-path="tidyverse.html"><a href="tidyverse.html#extracción-de-datos-temporales"><i class="fa fa-check"></i><b>3.5.2</b> Extracción de datos temporales</a></li>
<li class="chapter" data-level="3.5.3" data-path="tidyverse.html"><a href="tidyverse.html#operaciones-temporales"><i class="fa fa-check"></i><b>3.5.3</b> Operaciones temporales</a></li>
</ul></li>
<li class="chapter" data-level="3.6" data-path="tidyverse.html"><a href="tidyverse.html#iteraciones"><i class="fa fa-check"></i><b>3.6</b> Iteraciones</a>
<ul>
<li class="chapter" data-level="3.6.1" data-path="tidyverse.html"><a href="tidyverse.html#bucles-1"><i class="fa fa-check"></i><b>3.6.1</b> Bucles</a></li>
<li class="chapter" data-level="3.6.2" data-path="tidyverse.html"><a href="tidyverse.html#bucles-dobles"><i class="fa fa-check"></i><b>3.6.2</b> Bucles dobles</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="4" data-path="visualización.html"><a href="visualización.html"><i class="fa fa-check"></i><b>4</b> Visualización</a>
<ul>
<li class="chapter" data-level="4.1" data-path="visualización.html"><a href="visualización.html#eda-análisis-exploratorio-de-datos"><i class="fa fa-check"></i><b>4.1</b> EDA: Análisis Exploratorio de Datos</a></li>
<li class="chapter" data-level="4.2" data-path="visualización.html"><a href="visualización.html#geda-análisis-exploratorio-de-datos-gráficos"><i class="fa fa-check"></i><b>4.2</b> GEDA: Análisis Exploratorio de Datos Gráficos</a>
<ul>
<li class="chapter" data-level="4.2.1" data-path="visualización.html"><a href="visualización.html#gráficos-univariados"><i class="fa fa-check"></i><b>4.2.1</b> Gráficos univariados:</a></li>
<li class="chapter" data-level="4.2.2" data-path="visualización.html"><a href="visualización.html#gráficos-multivariados"><i class="fa fa-check"></i><b>4.2.2</b> Gráficos multivariados</a></li>
</ul></li>
<li class="chapter" data-level="4.3" data-path="visualización.html"><a href="visualización.html#creación-de-gráficos"><i class="fa fa-check"></i><b>4.3</b> Creación de gráficos</a>
<ul>
<li class="chapter" data-level="4.3.1" data-path="visualización.html"><a href="visualización.html#estéticas"><i class="fa fa-check"></i><b>4.3.1</b> Estéticas</a></li>
<li class="chapter" data-level="4.3.2" data-path="visualización.html"><a href="visualización.html#objetos-geométricos-o-capas"><i class="fa fa-check"></i><b>4.3.2</b> Objetos geométricos o capas</a></li>
<li class="chapter" data-level="4.3.3" data-path="visualización.html"><a href="visualización.html#facetas"><i class="fa fa-check"></i><b>4.3.3</b> Facetas</a></li>
<li class="chapter" data-level="4.3.4" data-path="visualización.html"><a href="visualización.html#más-sobre-estéticas"><i class="fa fa-check"></i><b>4.3.4</b> Más sobre estéticas</a></li>
<li class="chapter" data-level="4.3.5" data-path="visualización.html"><a href="visualización.html#quick-view"><i class="fa fa-check"></i><b>4.3.5</b> Quick View</a></li>
</ul></li>
<li class="chapter" data-level="4.4" data-path="visualización.html"><a href="visualización.html#análisis-univariado"><i class="fa fa-check"></i><b>4.4</b> Análisis univariado</a>
<ul>
<li class="chapter" data-level="4.4.1" data-path="visualización.html"><a href="visualización.html#variables-numéricas"><i class="fa fa-check"></i><b>4.4.1</b> Variables numéricas</a></li>
<li class="chapter" data-level="4.4.2" data-path="visualización.html"><a href="visualización.html#variables-nominalescategóricas"><i class="fa fa-check"></i><b>4.4.2</b> Variables nominales/categóricas</a></li>
</ul></li>
<li class="chapter" data-level="4.5" data-path="visualización.html"><a href="visualización.html#análisis-multivariado"><i class="fa fa-check"></i><b>4.5</b> Análisis multivariado</a></li>
<li class="chapter" data-level="4.6" data-path="visualización.html"><a href="visualización.html#visualización-interactiva"><i class="fa fa-check"></i><b>4.6</b> Visualización interactiva</a></li>
</ul></li>
<li class="divider"></li>
<li><a href="./"><img src="img/amat-logo.png" width="280"></a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Ciencia de Datos y Machine Learning</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="tidyverse" class="section level1 hasAnchor" number="3">
<h1><span class="header-section-number">Capítulo 3</span> Tidyverse<a href="tidyverse.html#tidyverse" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<p>La compañía Rstudio ha desarrollado un conjunto de librerías que revolucionó la programación en <em>R</em>. Este conjunto de librerías permite al usuario mayor orden, legibilidad e intuición a la hora de escribir y leer código. El conjunto de librerías lleva por nombre: <strong>TIDYVERSE</strong>.</p>
<p>En este capítulo se estudiarán las distintas librerías que componen este conjunto. Cada una de las librerías puede usarse de modo independiente. En caso de que el usuario lo prefiera, puede disponer de todas las librerías al mandar ejecutar la función:</p>
<div class="sourceCode" id="cb177"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb177-1"><a href="tidyverse.html#cb177-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span></code></pre></div>
<pre><code>## ── Attaching packages ─────────────────────────────────────── tidyverse 1.3.2 ──
## ✔ ggplot2 3.3.6     ✔ purrr   0.3.4
## ✔ tibble  3.1.8     ✔ dplyr   1.0.9
## ✔ tidyr   1.2.0     ✔ stringr 1.4.0
## ✔ readr   2.1.2     ✔ forcats 0.5.1
## ── Conflicts ────────────────────────────────────────── tidyverse_conflicts() ──
## ✖ dplyr::filter() masks stats::filter()
## ✖ dplyr::lag()    masks stats::lag()</code></pre>
<div id="lectura-de-archivos" class="section level2 hasAnchor" number="3.1">
<h2><span class="header-section-number">3.1</span> Lectura de archivos<a href="tidyverse.html#lectura-de-archivos" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Usualmente, no creamos los datos desde la sesión de <em>R</em>, sino que a través de un archivo externo o una base de datos se realiza la lectura de datos. Los más comunes son:</p>
<p><img src="img/03-read-data/archivos.jpg" width="320" style="display: block; margin: auto;" /></p>
<div id="archivos-csv" class="section level3 hasAnchor" number="3.1.1">
<h3><span class="header-section-number">3.1.1</span> Archivos <em>csv</em><a href="tidyverse.html#archivos-csv" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>A la hora de importar conjuntos de datos en <em>R</em>, uno de los formatos más habituales en los que hallamos información es en archivos separados por comas (comma separated values), cuya extensión suele ser <em>.csv</em>. En ellos encontramos múltiples líneas que recogen la tabla de interés, y en las cuales los valores aparecen, de manera consecutiva, separados por el carácter <em>,</em>.</p>
<p>Para importar este tipo de archivos en nuestra sesión de <em>R</em>, se utiliza la función <code>read_csv()</code>. Para acceder a su documentación utilizamos el comando <code>?read_csv</code>.</p>
<p>El único argumento que debemos de pasar a esta función de manera obligatoria, es <code>file</code>, el nombre o la ruta completa del archivo que pretendemos importar.</p>
<div class="sourceCode" id="cb179"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb179-1"><a href="tidyverse.html#cb179-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(readr)</span>
<span id="cb179-2"><a href="tidyverse.html#cb179-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb179-3"><a href="tidyverse.html#cb179-3" aria-hidden="true" tabindex="-1"></a><span class="fu">read_csv</span>(</span>
<span id="cb179-4"><a href="tidyverse.html#cb179-4" aria-hidden="true" tabindex="-1"></a>  file,</span>
<span id="cb179-5"><a href="tidyverse.html#cb179-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">col_names =</span> <span class="cn">TRUE</span>,</span>
<span id="cb179-6"><a href="tidyverse.html#cb179-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">col_types =</span> <span class="cn">NULL</span>,</span>
<span id="cb179-7"><a href="tidyverse.html#cb179-7" aria-hidden="true" tabindex="-1"></a>  <span class="at">locale =</span> <span class="fu">default_locale</span>(),</span>
<span id="cb179-8"><a href="tidyverse.html#cb179-8" aria-hidden="true" tabindex="-1"></a>  <span class="at">na =</span> <span class="fu">c</span>(<span class="st">&quot;&quot;</span>, <span class="st">&quot;NA&quot;</span>),</span>
<span id="cb179-9"><a href="tidyverse.html#cb179-9" aria-hidden="true" tabindex="-1"></a>  <span class="at">quoted_na =</span> <span class="cn">TRUE</span>,</span>
<span id="cb179-10"><a href="tidyverse.html#cb179-10" aria-hidden="true" tabindex="-1"></a>  <span class="at">quote =</span> <span class="st">&quot;</span><span class="sc">\&quot;</span><span class="st">&quot;</span>,</span>
<span id="cb179-11"><a href="tidyverse.html#cb179-11" aria-hidden="true" tabindex="-1"></a>  <span class="at">comment =</span> <span class="st">&quot;&quot;</span>)</span></code></pre></div>
<p>La paquetería <em>readr</em> fue desarrollada recientemente para lidiar con la lectura de archivos grandes rápidamente. El paquete proporciona reemplazos para funciones como <em>read.table()</em>, <em>read.csv()</em> entre otras. Esta paquetería proporciona funciones que suelen ser mucho más rápidas que las funciones base que proporciona <em>R</em>.</p>
<p><img src="img/03-read-data/logo-readr.png" width="120" style="display: block; margin: auto;" /></p>
<p><strong>Ventajas de readr:</strong></p>
<ul>
<li><p>Por lo general, son mucho más rápidos (~ 10x) que sus funciones equivalentes.</p></li>
<li><p>Producen tibbles:</p>
<ul>
<li>No convierten vectores de caracteres en factores.</li>
<li>No usan nombres de filas ni modifican los nombres de columnas.</li>
</ul></li>
<li><p>Reproducibilidad</p></li>
<li><p>No convierte, automáticamente, las columnas con cadenas de caracteres a factores, como sí hacen por defecto las otras funciones base de <em>R</em>.</p></li>
<li><p>Reconoce ocho clases diferentes de datos (enteros, lógicos, etc.), dejando el resto como cadenas de caracteres.</p></li>
</ul>
<p>Veamos un ejemplo:</p>
<p>La base de datos llamada <a href="https://drive.google.com/file/d/1pCHFeF8rtQiUcip9zf4Xtk0pAQ-5Om-r/view?usp=sharing">AmesHousing</a> contiene un conjunto de datos con información de la Oficina del Tasador de Ames utilizada para calcular los valores tasados para las propiedades residenciales individuales vendidas en Ames, Iowa, de 2006 a 2010. FUENTES: Ames, Oficina del Tasador de Iowa.</p>
<p>Pueden descargar los datos para la clase <a href="https://drive.google.com/drive/folders/1sNlUWIvKHOTt7qywhPIyl1X00do_Y6Zo?usp=sharing">aquí</a></p>
<div class="sourceCode" id="cb180"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb180-1"><a href="tidyverse.html#cb180-1" aria-hidden="true" tabindex="-1"></a>base <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">&quot;data/ames.csv&quot;</span>) </span>
<span id="cb180-2"><a href="tidyverse.html#cb180-2" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(base, <span class="dv">2</span>)</span></code></pre></div>
<pre><code>##                           MS_SubClass                MS_Zoning Lot_Frontage
## 1 One_Story_1946_and_Newer_All_Styles  Residential_Low_Density          141
## 2 One_Story_1946_and_Newer_All_Styles Residential_High_Density           80
##   Lot_Area Street           Alley          Lot_Shape Land_Contour Utilities
## 1    31770   Pave No_Alley_Access Slightly_Irregular          Lvl    AllPub
## 2    11622   Pave No_Alley_Access            Regular          Lvl    AllPub
##   Lot_Config Land_Slope Neighborhood Condition_1 Condition_2 Bldg_Type
## 1     Corner        Gtl   North_Ames        Norm        Norm    OneFam
## 2     Inside        Gtl   North_Ames       Feedr        Norm    OneFam
##   House_Style  Overall_Cond Year_Built Year_Remod_Add Roof_Style Roof_Matl
## 1   One_Story       Average       1960           1960        Hip   CompShg
## 2   One_Story Above_Average       1961           1961      Gable   CompShg
##   Exterior_1st Exterior_2nd Mas_Vnr_Type Mas_Vnr_Area Exter_Cond Foundation
## 1      BrkFace      Plywood        Stone          112    Typical     CBlock
## 2      VinylSd      VinylSd         None            0    Typical     CBlock
##   Bsmt_Cond Bsmt_Exposure BsmtFin_Type_1 BsmtFin_SF_1 BsmtFin_Type_2
## 1      Good            Gd            BLQ            2            Unf
## 2   Typical            No            Rec            6            LwQ
##   BsmtFin_SF_2 Bsmt_Unf_SF Total_Bsmt_SF Heating Heating_QC Central_Air
## 1            0         441          1080    GasA       Fair           Y
## 2          144         270           882    GasA    Typical           Y
##   Electrical First_Flr_SF Second_Flr_SF Gr_Liv_Area Bsmt_Full_Bath
## 1      SBrkr         1656             0        1656              1
## 2      SBrkr          896             0         896              0
##   Bsmt_Half_Bath Full_Bath Half_Bath Bedroom_AbvGr Kitchen_AbvGr TotRms_AbvGrd
## 1              0         1         0             3             1             7
## 2              0         1         0             2             1             5
##   Functional Fireplaces Garage_Type Garage_Finish Garage_Cars Garage_Area
## 1        Typ          2      Attchd           Fin           2         528
## 2        Typ          0      Attchd           Unf           1         730
##   Garage_Cond      Paved_Drive Wood_Deck_SF Open_Porch_SF Enclosed_Porch
## 1     Typical Partial_Pavement          210            62              0
## 2     Typical            Paved          140             0              0
##   Three_season_porch Screen_Porch Pool_Area Pool_QC           Fence
## 1                  0            0         0 No_Pool        No_Fence
## 2                  0          120         0 No_Pool Minimum_Privacy
##   Misc_Feature Misc_Val Mo_Sold Year_Sold Sale_Type Sale_Condition Sale_Price
## 1         None        0       5      2010       WD          Normal     215000
## 2         None        0       6      2010       WD          Normal     105000
##   Longitude Latitude
## 1 -93.61975 42.05403
## 2 -93.61976 42.05301</code></pre>
<div class="sourceCode" id="cb182"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb182-1"><a href="tidyverse.html#cb182-1" aria-hidden="true" tabindex="-1"></a>tidy <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="st">&quot;data/ames.csv&quot;</span>)</span></code></pre></div>
<pre><code>## Rows: 2930 Columns: 74
## ── Column specification ────────────────────────────────────────────────────────
## Delimiter: &quot;,&quot;
## chr (40): MS_SubClass, MS_Zoning, Street, Alley, Lot_Shape, Land_Contour, Ut...
## dbl (34): Lot_Frontage, Lot_Area, Year_Built, Year_Remod_Add, Mas_Vnr_Area, ...
## 
## ℹ Use `spec()` to retrieve the full column specification for this data.
## ℹ Specify the column types or set `show_col_types = FALSE` to quiet this message.</code></pre>
<div class="sourceCode" id="cb184"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb184-1"><a href="tidyverse.html#cb184-1" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(tidy, <span class="dv">2</span>)</span></code></pre></div>
<pre><code>## # A tibble: 2 × 74
##   MS_SubC…¹ MS_Zo…² Lot_F…³ Lot_A…⁴ Street Alley Lot_S…⁵ Land_…⁶ Utili…⁷ Lot_C…⁸
##   &lt;chr&gt;     &lt;chr&gt;     &lt;dbl&gt;   &lt;dbl&gt; &lt;chr&gt;  &lt;chr&gt; &lt;chr&gt;   &lt;chr&gt;   &lt;chr&gt;   &lt;chr&gt;  
## 1 One_Stor… Reside…     141   31770 Pave   No_A… Slight… Lvl     AllPub  Corner 
## 2 One_Stor… Reside…      80   11622 Pave   No_A… Regular Lvl     AllPub  Inside 
## # … with 64 more variables: Land_Slope &lt;chr&gt;, Neighborhood &lt;chr&gt;,
## #   Condition_1 &lt;chr&gt;, Condition_2 &lt;chr&gt;, Bldg_Type &lt;chr&gt;, House_Style &lt;chr&gt;,
## #   Overall_Cond &lt;chr&gt;, Year_Built &lt;dbl&gt;, Year_Remod_Add &lt;dbl&gt;,
## #   Roof_Style &lt;chr&gt;, Roof_Matl &lt;chr&gt;, Exterior_1st &lt;chr&gt;, Exterior_2nd &lt;chr&gt;,
## #   Mas_Vnr_Type &lt;chr&gt;, Mas_Vnr_Area &lt;dbl&gt;, Exter_Cond &lt;chr&gt;, Foundation &lt;chr&gt;,
## #   Bsmt_Cond &lt;chr&gt;, Bsmt_Exposure &lt;chr&gt;, BsmtFin_Type_1 &lt;chr&gt;,
## #   BsmtFin_SF_1 &lt;dbl&gt;, BsmtFin_Type_2 &lt;chr&gt;, BsmtFin_SF_2 &lt;dbl&gt;, …</code></pre>
<p>¿Y si el archivo que necesitamos leer esta en excel?</p>
</div>
<div id="archivos-txt" class="section level3 hasAnchor" number="3.1.2">
<h3><span class="header-section-number">3.1.2</span> Archivos txt<a href="tidyverse.html#archivos-txt" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Uno de los archivos más comunes es el <em>.txt</em>. La librería <em>readr</em> también cuenta con funciones que permiten leer fácilmente los datos contenidos en formato tabular.</p>
<div class="sourceCode" id="cb186"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb186-1"><a href="tidyverse.html#cb186-1" aria-hidden="true" tabindex="-1"></a>ames_txt <span class="ot">&lt;-</span> <span class="fu">read_delim</span>(<span class="st">&quot;data/ames.txt&quot;</span>, <span class="at">delim =</span> <span class="st">&quot;;&quot;</span>, <span class="at">col_names =</span> <span class="cn">TRUE</span>)</span></code></pre></div>
<pre><code>## Rows: 2930 Columns: 74
## ── Column specification ────────────────────────────────────────────────────────
## Delimiter: &quot;;&quot;
## chr (40): MS_SubClass, MS_Zoning, Street, Alley, Lot_Shape, Land_Contour, Ut...
## dbl (34): Lot_Frontage, Lot_Area, Year_Built, Year_Remod_Add, Mas_Vnr_Area, ...
## 
## ℹ Use `spec()` to retrieve the full column specification for this data.
## ℹ Specify the column types or set `show_col_types = FALSE` to quiet this message.</code></pre>
<div class="sourceCode" id="cb188"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb188-1"><a href="tidyverse.html#cb188-1" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(ames_txt, <span class="dv">2</span>)</span></code></pre></div>
<pre><code>## # A tibble: 2 × 74
##   MS_SubC…¹ MS_Zo…² Lot_F…³ Lot_A…⁴ Street Alley Lot_S…⁵ Land_…⁶ Utili…⁷ Lot_C…⁸
##   &lt;chr&gt;     &lt;chr&gt;     &lt;dbl&gt;   &lt;dbl&gt; &lt;chr&gt;  &lt;chr&gt; &lt;chr&gt;   &lt;chr&gt;   &lt;chr&gt;   &lt;chr&gt;  
## 1 One_Stor… Reside…     141   31770 Pave   No_A… Slight… Lvl     AllPub  Corner 
## 2 One_Stor… Reside…      80   11622 Pave   No_A… Regular Lvl     AllPub  Inside 
## # … with 64 more variables: Land_Slope &lt;chr&gt;, Neighborhood &lt;chr&gt;,
## #   Condition_1 &lt;chr&gt;, Condition_2 &lt;chr&gt;, Bldg_Type &lt;chr&gt;, House_Style &lt;chr&gt;,
## #   Overall_Cond &lt;chr&gt;, Year_Built &lt;dbl&gt;, Year_Remod_Add &lt;dbl&gt;,
## #   Roof_Style &lt;chr&gt;, Roof_Matl &lt;chr&gt;, Exterior_1st &lt;chr&gt;, Exterior_2nd &lt;chr&gt;,
## #   Mas_Vnr_Type &lt;chr&gt;, Mas_Vnr_Area &lt;dbl&gt;, Exter_Cond &lt;chr&gt;, Foundation &lt;chr&gt;,
## #   Bsmt_Cond &lt;chr&gt;, Bsmt_Exposure &lt;chr&gt;, BsmtFin_Type_1 &lt;chr&gt;,
## #   BsmtFin_SF_1 &lt;dbl&gt;, BsmtFin_Type_2 &lt;chr&gt;, BsmtFin_SF_2 &lt;dbl&gt;, …</code></pre>
<p>La función <em>read_delim()</em> funciona para leer archivos con diferentes delimitadores posibles, es decir, es posible especificar si las columnas están separadas por espacios, comas, punto y coma, tabulador o algún otro delimitador (““,”,“,”;“,”, “@”).</p>
<p>Adicionalmente, se puede especificar si el archivo contiene encabezado, si existen renglones a saltar, codificación, tipo de variable y muchas más opciones. Todos estos detalles pueden consultarse en la documentación de ayuda.</p>
</div>
<div id="archivos-xls-y-xlsx" class="section level3 hasAnchor" number="3.1.3">
<h3><span class="header-section-number">3.1.3</span> Archivos <em>xls</em> y <em>xlsx</em><a href="tidyverse.html#archivos-xls-y-xlsx" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>La paquetería <em>readxl</em> facilita la obtención de datos tabulares de archivos de <em>Excel</em>. Admite tanto el formato <em>.xls</em> heredado como el formato <em>.xlsx</em> moderno basado en <em>XML</em>.</p>
<p>Esta paquetería pone a disposición las siguientes funciones:</p>
<ul>
<li><code>read_xlsx()</code> lee un archivo con extensión <em>xlsx</em>.</li>
</ul>
<div class="sourceCode" id="cb190"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb190-1"><a href="tidyverse.html#cb190-1" aria-hidden="true" tabindex="-1"></a><span class="fu">read_xlsx</span>(</span>
<span id="cb190-2"><a href="tidyverse.html#cb190-2" aria-hidden="true" tabindex="-1"></a> path,</span>
<span id="cb190-3"><a href="tidyverse.html#cb190-3" aria-hidden="true" tabindex="-1"></a> <span class="at">sheet =</span> <span class="cn">NULL</span>,</span>
<span id="cb190-4"><a href="tidyverse.html#cb190-4" aria-hidden="true" tabindex="-1"></a> <span class="at">range =</span> <span class="cn">NULL</span>,</span>
<span id="cb190-5"><a href="tidyverse.html#cb190-5" aria-hidden="true" tabindex="-1"></a> <span class="at">col_names =</span> <span class="cn">TRUE</span>,</span>
<span id="cb190-6"><a href="tidyverse.html#cb190-6" aria-hidden="true" tabindex="-1"></a> <span class="at">col_types =</span> <span class="cn">NULL</span>,</span>
<span id="cb190-7"><a href="tidyverse.html#cb190-7" aria-hidden="true" tabindex="-1"></a> <span class="at">na =</span> <span class="st">&quot;&quot;</span>, </span>
<span id="cb190-8"><a href="tidyverse.html#cb190-8" aria-hidden="true" tabindex="-1"></a> <span class="at">trim_ws =</span> <span class="cn">TRUE</span>,</span>
<span id="cb190-9"><a href="tidyverse.html#cb190-9" aria-hidden="true" tabindex="-1"></a> <span class="at">skip =</span> <span class="dv">0</span>,</span>
<span id="cb190-10"><a href="tidyverse.html#cb190-10" aria-hidden="true" tabindex="-1"></a> <span class="at">n_max =</span> <span class="cn">Inf</span>,</span>
<span id="cb190-11"><a href="tidyverse.html#cb190-11" aria-hidden="true" tabindex="-1"></a> <span class="at">guess_max =</span> <span class="fu">min</span>(<span class="dv">1000</span>, n_max),</span>
<span id="cb190-12"><a href="tidyverse.html#cb190-12" aria-hidden="true" tabindex="-1"></a> <span class="at">progress =</span> <span class="fu">readxl_progress</span>(),</span>
<span id="cb190-13"><a href="tidyverse.html#cb190-13" aria-hidden="true" tabindex="-1"></a> <span class="at">.name_repair =</span> <span class="st">&quot;unique&quot;</span></span>
<span id="cb190-14"><a href="tidyverse.html#cb190-14" aria-hidden="true" tabindex="-1"></a> )</span></code></pre></div>
<ul>
<li><code>read_xls()</code> lee un archivo con extensión <em>xls</em>.</li>
</ul>
<div class="sourceCode" id="cb191"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb191-1"><a href="tidyverse.html#cb191-1" aria-hidden="true" tabindex="-1"></a><span class="fu">read_xls</span>(</span>
<span id="cb191-2"><a href="tidyverse.html#cb191-2" aria-hidden="true" tabindex="-1"></a> path,</span>
<span id="cb191-3"><a href="tidyverse.html#cb191-3" aria-hidden="true" tabindex="-1"></a> <span class="at">sheet =</span> <span class="cn">NULL</span>,</span>
<span id="cb191-4"><a href="tidyverse.html#cb191-4" aria-hidden="true" tabindex="-1"></a> <span class="at">range =</span> <span class="cn">NULL</span>,</span>
<span id="cb191-5"><a href="tidyverse.html#cb191-5" aria-hidden="true" tabindex="-1"></a> <span class="at">col_names =</span> <span class="cn">TRUE</span>,</span>
<span id="cb191-6"><a href="tidyverse.html#cb191-6" aria-hidden="true" tabindex="-1"></a> <span class="at">col_types =</span> <span class="cn">NULL</span>,</span>
<span id="cb191-7"><a href="tidyverse.html#cb191-7" aria-hidden="true" tabindex="-1"></a> <span class="at">na =</span> <span class="st">&quot;&quot;</span>, </span>
<span id="cb191-8"><a href="tidyverse.html#cb191-8" aria-hidden="true" tabindex="-1"></a> <span class="at">trim_ws =</span> <span class="cn">TRUE</span>,</span>
<span id="cb191-9"><a href="tidyverse.html#cb191-9" aria-hidden="true" tabindex="-1"></a> <span class="at">skip =</span> <span class="dv">0</span>,</span>
<span id="cb191-10"><a href="tidyverse.html#cb191-10" aria-hidden="true" tabindex="-1"></a> <span class="at">n_max =</span> <span class="cn">Inf</span>, </span>
<span id="cb191-11"><a href="tidyverse.html#cb191-11" aria-hidden="true" tabindex="-1"></a> <span class="at">guess_max =</span> <span class="fu">min</span>(<span class="dv">1000</span>, n_max),</span>
<span id="cb191-12"><a href="tidyverse.html#cb191-12" aria-hidden="true" tabindex="-1"></a> <span class="at">progress =</span> <span class="fu">readxl_progress</span>(),</span>
<span id="cb191-13"><a href="tidyverse.html#cb191-13" aria-hidden="true" tabindex="-1"></a> <span class="at">.name_repair =</span> <span class="st">&quot;unique&quot;</span></span>
<span id="cb191-14"><a href="tidyverse.html#cb191-14" aria-hidden="true" tabindex="-1"></a> )</span></code></pre></div>
<ul>
<li><code>read_excel()</code> determina si el archivo es de tipo <em>xls</em> o <em>xlsx</em> para después llamar a una de las funciones mencionadas anteriormente.</li>
</ul>
<div class="sourceCode" id="cb192"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb192-1"><a href="tidyverse.html#cb192-1" aria-hidden="true" tabindex="-1"></a><span class="fu">read_excel</span>(</span>
<span id="cb192-2"><a href="tidyverse.html#cb192-2" aria-hidden="true" tabindex="-1"></a> path,</span>
<span id="cb192-3"><a href="tidyverse.html#cb192-3" aria-hidden="true" tabindex="-1"></a> <span class="at">sheet =</span> <span class="cn">NULL</span>,</span>
<span id="cb192-4"><a href="tidyverse.html#cb192-4" aria-hidden="true" tabindex="-1"></a> <span class="at">range =</span> <span class="cn">NULL</span>,</span>
<span id="cb192-5"><a href="tidyverse.html#cb192-5" aria-hidden="true" tabindex="-1"></a> <span class="at">col_names =</span> <span class="cn">TRUE</span>,</span>
<span id="cb192-6"><a href="tidyverse.html#cb192-6" aria-hidden="true" tabindex="-1"></a> <span class="at">col_types =</span> <span class="cn">NULL</span>, </span>
<span id="cb192-7"><a href="tidyverse.html#cb192-7" aria-hidden="true" tabindex="-1"></a> <span class="at">na =</span> <span class="st">&quot;&quot;</span>,</span>
<span id="cb192-8"><a href="tidyverse.html#cb192-8" aria-hidden="true" tabindex="-1"></a> <span class="at">trim_ws =</span> <span class="cn">TRUE</span>, </span>
<span id="cb192-9"><a href="tidyverse.html#cb192-9" aria-hidden="true" tabindex="-1"></a> <span class="at">skip =</span> <span class="dv">0</span>,</span>
<span id="cb192-10"><a href="tidyverse.html#cb192-10" aria-hidden="true" tabindex="-1"></a> <span class="at">n_max =</span> <span class="cn">Inf</span>,</span>
<span id="cb192-11"><a href="tidyverse.html#cb192-11" aria-hidden="true" tabindex="-1"></a> <span class="at">guess_max =</span> <span class="fu">min</span>(<span class="dv">1000</span>, n_max),</span>
<span id="cb192-12"><a href="tidyverse.html#cb192-12" aria-hidden="true" tabindex="-1"></a> <span class="at">progress =</span> <span class="fu">readxl_progress</span>(),</span>
<span id="cb192-13"><a href="tidyverse.html#cb192-13" aria-hidden="true" tabindex="-1"></a> <span class="at">.name_repair =</span> <span class="st">&quot;unique&quot;</span></span>
<span id="cb192-14"><a href="tidyverse.html#cb192-14" aria-hidden="true" tabindex="-1"></a> )</span></code></pre></div>
<p><strong>EJERCICIO:</strong> Leer archivo excel de la carpeta del curso</p>
</div>
<div id="archivos-json" class="section level3 hasAnchor" number="3.1.4">
<h3><span class="header-section-number">3.1.4</span> Archivos json<a href="tidyverse.html#archivos-json" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Se utiliza la función <code>fromJSON</code> de la paquetería <em>jsonlite</em></p>
<div class="sourceCode" id="cb193"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb193-1"><a href="tidyverse.html#cb193-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(jsonlite)</span></code></pre></div>
<pre><code>## 
## Attaching package: &#39;jsonlite&#39;</code></pre>
<pre><code>## The following object is masked from &#39;package:purrr&#39;:
## 
##     flatten</code></pre>
<div class="sourceCode" id="cb196"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb196-1"><a href="tidyverse.html#cb196-1" aria-hidden="true" tabindex="-1"></a>base_json <span class="ot">&lt;-</span> jsonlite<span class="sc">::</span><span class="fu">fromJSON</span>(<span class="st">&quot;data/ames.json&quot;</span>)</span>
<span id="cb196-2"><a href="tidyverse.html#cb196-2" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(base_json, <span class="dv">2</span>)</span></code></pre></div>
<pre><code>##                           MS_SubClass                MS_Zoning Lot_Frontage
## 1 One_Story_1946_and_Newer_All_Styles  Residential_Low_Density          141
## 2 One_Story_1946_and_Newer_All_Styles Residential_High_Density           80
##   Lot_Area Street           Alley          Lot_Shape Land_Contour Utilities
## 1    31770   Pave No_Alley_Access Slightly_Irregular          Lvl    AllPub
## 2    11622   Pave No_Alley_Access            Regular          Lvl    AllPub
##   Lot_Config Land_Slope Neighborhood Condition_1 Condition_2 Bldg_Type
## 1     Corner        Gtl   North_Ames        Norm        Norm    OneFam
## 2     Inside        Gtl   North_Ames       Feedr        Norm    OneFam
##   House_Style  Overall_Cond Year_Built Year_Remod_Add Roof_Style Roof_Matl
## 1   One_Story       Average       1960           1960        Hip   CompShg
## 2   One_Story Above_Average       1961           1961      Gable   CompShg
##   Exterior_1st Exterior_2nd Mas_Vnr_Type Mas_Vnr_Area Exter_Cond Foundation
## 1      BrkFace      Plywood        Stone          112    Typical     CBlock
## 2      VinylSd      VinylSd         None            0    Typical     CBlock
##   Bsmt_Cond Bsmt_Exposure BsmtFin_Type_1 BsmtFin_SF_1 BsmtFin_Type_2
## 1      Good            Gd            BLQ            2            Unf
## 2   Typical            No            Rec            6            LwQ
##   BsmtFin_SF_2 Bsmt_Unf_SF Total_Bsmt_SF Heating Heating_QC Central_Air
## 1            0         441          1080    GasA       Fair           Y
## 2          144         270           882    GasA    Typical           Y
##   Electrical First_Flr_SF Second_Flr_SF Gr_Liv_Area Bsmt_Full_Bath
## 1      SBrkr         1656             0        1656              1
## 2      SBrkr          896             0         896              0
##   Bsmt_Half_Bath Full_Bath Half_Bath Bedroom_AbvGr Kitchen_AbvGr TotRms_AbvGrd
## 1              0         1         0             3             1             7
## 2              0         1         0             2             1             5
##   Functional Fireplaces Garage_Type Garage_Finish Garage_Cars Garage_Area
## 1        Typ          2      Attchd           Fin           2         528
## 2        Typ          0      Attchd           Unf           1         730
##   Garage_Cond      Paved_Drive Wood_Deck_SF Open_Porch_SF Enclosed_Porch
## 1     Typical Partial_Pavement          210            62              0
## 2     Typical            Paved          140             0              0
##   Three_season_porch Screen_Porch Pool_Area Pool_QC           Fence
## 1                  0            0         0 No_Pool        No_Fence
## 2                  0          120         0 No_Pool Minimum_Privacy
##   Misc_Feature Misc_Val Mo_Sold Year_Sold Sale_Type Sale_Condition Sale_Price
## 1         None        0       5      2010       WD          Normal     215000
## 2         None        0       6      2010       WD          Normal     105000
##   Longitude Latitude
## 1  -93.6198   42.054
## 2  -93.6198   42.053</code></pre>
</div>
<div id="archivos-rds" class="section level3 hasAnchor" number="3.1.5">
<h3><span class="header-section-number">3.1.5</span> Archivos rds<a href="tidyverse.html#archivos-rds" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Un tipo de archivo que resulta de particular interés, es el <em>.RDS</em>. Este archivo comprime cualquier objeto o resultado que sea usado o producido en <em>R</em>. Uno puede almacenar el objeto de interés de la siguiente manera:</p>
<div class="sourceCode" id="cb198"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb198-1"><a href="tidyverse.html#cb198-1" aria-hidden="true" tabindex="-1"></a><span class="fu">saveRDS</span>(base_json, <span class="st">&quot;data/ames.rds&quot;</span>)</span></code></pre></div>
<p>Puede observarse que en el explorador de archivos se encuentra ahora el nuevo archivo con extensión <em>.rds</em>, el cual puede ser posteriormente incorporado a una sesión de <em>R</em> para seguir trabajando con él.</p>
<div class="sourceCode" id="cb199"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb199-1"><a href="tidyverse.html#cb199-1" aria-hidden="true" tabindex="-1"></a>base_rds <span class="ot">&lt;-</span> <span class="fu">readRDS</span>(<span class="st">&quot;data/ames.rds&quot;</span>)</span></code></pre></div>
<p>Algunas de las grandes ventajas que tiene almacenar los archivos en formato rds, son las siguientes:</p>
<ul>
<li><p>No es necesario volver a ejecutar procesos largos cuando ya se ha logrado realizar una vez.</p></li>
<li><p>El tiempo de lectura de la información es considerablemente más rápido.</p></li>
</ul>
</div>
<div id="bases-de-datos" class="section level3 hasAnchor" number="3.1.6">
<h3><span class="header-section-number">3.1.6</span> Bases de Datos<a href="tidyverse.html#bases-de-datos" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>En muchos de los casos la información estará dentro de un Sistema Manejador de Bases de Datos, existen bibliotecas que nos permiten establecer las conexiones con ellas, algunos ejemplos son:</p>
<ul>
<li>ODBC</li>
<li>DBI</li>
<li>JDBC</li>
</ul>
<p>Un ejemplo con un SMBD como Oracle:</p>
</div>
<div id="oracle-database" class="section level3 hasAnchor" number="3.1.7">
<h3><span class="header-section-number">3.1.7</span> Oracle Database<a href="tidyverse.html#oracle-database" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p><a href="https://cran.r-project.org/web/packages/ROracle/ROracle.pdf">Referencias</a></p>
<p><strong>Configuración de conexión:</strong></p>
<p>Se necesitan seis configuraciones para realizar una conexión:</p>
<ul>
<li>Controlador : consulte la sección Controladores para obtener más información</li>
<li>Url : una ruta de red al servidor de la base de datos.</li>
<li>Base de datos : el nombre de la base de datos.</li>
<li>Usuario : el ID de red del usuario o la cuenta local del servidor</li>
<li>Contraseña : la contraseña de la cuenta</li>
<li>Puerto : debe establecerse en 1526 o 1521</li>
</ul>
<p>Para establecer la conexión con la base de datos:</p>
<div class="sourceCode" id="cb200"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb200-1"><a href="tidyverse.html#cb200-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(DBI)</span>
<span id="cb200-2"><a href="tidyverse.html#cb200-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(RJDBC)</span>
<span id="cb200-3"><a href="tidyverse.html#cb200-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb200-4"><a href="tidyverse.html#cb200-4" aria-hidden="true" tabindex="-1"></a>jdbcDriver <span class="ot">=</span> <span class="fu">JDBC</span>(<span class="at">driverClass =</span> <span class="st">&quot;oracle.jdbc.OracleDriver&quot;</span>,<span class="st">&quot;c:/Drivers/Oracle/ojdbc8.jar&quot;</span>)</span>
<span id="cb200-5"><a href="tidyverse.html#cb200-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb200-6"><a href="tidyverse.html#cb200-6" aria-hidden="true" tabindex="-1"></a>con <span class="ot">&lt;-</span> <span class="fu">dbConnect</span>(</span>
<span id="cb200-7"><a href="tidyverse.html#cb200-7" aria-hidden="true" tabindex="-1"></a> jdbcDriver, </span>
<span id="cb200-8"><a href="tidyverse.html#cb200-8" aria-hidden="true" tabindex="-1"></a> <span class="at">url      =</span> <span class="st">&quot;jdbc:oracle:thin:@//Hostname:Port/Service_Name&quot;</span></span>
<span id="cb200-9"><a href="tidyverse.html#cb200-9" aria-hidden="true" tabindex="-1"></a> <span class="at">user     =</span> rstudioapi<span class="sc">::</span><span class="fu">askForPassword</span>(<span class="st">&quot;Database user&quot;</span>),</span>
<span id="cb200-10"><a href="tidyverse.html#cb200-10" aria-hidden="true" tabindex="-1"></a> <span class="at">password =</span> rstudioapi<span class="sc">::</span><span class="fu">askForPassword</span>(<span class="st">&quot;Database password&quot;</span>),</span>
<span id="cb200-11"><a href="tidyverse.html#cb200-11" aria-hidden="true" tabindex="-1"></a> <span class="at">dbname   =</span> <span class="st">&quot;Data Base Name&quot;</span></span>
<span id="cb200-12"><a href="tidyverse.html#cb200-12" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb200-13"><a href="tidyverse.html#cb200-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb200-14"><a href="tidyverse.html#cb200-14" aria-hidden="true" tabindex="-1"></a>sql_translation.JDBCConnection <span class="ot">&lt;-</span> dbplyr<span class="sc">:::</span>sql_translation.Oracle</span>
<span id="cb200-15"><a href="tidyverse.html#cb200-15" aria-hidden="true" tabindex="-1"></a>sql_select.JDBCConnection      <span class="ot">&lt;-</span> dbplyr<span class="sc">:::</span>sql_query_select.Oracle</span>
<span id="cb200-16"><a href="tidyverse.html#cb200-16" aria-hidden="true" tabindex="-1"></a>sql_subquery.JDBCConnection    <span class="ot">&lt;-</span> dbplyr<span class="sc">:::</span>sql_query_wrap.Oracle</span>
<span id="cb200-17"><a href="tidyverse.html#cb200-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb200-18"><a href="tidyverse.html#cb200-18" aria-hidden="true" tabindex="-1"></a><span class="fu">dbExistsTable</span>(jdbcConnection, <span class="st">&quot;nombre_tabla&quot;</span>) <span class="co"># Probar si hay conexión con la tabla</span></span></code></pre></div>
<p><strong>Información sobre la base de datos:</strong></p>
<p>El paquete odbc le brinda herramientas para explorar objetos y columnas en la base de datos.</p>
<div class="sourceCode" id="cb201"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb201-1"><a href="tidyverse.html#cb201-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Top level objects</span></span>
<span id="cb201-2"><a href="tidyverse.html#cb201-2" aria-hidden="true" tabindex="-1"></a><span class="fu">odbcListObjects</span>(con)</span>
<span id="cb201-3"><a href="tidyverse.html#cb201-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb201-4"><a href="tidyverse.html#cb201-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Tables in a schema</span></span>
<span id="cb201-5"><a href="tidyverse.html#cb201-5" aria-hidden="true" tabindex="-1"></a><span class="fu">odbcListObjects</span>(con, <span class="at">catalog =</span> <span class="st">&quot;mydb&quot;</span>, <span class="at">schema =</span> <span class="st">&quot;dbo&quot;</span>)</span>
<span id="cb201-6"><a href="tidyverse.html#cb201-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb201-7"><a href="tidyverse.html#cb201-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Columns in a table</span></span>
<span id="cb201-8"><a href="tidyverse.html#cb201-8" aria-hidden="true" tabindex="-1"></a><span class="fu">odbcListColumns</span>(con, <span class="at">catalog =</span> <span class="st">&quot;mydb&quot;</span>, <span class="at">schema =</span> <span class="st">&quot;dbo&quot;</span>, <span class="at">table =</span> <span class="st">&quot;cars&quot;</span>)</span>
<span id="cb201-9"><a href="tidyverse.html#cb201-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb201-10"><a href="tidyverse.html#cb201-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Database structure</span></span>
<span id="cb201-11"><a href="tidyverse.html#cb201-11" aria-hidden="true" tabindex="-1"></a><span class="fu">odbcListObjectTypes</span>(con)</span></code></pre></div>
<p><strong>Consultas con SQL:</strong> Para consultas interactivas, utilice <em>dbGetQuery()</em> para enviar una consulta y obtener los resultados. Para obtener los resultados por separado, utilice <em>dbSendQuery()</em> y <em>dbFetch()</em>. El argumento <em>n</em> en <em>dbFetch()</em> se puede utilizar para obtener resultados parciales.</p>
<div class="sourceCode" id="cb202"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb202-1"><a href="tidyverse.html#cb202-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Return the results for an arbitrary query</span></span>
<span id="cb202-2"><a href="tidyverse.html#cb202-2" aria-hidden="true" tabindex="-1"></a><span class="fu">dbGetQuery</span>(con, <span class="st">&quot;SELECT speed, dist FROM cars&quot;</span>)</span>
<span id="cb202-3"><a href="tidyverse.html#cb202-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb202-4"><a href="tidyverse.html#cb202-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Fetch the first 100 records</span></span>
<span id="cb202-5"><a href="tidyverse.html#cb202-5" aria-hidden="true" tabindex="-1"></a>query <span class="ot">&lt;-</span> <span class="fu">dbSendQuery</span>(con, <span class="st">&quot;SELECT speed, dist FROM cars&quot;</span>)</span>
<span id="cb202-6"><a href="tidyverse.html#cb202-6" aria-hidden="true" tabindex="-1"></a><span class="fu">dbFetch</span>(query, <span class="at">n =</span> <span class="dv">10</span>)</span>
<span id="cb202-7"><a href="tidyverse.html#cb202-7" aria-hidden="true" tabindex="-1"></a><span class="fu">dbClearResult</span>(query)</span></code></pre></div>
<p>Puedes usar los ejemplos anteriores para probar con diferentes consultas y bases de datos.</p>
<p>Tengamos un ejemplo de manera local:</p>
<div class="sourceCode" id="cb203"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb203-1"><a href="tidyverse.html#cb203-1" aria-hidden="true" tabindex="-1"></a>remotes<span class="sc">::</span><span class="fu">install_version</span>(<span class="st">&quot;RSQLite&quot;</span>)</span></code></pre></div>
<div class="sourceCode" id="cb204"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb204-1"><a href="tidyverse.html#cb204-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(dplyr)</span>
<span id="cb204-2"><a href="tidyverse.html#cb204-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(dbplyr)</span>
<span id="cb204-3"><a href="tidyverse.html#cb204-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(RSQLite)</span>
<span id="cb204-4"><a href="tidyverse.html#cb204-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb204-5"><a href="tidyverse.html#cb204-5" aria-hidden="true" tabindex="-1"></a>con <span class="ot">&lt;-</span> <span class="fu">src_memdb</span>()</span>
<span id="cb204-6"><a href="tidyverse.html#cb204-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb204-7"><a href="tidyverse.html#cb204-7" aria-hidden="true" tabindex="-1"></a><span class="fu">copy_to</span>(con, storms, <span class="at">overwrite =</span> T)</span>
<span id="cb204-8"><a href="tidyverse.html#cb204-8" aria-hidden="true" tabindex="-1"></a><span class="fu">copy_to</span>(con, mtcars, <span class="at">overwrite =</span> T)</span>
<span id="cb204-9"><a href="tidyverse.html#cb204-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb204-10"><a href="tidyverse.html#cb204-10" aria-hidden="true" tabindex="-1"></a>tbl_storms <span class="ot">&lt;-</span> <span class="fu">tbl</span>(con, <span class="st">&quot;storms&quot;</span>)</span>
<span id="cb204-11"><a href="tidyverse.html#cb204-11" aria-hidden="true" tabindex="-1"></a>tbl_storms</span></code></pre></div>
<pre><code>## # Source:   table&lt;storms&gt; [?? x 13]
## # Database: sqlite 3.39.1 [:memory:]
##    name   year month   day  hour   lat  long status        categ…¹  wind press…²
##    &lt;chr&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;int&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;chr&gt;         &lt;chr&gt;   &lt;int&gt;   &lt;int&gt;
##  1 Amy    1975     6    27     0  27.5 -79   tropical dep… -1         25    1013
##  2 Amy    1975     6    27     6  28.5 -79   tropical dep… -1         25    1013
##  3 Amy    1975     6    27    12  29.5 -79   tropical dep… -1         25    1013
##  4 Amy    1975     6    27    18  30.5 -79   tropical dep… -1         25    1013
##  5 Amy    1975     6    28     0  31.5 -78.8 tropical dep… -1         25    1012
##  6 Amy    1975     6    28     6  32.4 -78.7 tropical dep… -1         25    1012
##  7 Amy    1975     6    28    12  33.3 -78   tropical dep… -1         25    1011
##  8 Amy    1975     6    28    18  34   -77   tropical dep… -1         30    1006
##  9 Amy    1975     6    29     0  34.4 -75.8 tropical sto… 0          35    1004
## 10 Amy    1975     6    29     6  34   -74.8 tropical sto… 0          40    1002
## # … with more rows, 2 more variables: tropicalstorm_force_diameter &lt;int&gt;,
## #   hurricane_force_diameter &lt;int&gt;, and abbreviated variable names ¹​category,
## #   ²​pressure</code></pre>
<div class="sourceCode" id="cb206"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb206-1"><a href="tidyverse.html#cb206-1" aria-hidden="true" tabindex="-1"></a>tbl_mtcars <span class="ot">&lt;-</span> <span class="fu">tbl</span>(con, <span class="st">&quot;mtcars&quot;</span>)</span>
<span id="cb206-2"><a href="tidyverse.html#cb206-2" aria-hidden="true" tabindex="-1"></a>tbl_mtcars</span></code></pre></div>
<pre><code>## # Source:   table&lt;mtcars&gt; [?? x 11]
## # Database: sqlite 3.39.1 [:memory:]
##      mpg   cyl  disp    hp  drat    wt  qsec    vs    am  gear  carb
##    &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;
##  1  21       6  160    110  3.9   2.62  16.5     0     1     4     4
##  2  21       6  160    110  3.9   2.88  17.0     0     1     4     4
##  3  22.8     4  108     93  3.85  2.32  18.6     1     1     4     1
##  4  21.4     6  258    110  3.08  3.22  19.4     1     0     3     1
##  5  18.7     8  360    175  3.15  3.44  17.0     0     0     3     2
##  6  18.1     6  225    105  2.76  3.46  20.2     1     0     3     1
##  7  14.3     8  360    245  3.21  3.57  15.8     0     0     3     4
##  8  24.4     4  147.    62  3.69  3.19  20       1     0     4     2
##  9  22.8     4  141.    95  3.92  3.15  22.9     1     0     4     2
## 10  19.2     6  168.   123  3.92  3.44  18.3     1     0     4     4
## # … with more rows</code></pre>
<p>Existe otra metodología de conexión, la cual puede encontrarse en la siguiente <a href="https://db.rstudio.com/databases/oracle/">documentación</a></p>
</div>
</div>
<div id="consultas-de-datos" class="section level2 hasAnchor" number="3.2">
<h2><span class="header-section-number">3.2</span> Consultas de datos<a href="tidyverse.html#consultas-de-datos" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Ahora que ya se ha estudiado la manera de cargar datos, aprenderemos como manipularlos con <em>dplyr.</em> El paquete <em>dplyr</em> proporciona un conjunto de funciones muy útiles para manipular data-frames y así reducir el número de repeticiones, la probabilidad de cometer errores y el número de caracteres que hay que escribir. Como valor extra, podemos encontrar que la gramática de <em>dplyr</em> es más fácil de entender.</p>
<p>Revisaremos algunas de sus funciones <strong>más usadas</strong> (<em>verbos</em>), así como el uso de <strong>pipes</strong> (%&gt;%) para combinarlas.</p>
<ul>
<li><p>select()</p></li>
<li><p>filter()</p></li>
<li><p>arrange()</p></li>
<li><p>mutate()</p></li>
<li><p>summarise()</p></li>
<li><p>join()</p></li>
<li><p>group_by()</p></li>
</ul>
<p>Primero tenemos que instalar y cargar la paquetería (parte de tidyverse):</p>
<div class="sourceCode" id="cb208"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb208-1"><a href="tidyverse.html#cb208-1" aria-hidden="true" tabindex="-1"></a><span class="co"># install.packages(&quot;dplyr&quot;)</span></span>
<span id="cb208-2"><a href="tidyverse.html#cb208-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb208-3"><a href="tidyverse.html#cb208-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(dplyr)</span>
<span id="cb208-4"><a href="tidyverse.html#cb208-4" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(readr)</span></code></pre></div>
<p>Usaremos el dataset <em>AmesHousing</em> que se proporcionó en el capítulo anterior (el alumno puede hacer el ejercicio con datos propios)</p>
<div class="sourceCode" id="cb209"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb209-1"><a href="tidyverse.html#cb209-1" aria-hidden="true" tabindex="-1"></a>ames_housing <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="st">&quot;data/ames.csv&quot;</span>)</span>
<span id="cb209-2"><a href="tidyverse.html#cb209-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb209-3"><a href="tidyverse.html#cb209-3" aria-hidden="true" tabindex="-1"></a><span class="fu">glimpse</span>(ames_housing)</span></code></pre></div>
<pre><code>## Rows: 2,930
## Columns: 74
## $ MS_SubClass        &lt;chr&gt; &quot;One_Story_1946_and_Newer_All_Styles&quot;, &quot;One_Story_1…
## $ MS_Zoning          &lt;chr&gt; &quot;Residential_Low_Density&quot;, &quot;Residential_High_Densit…
## $ Lot_Frontage       &lt;dbl&gt; 141, 80, 81, 93, 74, 78, 41, 43, 39, 60, 75, 0, 63,…
## $ Lot_Area           &lt;dbl&gt; 31770, 11622, 14267, 11160, 13830, 9978, 4920, 5005…
## $ Street             &lt;chr&gt; &quot;Pave&quot;, &quot;Pave&quot;, &quot;Pave&quot;, &quot;Pave&quot;, &quot;Pave&quot;, &quot;Pave&quot;, &quot;Pa…
## $ Alley              &lt;chr&gt; &quot;No_Alley_Access&quot;, &quot;No_Alley_Access&quot;, &quot;No_Alley_Acc…
## $ Lot_Shape          &lt;chr&gt; &quot;Slightly_Irregular&quot;, &quot;Regular&quot;, &quot;Slightly_Irregula…
## $ Land_Contour       &lt;chr&gt; &quot;Lvl&quot;, &quot;Lvl&quot;, &quot;Lvl&quot;, &quot;Lvl&quot;, &quot;Lvl&quot;, &quot;Lvl&quot;, &quot;Lvl&quot;, &quot;H…
## $ Utilities          &lt;chr&gt; &quot;AllPub&quot;, &quot;AllPub&quot;, &quot;AllPub&quot;, &quot;AllPub&quot;, &quot;AllPub&quot;, &quot;…
## $ Lot_Config         &lt;chr&gt; &quot;Corner&quot;, &quot;Inside&quot;, &quot;Corner&quot;, &quot;Corner&quot;, &quot;Inside&quot;, &quot;…
## $ Land_Slope         &lt;chr&gt; &quot;Gtl&quot;, &quot;Gtl&quot;, &quot;Gtl&quot;, &quot;Gtl&quot;, &quot;Gtl&quot;, &quot;Gtl&quot;, &quot;Gtl&quot;, &quot;G…
## $ Neighborhood       &lt;chr&gt; &quot;North_Ames&quot;, &quot;North_Ames&quot;, &quot;North_Ames&quot;, &quot;North_Am…
## $ Condition_1        &lt;chr&gt; &quot;Norm&quot;, &quot;Feedr&quot;, &quot;Norm&quot;, &quot;Norm&quot;, &quot;Norm&quot;, &quot;Norm&quot;, &quot;N…
## $ Condition_2        &lt;chr&gt; &quot;Norm&quot;, &quot;Norm&quot;, &quot;Norm&quot;, &quot;Norm&quot;, &quot;Norm&quot;, &quot;Norm&quot;, &quot;No…
## $ Bldg_Type          &lt;chr&gt; &quot;OneFam&quot;, &quot;OneFam&quot;, &quot;OneFam&quot;, &quot;OneFam&quot;, &quot;OneFam&quot;, &quot;…
## $ House_Style        &lt;chr&gt; &quot;One_Story&quot;, &quot;One_Story&quot;, &quot;One_Story&quot;, &quot;One_Story&quot;,…
## $ Overall_Cond       &lt;chr&gt; &quot;Average&quot;, &quot;Above_Average&quot;, &quot;Above_Average&quot;, &quot;Avera…
## $ Year_Built         &lt;dbl&gt; 1960, 1961, 1958, 1968, 1997, 1998, 2001, 1992, 199…
## $ Year_Remod_Add     &lt;dbl&gt; 1960, 1961, 1958, 1968, 1998, 1998, 2001, 1992, 199…
## $ Roof_Style         &lt;chr&gt; &quot;Hip&quot;, &quot;Gable&quot;, &quot;Hip&quot;, &quot;Hip&quot;, &quot;Gable&quot;, &quot;Gable&quot;, &quot;Ga…
## $ Roof_Matl          &lt;chr&gt; &quot;CompShg&quot;, &quot;CompShg&quot;, &quot;CompShg&quot;, &quot;CompShg&quot;, &quot;CompSh…
## $ Exterior_1st       &lt;chr&gt; &quot;BrkFace&quot;, &quot;VinylSd&quot;, &quot;Wd Sdng&quot;, &quot;BrkFace&quot;, &quot;VinylS…
## $ Exterior_2nd       &lt;chr&gt; &quot;Plywood&quot;, &quot;VinylSd&quot;, &quot;Wd Sdng&quot;, &quot;BrkFace&quot;, &quot;VinylS…
## $ Mas_Vnr_Type       &lt;chr&gt; &quot;Stone&quot;, &quot;None&quot;, &quot;BrkFace&quot;, &quot;None&quot;, &quot;None&quot;, &quot;BrkFac…
## $ Mas_Vnr_Area       &lt;dbl&gt; 112, 0, 108, 0, 0, 20, 0, 0, 0, 0, 0, 0, 0, 0, 0, 6…
## $ Exter_Cond         &lt;chr&gt; &quot;Typical&quot;, &quot;Typical&quot;, &quot;Typical&quot;, &quot;Typical&quot;, &quot;Typica…
## $ Foundation         &lt;chr&gt; &quot;CBlock&quot;, &quot;CBlock&quot;, &quot;CBlock&quot;, &quot;CBlock&quot;, &quot;PConc&quot;, &quot;P…
## $ Bsmt_Cond          &lt;chr&gt; &quot;Good&quot;, &quot;Typical&quot;, &quot;Typical&quot;, &quot;Typical&quot;, &quot;Typical&quot;,…
## $ Bsmt_Exposure      &lt;chr&gt; &quot;Gd&quot;, &quot;No&quot;, &quot;No&quot;, &quot;No&quot;, &quot;No&quot;, &quot;No&quot;, &quot;Mn&quot;, &quot;No&quot;, &quot;No…
## $ BsmtFin_Type_1     &lt;chr&gt; &quot;BLQ&quot;, &quot;Rec&quot;, &quot;ALQ&quot;, &quot;ALQ&quot;, &quot;GLQ&quot;, &quot;GLQ&quot;, &quot;GLQ&quot;, &quot;A…
## $ BsmtFin_SF_1       &lt;dbl&gt; 2, 6, 1, 1, 3, 3, 3, 1, 3, 7, 7, 1, 7, 3, 3, 1, 3, …
## $ BsmtFin_Type_2     &lt;chr&gt; &quot;Unf&quot;, &quot;LwQ&quot;, &quot;Unf&quot;, &quot;Unf&quot;, &quot;Unf&quot;, &quot;Unf&quot;, &quot;Unf&quot;, &quot;U…
## $ BsmtFin_SF_2       &lt;dbl&gt; 0, 144, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1120, 0…
## $ Bsmt_Unf_SF        &lt;dbl&gt; 441, 270, 406, 1045, 137, 324, 722, 1017, 415, 994,…
## $ Total_Bsmt_SF      &lt;dbl&gt; 1080, 882, 1329, 2110, 928, 926, 1338, 1280, 1595, …
## $ Heating            &lt;chr&gt; &quot;GasA&quot;, &quot;GasA&quot;, &quot;GasA&quot;, &quot;GasA&quot;, &quot;GasA&quot;, &quot;GasA&quot;, &quot;Ga…
## $ Heating_QC         &lt;chr&gt; &quot;Fair&quot;, &quot;Typical&quot;, &quot;Typical&quot;, &quot;Excellent&quot;, &quot;Good&quot;, …
## $ Central_Air        &lt;chr&gt; &quot;Y&quot;, &quot;Y&quot;, &quot;Y&quot;, &quot;Y&quot;, &quot;Y&quot;, &quot;Y&quot;, &quot;Y&quot;, &quot;Y&quot;, &quot;Y&quot;, &quot;Y&quot;, &quot;…
## $ Electrical         &lt;chr&gt; &quot;SBrkr&quot;, &quot;SBrkr&quot;, &quot;SBrkr&quot;, &quot;SBrkr&quot;, &quot;SBrkr&quot;, &quot;SBrkr…
## $ First_Flr_SF       &lt;dbl&gt; 1656, 896, 1329, 2110, 928, 926, 1338, 1280, 1616, …
## $ Second_Flr_SF      &lt;dbl&gt; 0, 0, 0, 0, 701, 678, 0, 0, 0, 776, 892, 0, 676, 0,…
## $ Gr_Liv_Area        &lt;dbl&gt; 1656, 896, 1329, 2110, 1629, 1604, 1338, 1280, 1616…
## $ Bsmt_Full_Bath     &lt;dbl&gt; 1, 0, 0, 1, 0, 0, 1, 0, 1, 0, 0, 1, 0, 1, 1, 1, 0, …
## $ Bsmt_Half_Bath     &lt;dbl&gt; 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, …
## $ Full_Bath          &lt;dbl&gt; 1, 1, 1, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 1, 1, 3, 2, …
## $ Half_Bath          &lt;dbl&gt; 0, 0, 1, 1, 1, 1, 0, 0, 0, 1, 1, 0, 1, 1, 1, 1, 0, …
## $ Bedroom_AbvGr      &lt;dbl&gt; 3, 2, 3, 3, 3, 3, 2, 2, 2, 3, 3, 3, 3, 2, 1, 4, 4, …
## $ Kitchen_AbvGr      &lt;dbl&gt; 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, …
## $ TotRms_AbvGrd      &lt;dbl&gt; 7, 5, 6, 8, 6, 7, 6, 5, 5, 7, 7, 6, 7, 5, 4, 12, 8,…
## $ Functional         &lt;chr&gt; &quot;Typ&quot;, &quot;Typ&quot;, &quot;Typ&quot;, &quot;Typ&quot;, &quot;Typ&quot;, &quot;Typ&quot;, &quot;Typ&quot;, &quot;T…
## $ Fireplaces         &lt;dbl&gt; 2, 0, 0, 2, 1, 1, 0, 0, 1, 1, 1, 0, 1, 1, 0, 1, 0, …
## $ Garage_Type        &lt;chr&gt; &quot;Attchd&quot;, &quot;Attchd&quot;, &quot;Attchd&quot;, &quot;Attchd&quot;, &quot;Attchd&quot;, &quot;…
## $ Garage_Finish      &lt;chr&gt; &quot;Fin&quot;, &quot;Unf&quot;, &quot;Unf&quot;, &quot;Fin&quot;, &quot;Fin&quot;, &quot;Fin&quot;, &quot;Fin&quot;, &quot;R…
## $ Garage_Cars        &lt;dbl&gt; 2, 1, 1, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 3, 2, …
## $ Garage_Area        &lt;dbl&gt; 528, 730, 312, 522, 482, 470, 582, 506, 608, 442, 4…
## $ Garage_Cond        &lt;chr&gt; &quot;Typical&quot;, &quot;Typical&quot;, &quot;Typical&quot;, &quot;Typical&quot;, &quot;Typica…
## $ Paved_Drive        &lt;chr&gt; &quot;Partial_Pavement&quot;, &quot;Paved&quot;, &quot;Paved&quot;, &quot;Paved&quot;, &quot;Pav…
## $ Wood_Deck_SF       &lt;dbl&gt; 210, 140, 393, 0, 212, 360, 0, 0, 237, 140, 157, 48…
## $ Open_Porch_SF      &lt;dbl&gt; 62, 0, 36, 0, 34, 36, 0, 82, 152, 60, 84, 21, 75, 0…
## $ Enclosed_Porch     &lt;dbl&gt; 0, 0, 0, 0, 0, 0, 170, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0…
## $ Three_season_porch &lt;dbl&gt; 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, …
## $ Screen_Porch       &lt;dbl&gt; 0, 120, 0, 0, 0, 0, 0, 144, 0, 0, 0, 0, 0, 0, 140, …
## $ Pool_Area          &lt;dbl&gt; 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, …
## $ Pool_QC            &lt;chr&gt; &quot;No_Pool&quot;, &quot;No_Pool&quot;, &quot;No_Pool&quot;, &quot;No_Pool&quot;, &quot;No_Poo…
## $ Fence              &lt;chr&gt; &quot;No_Fence&quot;, &quot;Minimum_Privacy&quot;, &quot;No_Fence&quot;, &quot;No_Fenc…
## $ Misc_Feature       &lt;chr&gt; &quot;None&quot;, &quot;None&quot;, &quot;Gar2&quot;, &quot;None&quot;, &quot;None&quot;, &quot;None&quot;, &quot;No…
## $ Misc_Val           &lt;dbl&gt; 0, 0, 12500, 0, 0, 0, 0, 0, 0, 0, 0, 500, 0, 0, 0, …
## $ Mo_Sold            &lt;dbl&gt; 5, 6, 6, 4, 3, 6, 4, 1, 3, 6, 4, 3, 5, 2, 6, 6, 6, …
## $ Year_Sold          &lt;dbl&gt; 2010, 2010, 2010, 2010, 2010, 2010, 2010, 2010, 201…
## $ Sale_Type          &lt;chr&gt; &quot;WD&quot;, &quot;WD&quot;, &quot;WD&quot;, &quot;WD&quot;, &quot;WD&quot;, &quot;WD&quot;, &quot;WD&quot;, &quot;WD&quot;, &quot;WD…
## $ Sale_Condition     &lt;chr&gt; &quot;Normal&quot;, &quot;Normal&quot;, &quot;Normal&quot;, &quot;Normal&quot;, &quot;Normal&quot;, &quot;…
## $ Sale_Price         &lt;dbl&gt; 215000, 105000, 172000, 244000, 189900, 195500, 213…
## $ Longitude          &lt;dbl&gt; -93.61975, -93.61976, -93.61939, -93.61732, -93.638…
## $ Latitude           &lt;dbl&gt; 42.05403, 42.05301, 42.05266, 42.05125, 42.06090, 4…</code></pre>
<div id="seleccionar-columnas" class="section level3 hasAnchor" number="3.2.1">
<h3><span class="header-section-number">3.2.1</span> Seleccionar columnas<a href="tidyverse.html#seleccionar-columnas" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Observamos que nuestros datos tienen 2,930 observaciones y 74 variables, con <em>select()</em> podemos seleccionar las variables que se indiquen.</p>
<div class="sourceCode" id="cb211"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb211-1"><a href="tidyverse.html#cb211-1" aria-hidden="true" tabindex="-1"></a>ames_housing <span class="sc">%&gt;%</span> <span class="fu">select</span>(Lot_Area, Neighborhood, Year_Sold, Sale_Price)</span></code></pre></div>
<pre><code>## # A tibble: 2,930 × 4
##    Lot_Area Neighborhood Year_Sold Sale_Price
##       &lt;dbl&gt; &lt;chr&gt;            &lt;dbl&gt;      &lt;dbl&gt;
##  1    31770 North_Ames        2010     215000
##  2    11622 North_Ames        2010     105000
##  3    14267 North_Ames        2010     172000
##  4    11160 North_Ames        2010     244000
##  5    13830 Gilbert           2010     189900
##  6     9978 Gilbert           2010     195500
##  7     4920 Stone_Brook       2010     213500
##  8     5005 Stone_Brook       2010     191500
##  9     5389 Stone_Brook       2010     236500
## 10     7500 Gilbert           2010     189000
## # … with 2,920 more rows</code></pre>
<div class="infobox tip">
<p><strong>¡¡ RECORDAR !!</strong></p>
<p>El operador pipe (%&gt;%) se usa para conectar un elemento con una función o acción a realizar. En este caso solo se indica que en los datos de ames se seleccionan 4 variables.</p>
</div>
<p>Con <em>select()</em> y <em>contains()</em> podemos seleccionar variables con alguna cadena de texto.</p>
<div class="sourceCode" id="cb213"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb213-1"><a href="tidyverse.html#cb213-1" aria-hidden="true" tabindex="-1"></a>ames_housing <span class="sc">%&gt;%</span> <span class="fu">select</span>(<span class="fu">contains</span>(<span class="st">&quot;Area&quot;</span>))</span></code></pre></div>
<pre><code>## # A tibble: 2,930 × 5
##    Lot_Area Mas_Vnr_Area Gr_Liv_Area Garage_Area Pool_Area
##       &lt;dbl&gt;        &lt;dbl&gt;       &lt;dbl&gt;       &lt;dbl&gt;     &lt;dbl&gt;
##  1    31770          112        1656         528         0
##  2    11622            0         896         730         0
##  3    14267          108        1329         312         0
##  4    11160            0        2110         522         0
##  5    13830            0        1629         482         0
##  6     9978           20        1604         470         0
##  7     4920            0        1338         582         0
##  8     5005            0        1280         506         0
##  9     5389            0        1616         608         0
## 10     7500            0        1804         442         0
## # … with 2,920 more rows</code></pre>
<p>De igual manera, con <em>select()</em>, <em>ends_with</em> y <em>start_with()</em> podemos seleccionar que inicien o terminen con alguna cadena de texto.</p>
<div class="sourceCode" id="cb215"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb215-1"><a href="tidyverse.html#cb215-1" aria-hidden="true" tabindex="-1"></a>ames_housing <span class="sc">%&gt;%</span> <span class="fu">select</span>(<span class="fu">starts_with</span>(<span class="st">&quot;Garage&quot;</span>))</span></code></pre></div>
<pre><code>## # A tibble: 2,930 × 5
##    Garage_Type Garage_Finish Garage_Cars Garage_Area Garage_Cond
##    &lt;chr&gt;       &lt;chr&gt;               &lt;dbl&gt;       &lt;dbl&gt; &lt;chr&gt;      
##  1 Attchd      Fin                     2         528 Typical    
##  2 Attchd      Unf                     1         730 Typical    
##  3 Attchd      Unf                     1         312 Typical    
##  4 Attchd      Fin                     2         522 Typical    
##  5 Attchd      Fin                     2         482 Typical    
##  6 Attchd      Fin                     2         470 Typical    
##  7 Attchd      Fin                     2         582 Typical    
##  8 Attchd      RFn                     2         506 Typical    
##  9 Attchd      RFn                     2         608 Typical    
## 10 Attchd      Fin                     2         442 Typical    
## # … with 2,920 more rows</code></pre>
<p>Funciones útiles para <em>select()</em>:</p>
<ul>
<li><p><em>contains()</em>: Selecciona variables cuyo nombre contiene la cadena de texto.</p></li>
<li><p><em>ends_with()</em>: Selecciona variables cuyo nombre termina con la cadena de caracteres.</p></li>
<li><p><em>everything()</em>: Selecciona todas las columnas.</p></li>
<li><p><em>matches()</em>: Selecciona las variables cuyos nombres coinciden con una expresión regular.</p></li>
<li><p><em>num_range()</em>: Selecciona las variables por posición.</p></li>
<li><p><em>start_with()</em>: Selecciona variables cuyos nombres empiezan con la cadena de caracteres.</p></li>
<li><p><em>any_of</em>: Selecciona cualquiera de estas variables, en caso de existir</p></li>
</ul>
<p><strong>EJERCICIO:</strong></p>
<ul>
<li>Crear con datos propios una consulta de columnas usando como variable auxiliar cada una de las listadas anteriormente. Será suficiente con realizar un ejemplo de cada una.</li>
</ul>
</div>
<div id="filtrar-observaciones" class="section level3 hasAnchor" number="3.2.2">
<h3><span class="header-section-number">3.2.2</span> Filtrar observaciones<a href="tidyverse.html#filtrar-observaciones" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>La función <em>filter()</em> nos permite filtrar filas según una condición, primero notemos que la variable <em>Sale_Condition</em> tiene distintas categorías.</p>
<div class="sourceCode" id="cb217"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb217-1"><a href="tidyverse.html#cb217-1" aria-hidden="true" tabindex="-1"></a><span class="fu">table</span>(ames_housing<span class="sc">$</span>Sale_Condition)</span></code></pre></div>
<pre><code>## 
## Abnorml AdjLand  Alloca  Family  Normal Partial 
##     190      12      24      46    2413     245</code></pre>
<div class="infobox important">
<p><strong>¡¡ SPOILER !!</strong></p>
<p>En un modelo predictivo de Machine Learning, <strong>no es correcto</strong> agregar columnas cuyo valor es conocido hasta el momento de la observación. Es decir, no deben agregarse variables que no se conozca su valor al momento de la predicción, como es el caso de <em>condición de venta</em>.</p>
</div>
<p>Ahora usaremos la función <em>filter</em> para quedarnos solo con las observaciones con condición de venta “normal”.</p>
<div class="sourceCode" id="cb219"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb219-1"><a href="tidyverse.html#cb219-1" aria-hidden="true" tabindex="-1"></a>ames_housing <span class="sc">%&gt;%</span> <span class="fu">filter</span>(Sale_Condition <span class="sc">==</span> <span class="st">&quot;Normal&quot;</span>)</span></code></pre></div>
<pre><code>## # A tibble: 2,413 × 74
##    MS_Sub…¹ MS_Zo…² Lot_F…³ Lot_A…⁴ Street Alley Lot_S…⁵ Land_…⁶ Utili…⁷ Lot_C…⁸
##    &lt;chr&gt;    &lt;chr&gt;     &lt;dbl&gt;   &lt;dbl&gt; &lt;chr&gt;  &lt;chr&gt; &lt;chr&gt;   &lt;chr&gt;   &lt;chr&gt;   &lt;chr&gt;  
##  1 One_Sto… Reside…     141   31770 Pave   No_A… Slight… Lvl     AllPub  Corner 
##  2 One_Sto… Reside…      80   11622 Pave   No_A… Regular Lvl     AllPub  Inside 
##  3 One_Sto… Reside…      81   14267 Pave   No_A… Slight… Lvl     AllPub  Corner 
##  4 One_Sto… Reside…      93   11160 Pave   No_A… Regular Lvl     AllPub  Corner 
##  5 Two_Sto… Reside…      74   13830 Pave   No_A… Slight… Lvl     AllPub  Inside 
##  6 Two_Sto… Reside…      78    9978 Pave   No_A… Slight… Lvl     AllPub  Inside 
##  7 One_Sto… Reside…      41    4920 Pave   No_A… Regular Lvl     AllPub  Inside 
##  8 One_Sto… Reside…      43    5005 Pave   No_A… Slight… HLS     AllPub  Inside 
##  9 One_Sto… Reside…      39    5389 Pave   No_A… Slight… Lvl     AllPub  Inside 
## 10 Two_Sto… Reside…      60    7500 Pave   No_A… Regular Lvl     AllPub  Inside 
## # … with 2,403 more rows, 64 more variables: Land_Slope &lt;chr&gt;,
## #   Neighborhood &lt;chr&gt;, Condition_1 &lt;chr&gt;, Condition_2 &lt;chr&gt;, Bldg_Type &lt;chr&gt;,
## #   House_Style &lt;chr&gt;, Overall_Cond &lt;chr&gt;, Year_Built &lt;dbl&gt;,
## #   Year_Remod_Add &lt;dbl&gt;, Roof_Style &lt;chr&gt;, Roof_Matl &lt;chr&gt;,
## #   Exterior_1st &lt;chr&gt;, Exterior_2nd &lt;chr&gt;, Mas_Vnr_Type &lt;chr&gt;,
## #   Mas_Vnr_Area &lt;dbl&gt;, Exter_Cond &lt;chr&gt;, Foundation &lt;chr&gt;, Bsmt_Cond &lt;chr&gt;,
## #   Bsmt_Exposure &lt;chr&gt;, BsmtFin_Type_1 &lt;chr&gt;, BsmtFin_SF_1 &lt;dbl&gt;, …</code></pre>
<p>También se puede usar para filtrar variables numéricas:</p>
<div class="sourceCode" id="cb221"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb221-1"><a href="tidyverse.html#cb221-1" aria-hidden="true" tabindex="-1"></a>ames_housing <span class="sc">%&gt;%</span> <span class="fu">filter</span>(Lot_Area <span class="sc">&gt;</span> <span class="dv">1000</span> <span class="sc">&amp;</span> Sale_Price <span class="sc">&gt;=</span> <span class="dv">150000</span>)</span></code></pre></div>
<pre><code>## # A tibble: 1,677 × 74
##    MS_Sub…¹ MS_Zo…² Lot_F…³ Lot_A…⁴ Street Alley Lot_S…⁵ Land_…⁶ Utili…⁷ Lot_C…⁸
##    &lt;chr&gt;    &lt;chr&gt;     &lt;dbl&gt;   &lt;dbl&gt; &lt;chr&gt;  &lt;chr&gt; &lt;chr&gt;   &lt;chr&gt;   &lt;chr&gt;   &lt;chr&gt;  
##  1 One_Sto… Reside…     141   31770 Pave   No_A… Slight… Lvl     AllPub  Corner 
##  2 One_Sto… Reside…      81   14267 Pave   No_A… Slight… Lvl     AllPub  Corner 
##  3 One_Sto… Reside…      93   11160 Pave   No_A… Regular Lvl     AllPub  Corner 
##  4 Two_Sto… Reside…      74   13830 Pave   No_A… Slight… Lvl     AllPub  Inside 
##  5 Two_Sto… Reside…      78    9978 Pave   No_A… Slight… Lvl     AllPub  Inside 
##  6 One_Sto… Reside…      41    4920 Pave   No_A… Regular Lvl     AllPub  Inside 
##  7 One_Sto… Reside…      43    5005 Pave   No_A… Slight… HLS     AllPub  Inside 
##  8 One_Sto… Reside…      39    5389 Pave   No_A… Slight… Lvl     AllPub  Inside 
##  9 Two_Sto… Reside…      60    7500 Pave   No_A… Regular Lvl     AllPub  Inside 
## 10 Two_Sto… Reside…      75   10000 Pave   No_A… Slight… Lvl     AllPub  Corner 
## # … with 1,667 more rows, 64 more variables: Land_Slope &lt;chr&gt;,
## #   Neighborhood &lt;chr&gt;, Condition_1 &lt;chr&gt;, Condition_2 &lt;chr&gt;, Bldg_Type &lt;chr&gt;,
## #   House_Style &lt;chr&gt;, Overall_Cond &lt;chr&gt;, Year_Built &lt;dbl&gt;,
## #   Year_Remod_Add &lt;dbl&gt;, Roof_Style &lt;chr&gt;, Roof_Matl &lt;chr&gt;,
## #   Exterior_1st &lt;chr&gt;, Exterior_2nd &lt;chr&gt;, Mas_Vnr_Type &lt;chr&gt;,
## #   Mas_Vnr_Area &lt;dbl&gt;, Exter_Cond &lt;chr&gt;, Foundation &lt;chr&gt;, Bsmt_Cond &lt;chr&gt;,
## #   Bsmt_Exposure &lt;chr&gt;, BsmtFin_Type_1 &lt;chr&gt;, BsmtFin_SF_1 &lt;dbl&gt;, …</code></pre>
<p>Notemos que en el ejemplo anterior se usa <em>&amp;</em>, que ayuda a filtrar por dos condiciones.</p>
<p>También puede usarse <em>|</em> para filtrar por alguna de las dos condiciones.</p>
<div class="sourceCode" id="cb223"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb223-1"><a href="tidyverse.html#cb223-1" aria-hidden="true" tabindex="-1"></a>ames_housing <span class="sc">%&gt;%</span> <span class="fu">filter</span>(Lot_Area <span class="sc">&lt;</span> <span class="dv">1000</span> <span class="sc">|</span> Sale_Price <span class="sc">&lt;=</span> <span class="dv">150000</span>)</span></code></pre></div>
<pre><code>## # A tibble: 1,271 × 74
##    MS_Sub…¹ MS_Zo…² Lot_F…³ Lot_A…⁴ Street Alley Lot_S…⁵ Land_…⁶ Utili…⁷ Lot_C…⁸
##    &lt;chr&gt;    &lt;chr&gt;     &lt;dbl&gt;   &lt;dbl&gt; &lt;chr&gt;  &lt;chr&gt; &lt;chr&gt;   &lt;chr&gt;   &lt;chr&gt;   &lt;chr&gt;  
##  1 One_Sto… Reside…      80   11622 Pave   No_A… Regular Lvl     AllPub  Inside 
##  2 One_Sto… Reside…     140   19138 Pave   No_A… Regular Lvl     AllPub  Corner 
##  3 One_Sto… Reside…       0   11241 Pave   No_A… Slight… Lvl     AllPub  CulDSac
##  4 One_Sto… Reside…       0   12537 Pave   No_A… Slight… Lvl     AllPub  CulDSac
##  5 One_Sto… Reside…      65    8450 Pave   No_A… Regular Lvl     AllPub  Inside 
##  6 One_Sto… Reside…      70    8400 Pave   No_A… Regular Lvl     AllPub  Corner 
##  7 One_Sto… Reside…      70   10500 Pave   No_A… Regular Lvl     AllPub  FR2    
##  8 Two_Sto… Reside…      21    1680 Pave   No_A… Regular Lvl     AllPub  Inside 
##  9 Two_Sto… Reside…      21    1680 Pave   No_A… Regular Lvl     AllPub  Inside 
## 10 Two_Sto… Reside…      21    1680 Pave   No_A… Regular Lvl     AllPub  Inside 
## # … with 1,261 more rows, 64 more variables: Land_Slope &lt;chr&gt;,
## #   Neighborhood &lt;chr&gt;, Condition_1 &lt;chr&gt;, Condition_2 &lt;chr&gt;, Bldg_Type &lt;chr&gt;,
## #   House_Style &lt;chr&gt;, Overall_Cond &lt;chr&gt;, Year_Built &lt;dbl&gt;,
## #   Year_Remod_Add &lt;dbl&gt;, Roof_Style &lt;chr&gt;, Roof_Matl &lt;chr&gt;,
## #   Exterior_1st &lt;chr&gt;, Exterior_2nd &lt;chr&gt;, Mas_Vnr_Type &lt;chr&gt;,
## #   Mas_Vnr_Area &lt;dbl&gt;, Exter_Cond &lt;chr&gt;, Foundation &lt;chr&gt;, Bsmt_Cond &lt;chr&gt;,
## #   Bsmt_Exposure &lt;chr&gt;, BsmtFin_Type_1 &lt;chr&gt;, BsmtFin_SF_1 &lt;dbl&gt;, …</code></pre>
<p>Las condiciones pueden ser expresiones lógicas construidas mediante los operadores relacionales y lógicos:</p>
<ul>
<li><p><strong>&lt;</strong> : Menor que</p></li>
<li><p><strong>&gt;</strong> : Mayor que</p></li>
<li><p><strong>==</strong> : Igual que</p></li>
<li><p><strong>&lt;=</strong> : Menor o igual que</p></li>
<li><p><strong>&gt;=</strong> : Mayor o igual que</p></li>
<li><p><strong>!=</strong> : Diferente que</p></li>
<li><p><strong>%in%</strong> : Pertenece al conjunto</p></li>
<li><p><strong>is.na</strong> : Es NA</p></li>
<li><p><strong>!is.na</strong> : No es NA</p></li>
</ul>
<p><strong>EJERCICIO:</strong></p>
<ul>
<li><p>Practicar la función de filtro de observaciones usando los operadores auxiliares.</p></li>
<li><p>Concatenar el resultado de seleccionar columnas y posteriormente filtrar columnas.</p></li>
</ul>
</div>
<div id="ordenar-registros" class="section level3 hasAnchor" number="3.2.3">
<h3><span class="header-section-number">3.2.3</span> Ordenar registros<a href="tidyverse.html#ordenar-registros" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>La función <em>arrange()</em> se utiliza para ordenar las filas de un data frame de acuerdo a una o varias variables. Este ordenamiento puede ser ascendente o descendente.</p>
<p>Por defecto <em>arrange()</em> ordena las filas por orden ascendente:</p>
<div class="sourceCode" id="cb225"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb225-1"><a href="tidyverse.html#cb225-1" aria-hidden="true" tabindex="-1"></a>ames_housing <span class="sc">%&gt;%</span> <span class="fu">arrange</span>(Sale_Price)</span></code></pre></div>
<pre><code>## # A tibble: 2,930 × 74
##    MS_Sub…¹ MS_Zo…² Lot_F…³ Lot_A…⁴ Street Alley Lot_S…⁵ Land_…⁶ Utili…⁷ Lot_C…⁸
##    &lt;chr&gt;    &lt;chr&gt;     &lt;dbl&gt;   &lt;dbl&gt; &lt;chr&gt;  &lt;chr&gt; &lt;chr&gt;   &lt;chr&gt;   &lt;chr&gt;   &lt;chr&gt;  
##  1 One_Sto… Reside…      68    9656 Pave   No_A… Regular Lvl     AllPub  Inside 
##  2 One_Sto… A_agr        80   14584 Pave   No_A… Regular Low     AllPub  Inside 
##  3 One_Sto… C_all        60    7879 Pave   No_A… Regular Lvl     AllPub  Inside 
##  4 One_Sto… Reside…      60    8088 Pave   Grav… Regular Lvl     AllPub  Inside 
##  5 One_Sto… C_all        50    9000 Pave   No_A… Regular Lvl     AllPub  Inside 
##  6 One_and… Reside…      50    5925 Pave   No_A… Regular Lvl     AllPub  Inside 
##  7 One_Sto… Reside…      50    5000 Pave   No_A… Regular Low     AllPub  Inside 
##  8 Two_Sto… C_all        50    8500 Pave   Paved Regular Lvl     AllPub  Inside 
##  9 One_Sto… C_all        72    9392 Pave   No_A… Regular Lvl     AllPub  Corner 
## 10 One_Sto… Reside…      50    5925 Pave   No_A… Regular Lvl     AllPub  Corner 
## # … with 2,920 more rows, 64 more variables: Land_Slope &lt;chr&gt;,
## #   Neighborhood &lt;chr&gt;, Condition_1 &lt;chr&gt;, Condition_2 &lt;chr&gt;, Bldg_Type &lt;chr&gt;,
## #   House_Style &lt;chr&gt;, Overall_Cond &lt;chr&gt;, Year_Built &lt;dbl&gt;,
## #   Year_Remod_Add &lt;dbl&gt;, Roof_Style &lt;chr&gt;, Roof_Matl &lt;chr&gt;,
## #   Exterior_1st &lt;chr&gt;, Exterior_2nd &lt;chr&gt;, Mas_Vnr_Type &lt;chr&gt;,
## #   Mas_Vnr_Area &lt;dbl&gt;, Exter_Cond &lt;chr&gt;, Foundation &lt;chr&gt;, Bsmt_Cond &lt;chr&gt;,
## #   Bsmt_Exposure &lt;chr&gt;, BsmtFin_Type_1 &lt;chr&gt;, BsmtFin_SF_1 &lt;dbl&gt;, …</code></pre>
<p><br> <br></p>
<p>Si las queremos ordenar de forma ascendente, lo haremos del siguiente modo:</p>
<div class="sourceCode" id="cb227"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb227-1"><a href="tidyverse.html#cb227-1" aria-hidden="true" tabindex="-1"></a>ames_housing <span class="sc">%&gt;%</span> <span class="fu">arrange</span>(<span class="fu">desc</span>(Sale_Price))</span></code></pre></div>
<pre><code>## # A tibble: 2,930 × 74
##    MS_Sub…¹ MS_Zo…² Lot_F…³ Lot_A…⁴ Street Alley Lot_S…⁵ Land_…⁶ Utili…⁷ Lot_C…⁸
##    &lt;chr&gt;    &lt;chr&gt;     &lt;dbl&gt;   &lt;dbl&gt; &lt;chr&gt;  &lt;chr&gt; &lt;chr&gt;   &lt;chr&gt;   &lt;chr&gt;   &lt;chr&gt;  
##  1 Two_Sto… Reside…     104   21535 Pave   No_A… Slight… Lvl     AllPub  Corner 
##  2 Two_Sto… Reside…     160   15623 Pave   No_A… Slight… Lvl     AllPub  Corner 
##  3 Two_Sto… Reside…     118   35760 Pave   No_A… Slight… Lvl     AllPub  CulDSac
##  4 One_Sto… Reside…     106   12720 Pave   No_A… Regular HLS     AllPub  Inside 
##  5 One_Sto… Reside…     100   12919 Pave   No_A… Slight… Lvl     AllPub  Inside 
##  6 One_Sto… Reside…     105   13693 Pave   No_A… Regular Lvl     AllPub  Inside 
##  7 One_Sto… Reside…      52   51974 Pave   No_A… Slight… Lvl     AllPub  CulDSac
##  8 Two_Sto… Reside…     114   17242 Pave   No_A… Slight… Lvl     AllPub  Inside 
##  9 Two_Sto… Reside…     107   13891 Pave   No_A… Regular Lvl     AllPub  Inside 
## 10 Two_Sto… Reside…      85   16056 Pave   No_A… Slight… Lvl     AllPub  Inside 
## # … with 2,920 more rows, 64 more variables: Land_Slope &lt;chr&gt;,
## #   Neighborhood &lt;chr&gt;, Condition_1 &lt;chr&gt;, Condition_2 &lt;chr&gt;, Bldg_Type &lt;chr&gt;,
## #   House_Style &lt;chr&gt;, Overall_Cond &lt;chr&gt;, Year_Built &lt;dbl&gt;,
## #   Year_Remod_Add &lt;dbl&gt;, Roof_Style &lt;chr&gt;, Roof_Matl &lt;chr&gt;,
## #   Exterior_1st &lt;chr&gt;, Exterior_2nd &lt;chr&gt;, Mas_Vnr_Type &lt;chr&gt;,
## #   Mas_Vnr_Area &lt;dbl&gt;, Exter_Cond &lt;chr&gt;, Foundation &lt;chr&gt;, Bsmt_Cond &lt;chr&gt;,
## #   Bsmt_Exposure &lt;chr&gt;, BsmtFin_Type_1 &lt;chr&gt;, BsmtFin_SF_1 &lt;dbl&gt;, …</code></pre>
<p>Si se desea usar dos o más columnas para realizar el ordenamiento, deben separarse por comas cada una de las características</p>
<div class="sourceCode" id="cb229"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb229-1"><a href="tidyverse.html#cb229-1" aria-hidden="true" tabindex="-1"></a>ames_housing <span class="sc">%&gt;%</span> </span>
<span id="cb229-2"><a href="tidyverse.html#cb229-2" aria-hidden="true" tabindex="-1"></a> <span class="fu">arrange</span>(Sale_Condition, <span class="fu">desc</span>(Sale_Price), Lot_Area) <span class="sc">%&gt;%</span> </span>
<span id="cb229-3"><a href="tidyverse.html#cb229-3" aria-hidden="true" tabindex="-1"></a> <span class="fu">select</span>(Sale_Condition, Sale_Price, Lot_Area)</span></code></pre></div>
<pre><code>## # A tibble: 2,930 × 3
##    Sale_Condition Sale_Price Lot_Area
##    &lt;chr&gt;               &lt;dbl&gt;    &lt;dbl&gt;
##  1 Abnorml            745000    15623
##  2 Abnorml            552000    14836
##  3 Abnorml            475000    11778
##  4 Abnorml            390000    13418
##  5 Abnorml            328900     5119
##  6 Abnorml            310000    14541
##  7 Abnorml            290000     9950
##  8 Abnorml            287000    15498
##  9 Abnorml            258000    12090
## 10 Abnorml            257000    10994
## # … with 2,920 more rows</code></pre>
<p>Notemos que en el ejemplo anterior usamos dos <em>pipes</em> (%&gt;%), como habíamos mencionado se pueden usar los necesarios para combinar funciones.</p>
</div>
<div id="agregar-modificar" class="section level3 hasAnchor" number="3.2.4">
<h3><span class="header-section-number">3.2.4</span> Agregar / Modificar<a href="tidyverse.html#agregar-modificar" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Con la función <em>mutate()</em> podemos computar transformaciones de variables en un data frame. A menudo, tendremos la necesidad de crear nuevas variables que se calculan a partir de variables existentes. La función <em>mutate()</em> proporciona una interfaz clara para realizar este tipo de operaciones.</p>
<p>Por ejemplo, haremos el cálculo de la antigüedad del inmueble a partir de las variables <em>Year_Sold</em> y <em>Year_Remod_Add</em>:</p>
<div class="sourceCode" id="cb231"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb231-1"><a href="tidyverse.html#cb231-1" aria-hidden="true" tabindex="-1"></a>ejemplo_mutate <span class="ot">&lt;-</span> ames_housing <span class="sc">%&gt;%</span> </span>
<span id="cb231-2"><a href="tidyverse.html#cb231-2" aria-hidden="true" tabindex="-1"></a> <span class="fu">select</span>(Year_Sold, Year_Remod_Add) <span class="sc">%&gt;%</span></span>
<span id="cb231-3"><a href="tidyverse.html#cb231-3" aria-hidden="true" tabindex="-1"></a> <span class="fu">mutate</span>(<span class="at">Antique =</span> Year_Sold <span class="sc">-</span> Year_Remod_Add)</span>
<span id="cb231-4"><a href="tidyverse.html#cb231-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb231-5"><a href="tidyverse.html#cb231-5" aria-hidden="true" tabindex="-1"></a>ejemplo_mutate</span></code></pre></div>
<pre><code>## # A tibble: 2,930 × 3
##    Year_Sold Year_Remod_Add Antique
##        &lt;dbl&gt;          &lt;dbl&gt;   &lt;dbl&gt;
##  1      2010           1960      50
##  2      2010           1961      49
##  3      2010           1958      52
##  4      2010           1968      42
##  5      2010           1998      12
##  6      2010           1998      12
##  7      2010           2001       9
##  8      2010           1992      18
##  9      2010           1996      14
## 10      2010           1999      11
## # … with 2,920 more rows</code></pre>
<p>El ejemplo anterior crea una nueva variable. Ahora se presenta otro ejemplo en donde se modifica una variable ya creada.</p>
<div class="sourceCode" id="cb233"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb233-1"><a href="tidyverse.html#cb233-1" aria-hidden="true" tabindex="-1"></a>ejemplo_mutate <span class="sc">%&gt;%</span> </span>
<span id="cb233-2"><a href="tidyverse.html#cb233-2" aria-hidden="true" tabindex="-1"></a> <span class="fu">mutate</span>(<span class="at">Antique =</span> Antique <span class="sc">*</span> <span class="dv">12</span>)</span></code></pre></div>
<pre><code>## # A tibble: 2,930 × 3
##    Year_Sold Year_Remod_Add Antique
##        &lt;dbl&gt;          &lt;dbl&gt;   &lt;dbl&gt;
##  1      2010           1960     600
##  2      2010           1961     588
##  3      2010           1958     624
##  4      2010           1968     504
##  5      2010           1998     144
##  6      2010           1998     144
##  7      2010           2001     108
##  8      2010           1992     216
##  9      2010           1996     168
## 10      2010           1999     132
## # … with 2,920 more rows</code></pre>
<p>En este segundo ejemplo, se modifica el número de años de antigüedad y se multiplica por un factor de 12 para modificar el tiempo en una escala de meses.</p>
</div>
<div id="resumen-estadístico" class="section level3 hasAnchor" number="3.2.5">
<h3><span class="header-section-number">3.2.5</span> Resumen estadístico<a href="tidyverse.html#resumen-estadístico" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>La función <em>summarise()</em> se comporta de forma análoga a la función <em>mutate()</em>, excepto que en lugar de añadir nuevas columnas crea un nuevo data frame.</p>
<p>Podemos usar el ejemplo anterior y calcular la media de la variable creada <em>Antique</em>:</p>
<div class="sourceCode" id="cb235"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb235-1"><a href="tidyverse.html#cb235-1" aria-hidden="true" tabindex="-1"></a>ames_housing <span class="sc">%&gt;%</span> </span>
<span id="cb235-2"><a href="tidyverse.html#cb235-2" aria-hidden="true" tabindex="-1"></a> <span class="fu">select</span>(Year_Sold, Year_Remod_Add) <span class="sc">%&gt;%</span></span>
<span id="cb235-3"><a href="tidyverse.html#cb235-3" aria-hidden="true" tabindex="-1"></a> <span class="fu">mutate</span>(<span class="at">Antique =</span> Year_Sold <span class="sc">-</span> Year_Remod_Add) <span class="sc">%&gt;%</span></span>
<span id="cb235-4"><a href="tidyverse.html#cb235-4" aria-hidden="true" tabindex="-1"></a> <span class="fu">summarise</span>(<span class="at">Mean_Antique =</span> <span class="fu">mean</span>(Antique))</span></code></pre></div>
<pre><code>## # A tibble: 1 × 1
##   Mean_Antique
##          &lt;dbl&gt;
## 1         23.5</code></pre>
<p>Solo fue necesario agregar un <em>pipe</em>, especificar el nombre de la variable creada y la operación a realizar.</p>
<p>A continuación se muestran funciones que trabajando conjuntamente con la función summarise() facilitarán nuestro trabajo diario. Las primeras pertenecen al paquete base y las otras son del paquete dplyr. Todas ellas toman como argumento un vector y devuelven un único resultado:</p>
<ul>
<li><p><em>min(), max()</em> : Valores max y min.</p></li>
<li><p><em>mean()</em> : Media.</p></li>
<li><p><em>median()</em> : Mediana.</p></li>
<li><p><em>sum()</em> : Suma de los valores.</p></li>
<li><p><em>var(), sd()</em> : Varianza y desviación estándar.</p></li>
<li><p><em>first()</em> : Primer valor en un vector.</p></li>
<li><p><em>last()</em> : El último valor en un vector</p></li>
<li><p><em>n()</em> : El número de valores en un vector.</p></li>
<li><p><em>n_distinct()</em> : El número de valores distintos en un vector.</p></li>
<li><p><em>nth()</em> : Extrae el valor que ocupa la posición n en un vector.</p></li>
</ul>
<p>Mas adelante veremos como combinar esta función con la función <em>group_by()</em> para calcular estadísticos agrupados por alguna característica de interés.</p>
<p><strong>EJERCICIO:</strong></p>
<ul>
<li>Realizar una consulta usando <em>summarise()</em> y cada una de las funciones estadísticas listadas anteriormente.</li>
</ul>
</div>
<div id="agrupamiento" class="section level3 hasAnchor" number="3.2.6">
<h3><span class="header-section-number">3.2.6</span> Agrupamiento<a href="tidyverse.html#agrupamiento" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>La función <em>group_by()</em> agrupa un conjunto de filas de acuerdo con los valores de una o más columnas o expresiones.</p>
<p>Usaremos el ejemplo anterior. Primero creamos nuestra nueva variable <em>Antique</em>, después agrupamos por vecindario y al final calculamos la media de la variable <em>Antique</em>. Gracias al agrupamiento, nos regresara una media por cada grupo creado, es decir, nos regresara el promedio de la antigüedad por vecindario.</p>
<div class="sourceCode" id="cb237"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb237-1"><a href="tidyverse.html#cb237-1" aria-hidden="true" tabindex="-1"></a>ames_housing <span class="sc">%&gt;%</span> </span>
<span id="cb237-2"><a href="tidyverse.html#cb237-2" aria-hidden="true" tabindex="-1"></a> <span class="fu">mutate</span>(<span class="at">Antique =</span> Year_Sold <span class="sc">-</span> Year_Remod_Add) <span class="sc">%&gt;%</span> </span>
<span id="cb237-3"><a href="tidyverse.html#cb237-3" aria-hidden="true" tabindex="-1"></a> <span class="fu">group_by</span>(Neighborhood) <span class="sc">%&gt;%</span> </span>
<span id="cb237-4"><a href="tidyverse.html#cb237-4" aria-hidden="true" tabindex="-1"></a> <span class="fu">summarise</span>(<span class="at">Mean_Antique =</span> <span class="fu">round</span>(<span class="fu">mean</span>(Antique), <span class="dv">0</span>))</span></code></pre></div>
<pre><code>## # A tibble: 28 × 2
##    Neighborhood        Mean_Antique
##    &lt;chr&gt;                      &lt;dbl&gt;
##  1 Bloomington_Heights            2
##  2 Blueste                       25
##  3 Briardale                     35
##  4 Brookside                     39
##  5 Clear_Creek                   28
##  6 College_Creek                  8
##  7 Crawford                      29
##  8 Edwards                       33
##  9 Gilbert                        9
## 10 Green_Hills                   14
## # … with 18 more rows</code></pre>
</div>
<div id="cruces-de-tablas" class="section level3 hasAnchor" number="3.2.7">
<h3><span class="header-section-number">3.2.7</span> Cruces de tablas<a href="tidyverse.html#cruces-de-tablas" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Una operación fundamental por agregar al flujo de trabajo es el cruce de tablas, las cuales pueden proceder de la misma o de distinta fuente. Comúnmente <strong>este proceso se realiza para enriquecer y unificar la información</strong> proveniente de distintas tablas.</p>
<p>Para lograr esta tarea es indispensable que exista una variable <strong>llave</strong> en ambos conjuntos de datos que sirva como puente o identificador de cada caso o renglón. Si se cuenta con la columna llave entonces será posible cruzar las tablas y lograr su enriquecimiento.</p>
<p>En el siguiente ejemplo se muestra el uso de la variable llave a través de la columna “ID”. Se puede apreciar que en la tabla final se cuenta con información de la variable “Weight” para los elementos que existen en las tablas “A” y “B”.</p>
<p><img src="img/04-tidyverse/left_join3.png" width="700pt" style="display: block; margin: auto;" /></p>
<p>La función que hace posible el complemento de la información es llamada <em>left_join()</em>. El primer argumento de la función corresponde al conjunto de datos que se desea complementar, mientras que en el segundo argumento se ingresa el conjunto de datos con la información que enriquecerá al primer conjunto. Es necesario especificar en el argumento <em>“by”</em> el nombre de la columna llave.</p>
<div class="sourceCode" id="cb239"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb239-1"><a href="tidyverse.html#cb239-1" aria-hidden="true" tabindex="-1"></a>conjuntoX <span class="ot">&lt;-</span> <span class="fu">tibble</span>(<span class="st">&quot;Llave&quot;</span> <span class="ot">=</span> LETTERS[<span class="dv">1</span><span class="sc">:</span><span class="dv">8</span>], <span class="st">&quot;C1&quot;</span> <span class="ot">=</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">8</span>)</span>
<span id="cb239-2"><a href="tidyverse.html#cb239-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb239-3"><a href="tidyverse.html#cb239-3" aria-hidden="true" tabindex="-1"></a>conjuntoY <span class="ot">&lt;-</span> <span class="fu">tibble</span>(</span>
<span id="cb239-4"><a href="tidyverse.html#cb239-4" aria-hidden="true" tabindex="-1"></a> <span class="st">&quot;Llave&quot;</span> <span class="ot">=</span> <span class="fu">sample</span>(LETTERS[<span class="dv">11</span><span class="sc">:</span><span class="dv">3</span>], <span class="at">size =</span> <span class="dv">9</span>, <span class="at">replace =</span> T), </span>
<span id="cb239-5"><a href="tidyverse.html#cb239-5" aria-hidden="true" tabindex="-1"></a> <span class="st">&quot;Ex1&quot;</span> <span class="ot">=</span> letters[<span class="dv">2</span><span class="sc">:</span><span class="dv">10</span>], </span>
<span id="cb239-6"><a href="tidyverse.html#cb239-6" aria-hidden="true" tabindex="-1"></a> <span class="st">&quot;Ex2&quot;</span> <span class="ot">=</span> <span class="dv">1002</span><span class="sc">:</span><span class="dv">1010</span>,<span class="st">&quot;Ex3&quot;</span> <span class="ot">=</span> <span class="fu">paste0</span>(letters[<span class="dv">12</span><span class="sc">:</span><span class="dv">20</span>], <span class="dv">2</span><span class="sc">:</span><span class="dv">10</span>)</span>
<span id="cb239-7"><a href="tidyverse.html#cb239-7" aria-hidden="true" tabindex="-1"></a> )</span>
<span id="cb239-8"><a href="tidyverse.html#cb239-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb239-9"><a href="tidyverse.html#cb239-9" aria-hidden="true" tabindex="-1"></a>conjuntoX</span></code></pre></div>
<pre><code>## # A tibble: 8 × 2
##   Llave    C1
##   &lt;chr&gt; &lt;int&gt;
## 1 A         1
## 2 B         2
## 3 C         3
## 4 D         4
## 5 E         5
## 6 F         6
## 7 G         7
## 8 H         8</code></pre>
<div class="sourceCode" id="cb241"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb241-1"><a href="tidyverse.html#cb241-1" aria-hidden="true" tabindex="-1"></a>conjuntoY</span></code></pre></div>
<pre><code>## # A tibble: 9 × 4
##   Llave Ex1     Ex2 Ex3  
##   &lt;chr&gt; &lt;chr&gt; &lt;int&gt; &lt;chr&gt;
## 1 F     b      1002 l2   
## 2 I     c      1003 m3   
## 3 K     d      1004 n4   
## 4 H     e      1005 o5   
## 5 F     f      1006 p6   
## 6 J     g      1007 q7   
## 7 C     h      1008 r8   
## 8 J     i      1009 s9   
## 9 I     j      1010 t10</code></pre>
<div class="sourceCode" id="cb243"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb243-1"><a href="tidyverse.html#cb243-1" aria-hidden="true" tabindex="-1"></a><span class="fu">left_join</span>(<span class="at">x =</span> conjuntoX, <span class="at">y =</span> conjuntoY, <span class="at">by =</span> <span class="st">&quot;Llave&quot;</span>)</span></code></pre></div>
<pre><code>## # A tibble: 9 × 5
##   Llave    C1 Ex1     Ex2 Ex3  
##   &lt;chr&gt; &lt;int&gt; &lt;chr&gt; &lt;int&gt; &lt;chr&gt;
## 1 A         1 &lt;NA&gt;     NA &lt;NA&gt; 
## 2 B         2 &lt;NA&gt;     NA &lt;NA&gt; 
## 3 C         3 h      1008 r8   
## 4 D         4 &lt;NA&gt;     NA &lt;NA&gt; 
## 5 E         5 &lt;NA&gt;     NA &lt;NA&gt; 
## 6 F         6 b      1002 l2   
## 7 F         6 f      1006 p6   
## 8 G         7 &lt;NA&gt;     NA &lt;NA&gt; 
## 9 H         8 e      1005 o5</code></pre>
<p>Es posible que no todas las observaciones de un conjunto de datos estén en el otro conjunto. Cuando esto sucede, un aviso aparece indicando que los factores o categorías de la variable llave son diferentes. En caso de no encontrarse uno o más de los valores, el resultado para esos casos será NA (no disponible, por su traducción del inglés “Not Available”), y aparecerá siempre que no se cuente con información en un registro, como se muestra en el ejemplo anterior.</p>
<p>Existen diferentes maneras de conjuntar datos. La primera, como en el ejemplo mostrado anteriormente, se hace por lo izquierda y quiere decir que, <strong>al primer conjunto de datos es al que se le agregará la información del segundo conjunto</strong>. Esto se realizará exclusivamente para aquellos registros de la segunda tabla que existan también en la primera, los cuales se identifican mediante la llave definida.</p>
<p>Otra manera de realizar la conjunción de los datos es por la derecha. Funciona de manera análoga a la primera, con la diferencia de que son los datos del primer conjunto los que se agregan al segundo. De igual manera, esto sólo ocurre para los elemento del primer conjunto que se encuentran en el segundo y que son identificables a través de una llave. La función en <em>R</em> que permite realizar la conjunción por la derecha lleva por nombre <em>right_join()</em>.</p>
<div class="sourceCode" id="cb245"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb245-1"><a href="tidyverse.html#cb245-1" aria-hidden="true" tabindex="-1"></a><span class="fu">right_join</span>(<span class="at">x =</span> conjuntoX, <span class="at">y =</span> conjuntoY, <span class="at">by =</span> <span class="st">&quot;Llave&quot;</span>)</span></code></pre></div>
<pre><code>## # A tibble: 9 × 5
##   Llave    C1 Ex1     Ex2 Ex3  
##   &lt;chr&gt; &lt;int&gt; &lt;chr&gt; &lt;int&gt; &lt;chr&gt;
## 1 C         3 h      1008 r8   
## 2 F         6 b      1002 l2   
## 3 F         6 f      1006 p6   
## 4 H         8 e      1005 o5   
## 5 I        NA c      1003 m3   
## 6 K        NA d      1004 n4   
## 7 J        NA g      1007 q7   
## 8 J        NA i      1009 s9   
## 9 I        NA j      1010 t10</code></pre>
<p>Una tercer forma de unir los datos es a través de la función <em>full_join()</em>, la cual es una combinación de las dos anteriores. Agrega todos los elementos llave tanto del primer conjunto como del segundo y posteriormente realiza el cruce de información de ambos conjuntos.</p>
<div class="sourceCode" id="cb247"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb247-1"><a href="tidyverse.html#cb247-1" aria-hidden="true" tabindex="-1"></a><span class="fu">full_join</span>(<span class="at">x =</span> conjuntoX, <span class="at">y =</span> conjuntoY, <span class="at">by =</span> <span class="st">&quot;Llave&quot;</span>)</span></code></pre></div>
<pre><code>## # A tibble: 14 × 5
##    Llave    C1 Ex1     Ex2 Ex3  
##    &lt;chr&gt; &lt;int&gt; &lt;chr&gt; &lt;int&gt; &lt;chr&gt;
##  1 A         1 &lt;NA&gt;     NA &lt;NA&gt; 
##  2 B         2 &lt;NA&gt;     NA &lt;NA&gt; 
##  3 C         3 h      1008 r8   
##  4 D         4 &lt;NA&gt;     NA &lt;NA&gt; 
##  5 E         5 &lt;NA&gt;     NA &lt;NA&gt; 
##  6 F         6 b      1002 l2   
##  7 F         6 f      1006 p6   
##  8 G         7 &lt;NA&gt;     NA &lt;NA&gt; 
##  9 H         8 e      1005 o5   
## 10 I        NA c      1003 m3   
## 11 K        NA d      1004 n4   
## 12 J        NA g      1007 q7   
## 13 J        NA i      1009 s9   
## 14 I        NA j      1010 t10</code></pre>
<p>Estos 3 primeros métodos pueden resumirse en la siguiente imagen:</p>
<p><img src="img/04-tidyverse/left_right_full_join.png" width="700pt" style="display: block; margin: auto;" /></p>
<p>Adicionalmente, existen otras funciones que ayudan con gestionar las operaciones entre conjuntos de datos. Tal es el caso de la función <em>inner_join()</em>, la cuál no es otra cosa que el filtro de aquellos elementos que se tengan en común en ambas tablas y la combinación de un <em>join</em>. Internamente, la función primero filtra el ID de aquellos elementos que tienen presencia en ambas tablas y finalmente hace el cruce de los datos.</p>
<p><img src="img/04-tidyverse/inner_join.png" width="700pt" style="display: block; margin: auto;" /></p>
<div class="sourceCode" id="cb249"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb249-1"><a href="tidyverse.html#cb249-1" aria-hidden="true" tabindex="-1"></a><span class="fu">inner_join</span>(<span class="at">x =</span> conjuntoX, <span class="at">y =</span> conjuntoY, <span class="at">by =</span> <span class="st">&quot;Llave&quot;</span>)</span></code></pre></div>
<pre><code>## # A tibble: 4 × 5
##   Llave    C1 Ex1     Ex2 Ex3  
##   &lt;chr&gt; &lt;int&gt; &lt;chr&gt; &lt;int&gt; &lt;chr&gt;
## 1 C         3 h      1008 r8   
## 2 F         6 b      1002 l2   
## 3 F         6 f      1006 p6   
## 4 H         8 e      1005 o5</code></pre>
<p>Existen otras dos operaciones interesantes que agilizan la extracción de subconjuntos de tablas sin cruzar información. Se trata de las funciones <em>semi_join()</em> y <em>anti_join()</em>, las cuales funcionan de la siguiente manera:</p>
<p>La función <em>semi_join()</em> detecta y filtra los elementos del primer conjunto que se encuentran en un segundo conjunto, mientras que la función <em>anti_join()</em> es su complemento, pues regresa los elementos del primer conjunto que no se encuentran en el segundo. En ambos casos, la información contenida en el segundo conjunto no es trasmitida al resultado.</p>
<p><img src="img/04-tidyverse/semi_join.png" width="700pt" style="display: block; margin: auto;" /></p>
<p>A continuación se presenta un ejemplo:</p>
<div class="sourceCode" id="cb251"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb251-1"><a href="tidyverse.html#cb251-1" aria-hidden="true" tabindex="-1"></a><span class="fu">semi_join</span>(<span class="at">x =</span> conjuntoX, <span class="at">y =</span> conjuntoY, <span class="at">by =</span> <span class="st">&quot;Llave&quot;</span>)</span></code></pre></div>
<pre><code>## # A tibble: 3 × 2
##   Llave    C1
##   &lt;chr&gt; &lt;int&gt;
## 1 C         3
## 2 F         6
## 3 H         8</code></pre>
<p>Ahora revisemos el caso de la función <em>anti_join()</em></p>
<p><img src="img/04-tidyverse/anti_join.png" width="700pt" style="display: block; margin: auto;" /></p>
<div class="sourceCode" id="cb253"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb253-1"><a href="tidyverse.html#cb253-1" aria-hidden="true" tabindex="-1"></a><span class="fu">anti_join</span>(<span class="at">x =</span> conjuntoX, <span class="at">y =</span> conjuntoY, <span class="at">by =</span> <span class="st">&quot;Llave&quot;</span>)</span></code></pre></div>
<pre><code>## # A tibble: 5 × 2
##   Llave    C1
##   &lt;chr&gt; &lt;int&gt;
## 1 A         1
## 2 B         2
## 3 D         4
## 4 E         5
## 5 G         7</code></pre>
<div class="infobox important">
<p><strong>WARNING: llaves duplicadas</strong></p>
<p>La mayoría de los ejemplos anteriores suponen que las llaves son únicas en cada conjunto de datos, sin embargo, esto no es cierto en una gran cantidad de ocasiones. Existen dos casos importantes por analizar:</p>
<ul>
<li><p>Llaves duplicadas en 1 conjunto de datos</p></li>
<li><p>Llaves duplicadas en ambos conjuntos</p></li>
</ul>
</div>
<p>El caso más sencillo es cuando solo uno de los conjuntos contiene llaves duplicadas. En este caso se creará un renglón por cada duplicado.</p>
<p><img src="img/04-tidyverse/duplicado1.png" width="700pt" style="display: block; margin: auto;" /></p>
<p>En el segundo caso, por cada elemento duplicado en el primer conjunto habrá como resultado un elemento por cada duplicado en el segundo conjunto. A continuación se ejemplifica este escenario.</p>
<p><img src="img/04-tidyverse/duplicado2.png" width="700pt" style="display: block; margin: auto;" /></p>
</div>
</div>
<div id="orden-y-estructura" class="section level2 hasAnchor" number="3.3">
<h2><span class="header-section-number">3.3</span> Orden y estructura<a href="tidyverse.html#orden-y-estructura" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Un conjunto de datos puede ser representado de muchas maneras distintas y contener en todos los casos la misma información. Sin embargo, no todos los modos en que se presenta la información resulta óptimo para su procesamiento y análisis. Los conjuntos de datos ordenados serán más fáciles de trabajar y analizar.</p>
<p>Algunas de las características principales que presentan los conjuntos de datos ordenados son las siguientes:</p>
<ol style="list-style-type: decimal">
<li><p>Cada variable debe tener su propia columna.</p></li>
<li><p>Cada observación debe tener su propio renglón.</p></li>
<li><p>Cada valor debe tener su propia celda.</p></li>
</ol>
<p><img src="img/04-tidyverse/tidy-1.png" width="700pt" style="display: block; margin: auto;" /></p>
<p>La figura anterior muestra la estructura de orden que debe tener un conjunto de datos. A pesar de que pueda parecer intuitivo y sencillo, en la práctica es considerable el número de conjuntos de datos desordenados. La limpieza y ordenamiento debe ser trabajado de forma impecable a fin de que puedan realizarse buenas prácticas. El tiempo de limpieza y ordenamiento varía mucho dependiendo de la dimensión del conjunto de datos.</p>
<p>Algunos de los principales problemas que pueden tener los conjuntos de datos no ordenados son:</p>
<ul>
<li>Una variable puede estar dispersa en múltiples columnas</li>
<li>Una observación puede estar esparcida en múltiples renglones</li>
</ul>
<p>La paquetería <em>tidyr</em> cuenta con funciones para resolver dichos problemas. Entre las principales funciones que tiene la paquetería, se encuentran <em>pivot_longer()</em>, <em>pivot_wider()</em>, <em>separate()</em> y <em>unite()</em>, mismas que se analizarán a continuación.</p>
<div id="pivote-horizontal" class="section level3 hasAnchor" number="3.3.1">
<h3><span class="header-section-number">3.3.1</span> Pivote horizontal<a href="tidyverse.html#pivote-horizontal" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>La función <em>pivot_wider()</em> resulta muy útil a la hora de organizar los datos. Su función consiste en <strong>dispersar una variable clave en múltiples columnas</strong>.</p>
<p>Lo primero que se debe hacer para poder hacer uso de dicha función es instalar y cargar la librería.</p>
<p>El siguiente conjunto de datos contiene el número de localidades rurales y urbanas por municipio de la Ciudad de México. Como es posible observar, algunos municipios aparecen más de una vez en el marco de datos, esto se debe a que cada municipio puede tener ambos ámbitos, rural y urbano. Para hacer que el conjunto de datos sea ordenado, es necesario que cada observación aparezca una sola vez por renglón y cada una de las categorías (rural y urbano) de la variable “Ámbito” deberá ocupar el lugar de una columna.</p>
<p>El siguiente código muestra cómo convertir los datos no ordenados en un conjunto ordenado.</p>
<div class="sourceCode" id="cb255"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb255-1"><a href="tidyverse.html#cb255-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyr)</span>
<span id="cb255-2"><a href="tidyverse.html#cb255-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb255-3"><a href="tidyverse.html#cb255-3" aria-hidden="true" tabindex="-1"></a>Resumen <span class="ot">&lt;-</span> <span class="fu">readRDS</span>(<span class="st">&quot;data/loc_mun_cdmx.rds&quot;</span>)</span>
<span id="cb255-4"><a href="tidyverse.html#cb255-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb255-5"><a href="tidyverse.html#cb255-5" aria-hidden="true" tabindex="-1"></a>Resumen <span class="sc">%&gt;%</span> <span class="fu">pivot_wider</span>(</span>
<span id="cb255-6"><a href="tidyverse.html#cb255-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">names_from =</span> Ambito, </span>
<span id="cb255-7"><a href="tidyverse.html#cb255-7" aria-hidden="true" tabindex="-1"></a>  <span class="at">values_from =</span>  Total_localidades</span>
<span id="cb255-8"><a href="tidyverse.html#cb255-8" aria-hidden="true" tabindex="-1"></a>  )</span></code></pre></div>
<pre><code>## # A tibble: 16 × 3
##    NOM_MUN                Rural Urbano
##    &lt;chr&gt;                  &lt;int&gt;  &lt;int&gt;
##  1 Álvaro Obregón             3      1
##  2 La Magdalena Contreras     8      1
##  3 Cuajimalpa de Morelos     14      2
##  4 Tláhuac                   31      5
##  5 Xochimilco                78      1
##  6 Tlalpan                   95      4
##  7 Milpa Alta               187     10
##  8 Azcapotzalco              NA      1
##  9 Benito Juárez             NA      1
## 10 Coyoacán                  NA      1
## 11 Cuauhtémoc                NA      1
## 12 Gustavo A. Madero         NA      1
## 13 Iztacalco                 NA      1
## 14 Iztapalapa                NA      1
## 15 Miguel Hidalgo            NA      1
## 16 Venustiano Carranza       NA      1</code></pre>
<p>En la tabla actual existe ahora un y solo un registro por cada observación (nombre de municipio en este caso). El valor que le corresponde a cada una de las columnas creadas es la frecuencia absoluta de localidades que tienen la característica “Rural” y “Urbano” respectivamente.</p>
<p>Pero… ¿qué pasa cuando no existen todos los valores en ambas columnas? Si no se especifica la manera de llenar los datos faltantes, estos contendrán NAs. Siempre se puede elegir el caracter o número con el cual se imputan los datos faltantes.</p>
<div class="sourceCode" id="cb257"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb257-1"><a href="tidyverse.html#cb257-1" aria-hidden="true" tabindex="-1"></a>fish_encounters <span class="sc">%&gt;%</span></span>
<span id="cb257-2"><a href="tidyverse.html#cb257-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_wider</span>(<span class="at">names_from =</span> station, <span class="at">values_from =</span> seen)</span></code></pre></div>
<pre><code>## # A tibble: 19 × 12
##    fish  Release I80_1 Lisbon  Rstr Base_TD   BCE   BCW  BCE2  BCW2   MAE   MAW
##    &lt;fct&gt;   &lt;int&gt; &lt;int&gt;  &lt;int&gt; &lt;int&gt;   &lt;int&gt; &lt;int&gt; &lt;int&gt; &lt;int&gt; &lt;int&gt; &lt;int&gt; &lt;int&gt;
##  1 4842        1     1      1     1       1     1     1     1     1     1     1
##  2 4843        1     1      1     1       1     1     1     1     1     1     1
##  3 4844        1     1      1     1       1     1     1     1     1     1     1
##  4 4845        1     1      1     1       1    NA    NA    NA    NA    NA    NA
##  5 4847        1     1      1    NA      NA    NA    NA    NA    NA    NA    NA
##  6 4848        1     1      1     1      NA    NA    NA    NA    NA    NA    NA
##  7 4849        1     1     NA    NA      NA    NA    NA    NA    NA    NA    NA
##  8 4850        1     1     NA     1       1     1     1    NA    NA    NA    NA
##  9 4851        1     1     NA    NA      NA    NA    NA    NA    NA    NA    NA
## 10 4854        1     1     NA    NA      NA    NA    NA    NA    NA    NA    NA
## 11 4855        1     1      1     1       1    NA    NA    NA    NA    NA    NA
## 12 4857        1     1      1     1       1     1     1     1     1    NA    NA
## 13 4858        1     1      1     1       1     1     1     1     1     1     1
## 14 4859        1     1      1     1       1    NA    NA    NA    NA    NA    NA
## 15 4861        1     1      1     1       1     1     1     1     1     1     1
## 16 4862        1     1      1     1       1     1     1     1     1    NA    NA
## 17 4863        1     1     NA    NA      NA    NA    NA    NA    NA    NA    NA
## 18 4864        1     1     NA    NA      NA    NA    NA    NA    NA    NA    NA
## 19 4865        1     1      1    NA      NA    NA    NA    NA    NA    NA    NA</code></pre>
<div class="sourceCode" id="cb259"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb259-1"><a href="tidyverse.html#cb259-1" aria-hidden="true" tabindex="-1"></a>fish_encounters <span class="sc">%&gt;%</span></span>
<span id="cb259-2"><a href="tidyverse.html#cb259-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_wider</span>(<span class="at">names_from =</span> station, <span class="at">values_from =</span> seen, <span class="at">values_fill =</span> <span class="dv">0</span>)</span></code></pre></div>
<pre><code>## # A tibble: 19 × 12
##    fish  Release I80_1 Lisbon  Rstr Base_TD   BCE   BCW  BCE2  BCW2   MAE   MAW
##    &lt;fct&gt;   &lt;int&gt; &lt;int&gt;  &lt;int&gt; &lt;int&gt;   &lt;int&gt; &lt;int&gt; &lt;int&gt; &lt;int&gt; &lt;int&gt; &lt;int&gt; &lt;int&gt;
##  1 4842        1     1      1     1       1     1     1     1     1     1     1
##  2 4843        1     1      1     1       1     1     1     1     1     1     1
##  3 4844        1     1      1     1       1     1     1     1     1     1     1
##  4 4845        1     1      1     1       1     0     0     0     0     0     0
##  5 4847        1     1      1     0       0     0     0     0     0     0     0
##  6 4848        1     1      1     1       0     0     0     0     0     0     0
##  7 4849        1     1      0     0       0     0     0     0     0     0     0
##  8 4850        1     1      0     1       1     1     1     0     0     0     0
##  9 4851        1     1      0     0       0     0     0     0     0     0     0
## 10 4854        1     1      0     0       0     0     0     0     0     0     0
## 11 4855        1     1      1     1       1     0     0     0     0     0     0
## 12 4857        1     1      1     1       1     1     1     1     1     0     0
## 13 4858        1     1      1     1       1     1     1     1     1     1     1
## 14 4859        1     1      1     1       1     0     0     0     0     0     0
## 15 4861        1     1      1     1       1     1     1     1     1     1     1
## 16 4862        1     1      1     1       1     1     1     1     1     0     0
## 17 4863        1     1      0     0       0     0     0     0     0     0     0
## 18 4864        1     1      0     0       0     0     0     0     0     0     0
## 19 4865        1     1      1     0       0     0     0     0     0     0     0</code></pre>
<p>En caso de que existan múltiples columnas que se desean dispersar mediante el pivote de una columna con múltiples categorías, es posible especificar tal re estructuración a través del siguiente código.</p>
<div class="sourceCode" id="cb261"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb261-1"><a href="tidyverse.html#cb261-1" aria-hidden="true" tabindex="-1"></a>us_rent_income <span class="sc">%&gt;%</span> <span class="fu">arrange</span>(NAME)</span></code></pre></div>
<pre><code>## # A tibble: 104 × 5
##    GEOID NAME       variable estimate   moe
##    &lt;chr&gt; &lt;chr&gt;      &lt;chr&gt;       &lt;dbl&gt; &lt;dbl&gt;
##  1 01    Alabama    income      24476   136
##  2 01    Alabama    rent          747     3
##  3 02    Alaska     income      32940   508
##  4 02    Alaska     rent         1200    13
##  5 04    Arizona    income      27517   148
##  6 04    Arizona    rent          972     4
##  7 05    Arkansas   income      23789   165
##  8 05    Arkansas   rent          709     5
##  9 06    California income      29454   109
## 10 06    California rent         1358     3
## # … with 94 more rows</code></pre>
<div class="sourceCode" id="cb263"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb263-1"><a href="tidyverse.html#cb263-1" aria-hidden="true" tabindex="-1"></a>us_rent_income <span class="sc">%&gt;%</span></span>
<span id="cb263-2"><a href="tidyverse.html#cb263-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_wider</span>(<span class="at">names_from =</span> variable, <span class="at">values_from =</span> <span class="fu">c</span>(estimate, moe))</span></code></pre></div>
<pre><code>## # A tibble: 52 × 6
##    GEOID NAME                 estimate_income estimate_rent moe_income moe_rent
##    &lt;chr&gt; &lt;chr&gt;                          &lt;dbl&gt;         &lt;dbl&gt;      &lt;dbl&gt;    &lt;dbl&gt;
##  1 01    Alabama                        24476           747        136        3
##  2 02    Alaska                         32940          1200        508       13
##  3 04    Arizona                        27517           972        148        4
##  4 05    Arkansas                       23789           709        165        5
##  5 06    California                     29454          1358        109        3
##  6 08    Colorado                       32401          1125        109        5
##  7 09    Connecticut                    35326          1123        195        5
##  8 10    Delaware                       31560          1076        247       10
##  9 11    District of Columbia           43198          1424        681       17
## 10 12    Florida                        25952          1077         70        3
## # … with 42 more rows</code></pre>
<p>Adicionalmente, se puede especificar una función de agregación que operara antes de acomodar los datos en las respectivas columnas indicadas. Un ejemplo de funciones agregadas en la re estructuración de tabla se muestra a continuación, donde se muestra la media de los valores en las categorías <em>tension</em> y <em>breaks</em>.</p>
<div class="sourceCode" id="cb265"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb265-1"><a href="tidyverse.html#cb265-1" aria-hidden="true" tabindex="-1"></a>warpbreaks <span class="ot">&lt;-</span> warpbreaks[<span class="fu">c</span>(<span class="st">&quot;wool&quot;</span>, <span class="st">&quot;tension&quot;</span>, <span class="st">&quot;breaks&quot;</span>)] <span class="sc">%&gt;%</span> <span class="fu">as_tibble</span>()</span>
<span id="cb265-2"><a href="tidyverse.html#cb265-2" aria-hidden="true" tabindex="-1"></a>warpbreaks</span></code></pre></div>
<pre><code>## # A tibble: 54 × 3
##    wool  tension breaks
##    &lt;fct&gt; &lt;fct&gt;    &lt;dbl&gt;
##  1 A     L           26
##  2 A     L           30
##  3 A     L           54
##  4 A     L           25
##  5 A     L           70
##  6 A     L           52
##  7 A     L           51
##  8 A     L           26
##  9 A     L           67
## 10 A     M           18
## # … with 44 more rows</code></pre>
<div class="sourceCode" id="cb267"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb267-1"><a href="tidyverse.html#cb267-1" aria-hidden="true" tabindex="-1"></a>warpbreaks <span class="sc">%&gt;%</span></span>
<span id="cb267-2"><a href="tidyverse.html#cb267-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_wider</span>(</span>
<span id="cb267-3"><a href="tidyverse.html#cb267-3" aria-hidden="true" tabindex="-1"></a>    <span class="at">names_from =</span> wool,</span>
<span id="cb267-4"><a href="tidyverse.html#cb267-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">values_from =</span> breaks,</span>
<span id="cb267-5"><a href="tidyverse.html#cb267-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">values_fn =</span> mean</span>
<span id="cb267-6"><a href="tidyverse.html#cb267-6" aria-hidden="true" tabindex="-1"></a>  )</span></code></pre></div>
<pre><code>## # A tibble: 3 × 3
##   tension     A     B
##   &lt;fct&gt;   &lt;dbl&gt; &lt;dbl&gt;
## 1 L        44.6  28.2
## 2 M        24    28.8
## 3 H        24.6  18.8</code></pre>
</div>
<div id="pivote-vertical" class="section level3 hasAnchor" number="3.3.2">
<h3><span class="header-section-number">3.3.2</span> Pivote vertical<a href="tidyverse.html#pivote-vertical" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p><em>pivot_longer()</em> es podría ser la función inversa de la anterior, se necesita comúnmente para ordenar los conjuntos de datos capturados en crudo, ya que a menudo no son capturados acorde a las mejores estructuras para facilitar el análisis.</p>
<p>El conjunto de datos <em>relig_income</em> almacena recuentos basados en una encuesta que (entre otras cosas) preguntó a las personas sobre su religión e ingresos anuales:</p>
<div class="sourceCode" id="cb269"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb269-1"><a href="tidyverse.html#cb269-1" aria-hidden="true" tabindex="-1"></a>relig_income</span></code></pre></div>
<pre><code>## # A tibble: 18 × 11
##    religion      `&lt;$10k` $10-2…¹ $20-3…² $30-4…³ $40-5…⁴ $50-7…⁵ $75-1…⁶ $100-…⁷
##    &lt;chr&gt;           &lt;dbl&gt;   &lt;dbl&gt;   &lt;dbl&gt;   &lt;dbl&gt;   &lt;dbl&gt;   &lt;dbl&gt;   &lt;dbl&gt;   &lt;dbl&gt;
##  1 Agnostic           27      34      60      81      76     137     122     109
##  2 Atheist            12      27      37      52      35      70      73      59
##  3 Buddhist           27      21      30      34      33      58      62      39
##  4 Catholic          418     617     732     670     638    1116     949     792
##  5 Don’t know/r…      15      14      15      11      10      35      21      17
##  6 Evangelical …     575     869    1064     982     881    1486     949     723
##  7 Hindu               1       9       7       9      11      34      47      48
##  8 Historically…     228     244     236     238     197     223     131      81
##  9 Jehovah&#39;s Wi…      20      27      24      24      21      30      15      11
## 10 Jewish             19      19      25      25      30      95      69      87
## 11 Mainline Prot     289     495     619     655     651    1107     939     753
## 12 Mormon             29      40      48      51      56     112      85      49
## 13 Muslim              6       7       9      10       9      23      16       8
## 14 Orthodox           13      17      23      32      32      47      38      42
## 15 Other Christ…       9       7      11      13      13      14      18      14
## 16 Other Faiths       20      33      40      46      49      63      46      40
## 17 Other World …       5       2       3       4       2       7       3       4
## 18 Unaffiliated      217     299     374     365     341     528     407     321
## # … with 2 more variables: `&gt;150k` &lt;dbl&gt;, `Don&#39;t know/refused` &lt;dbl&gt;, and
## #   abbreviated variable names ¹​`$10-20k`, ²​`$20-30k`, ³​`$30-40k`, ⁴​`$40-50k`,
## #   ⁵​`$50-75k`, ⁶​`$75-100k`, ⁷​`$100-150k`</code></pre>
<p>¿Crees que ésta es la mejor estructura para la tabla? ¿Cómo imaginas que podría modificarse?</p>
<p>Este conjunto de datos contiene tres variables:</p>
<ol style="list-style-type: decimal">
<li><p>religión, almacenada en las filas</p></li>
<li><p>income repartidos entre los nombres de columna</p></li>
<li><p>count almacenado en los valores de las celdas.</p></li>
</ol>
<p>Para ordenarlo usamos <em>pivot_longer()</em>:</p>
<div class="sourceCode" id="cb271"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb271-1"><a href="tidyverse.html#cb271-1" aria-hidden="true" tabindex="-1"></a>relig_income <span class="sc">%&gt;%</span> </span>
<span id="cb271-2"><a href="tidyverse.html#cb271-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="at">cols =</span> <span class="sc">-</span>religion, <span class="at">names_to =</span> <span class="st">&quot;income&quot;</span>, <span class="at">values_to =</span> <span class="st">&quot;count&quot;</span>)</span></code></pre></div>
<pre><code>## # A tibble: 180 × 3
##    religion income             count
##    &lt;chr&gt;    &lt;chr&gt;              &lt;dbl&gt;
##  1 Agnostic &lt;$10k                 27
##  2 Agnostic $10-20k               34
##  3 Agnostic $20-30k               60
##  4 Agnostic $30-40k               81
##  5 Agnostic $40-50k               76
##  6 Agnostic $50-75k              137
##  7 Agnostic $75-100k             122
##  8 Agnostic $100-150k            109
##  9 Agnostic &gt;150k                 84
## 10 Agnostic Don&#39;t know/refused    96
## # … with 170 more rows</code></pre>
<ul>
<li><p>El primer argumento es el conjunto de datos para remodelar, relig_income.</p></li>
<li><p>El segundo argumento describe qué columnas necesitan ser reformadas. En este caso, es cada columna aparte de religion.</p></li>
<li><p>El <strong>names_to</strong> da el nombre de la variable que se creará a partir de los datos almacenados en los nombres de columna, es decir, ingresos.</p></li>
<li><p>Los <strong>values_to</strong> dan el nombre de la variable que se creará a partir de los datos almacenados en el valor de la celda, es decir, count. Ni la columna names_to ni la values_to existen en relig_income, por lo que las proporcionamos como cadenas de caracteres entre comillas.</p></li>
</ul>
</div>
<div id="unión-de-columnas" class="section level3 hasAnchor" number="3.3.3">
<h3><span class="header-section-number">3.3.3</span> Unión de columnas<a href="tidyverse.html#unión-de-columnas" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Es común que en los conjuntos de datos exista información esparcida en distintas columnas que sería deseable <strong>(en muy pocas ocasiones)</strong> tenerlas en una sola columna. Algunos ejemplos de esta situación deseable son las fechas y claves geoestadísticas. La función <em>unite()</em> sirve para <strong>concatenar el contenido de columnas</strong> mediante un separador elegible.</p>
<p>Se usará la variable de la clave geoestadística de localidades del país como ejemplo.</p>
<p>El formato para las claves geoestadísticas para estado, municipio y localidad son claves alfanuméricas que contienen 2, 3 y 4 caracteres respectivamente. Es indispensable que al trabajar con claves geoestadísticas, las claves estén en su formato original. A continuación se hará la homologación de las claves para usar la función <em>unite()</em>.</p>
<div class="sourceCode" id="cb273"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb273-1"><a href="tidyverse.html#cb273-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(magrittr)</span>
<span id="cb273-2"><a href="tidyverse.html#cb273-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(readxl)</span>
<span id="cb273-3"><a href="tidyverse.html#cb273-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(stringr)</span>
<span id="cb273-4"><a href="tidyverse.html#cb273-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb273-5"><a href="tidyverse.html#cb273-5" aria-hidden="true" tabindex="-1"></a>Datos <span class="ot">&lt;-</span> <span class="fu">read_excel</span>(<span class="st">&quot;data/Margin CONAPO.xlsx&quot;</span>, <span class="at">sheet =</span> <span class="st">&quot;Margin CONAPO&quot;</span>)</span>
<span id="cb273-6"><a href="tidyverse.html#cb273-6" aria-hidden="true" tabindex="-1"></a>Datos</span></code></pre></div>
<pre><code>## # A tibble: 107,458 × 21
##      ENT NOM_ENT         MUN NOM_MUN   LOC NOM_LOC POB_TOT    VPH ANAL10 SPRIM10
##    &lt;dbl&gt; &lt;chr&gt;         &lt;dbl&gt; &lt;chr&gt;   &lt;dbl&gt; &lt;chr&gt;     &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt;   &lt;dbl&gt;
##  1     1 Aguascalient…     1 Aguasc…     1 Aguasc…  722250 184123   2.26   10.9 
##  2     1 Aguascalient…     1 Aguasc…    96 Agua A…      37     11  17.9    48.1 
##  3     1 Aguascalient…     1 Aguasc…   104 Ardill…      14      3   0      20   
##  4     1 Aguascalient…     1 Aguasc…   106 Arella…    1382    255   5.60   24.7 
##  5     1 Aguascalient…     1 Aguasc…   112 Bajío …      55     11  14.3    38.1 
##  6     1 Aguascalient…     1 Aguasc…   114 Reside…     757    202   0       1.63
##  7     1 Aguascalient…     1 Aguasc…   120 Buenav…     935    217  10.7    29.5 
##  8     1 Aguascalient…     1 Aguasc…   121 Cabeci…     184     44   4.55   32.6 
##  9     1 Aguascalient…     1 Aguasc…   125 Cañada…     395     82   8.86   23.9 
## 10     1 Aguascalient…     1 Aguasc…   126 Cañada…     509    123   4.75   19.6 
## # … with 107,448 more rows, and 11 more variables: SEXC10 &lt;dbl&gt;, SEE10 &lt;dbl&gt;,
## #   SAGUAE10 &lt;dbl&gt;, PROM_OCC10 &lt;dbl&gt;, PISOTIE10 &lt;dbl&gt;, SREFRI10 &lt;dbl&gt;,
## #   IM_2010 &lt;dbl&gt;, GM_2010 &lt;chr&gt;, IMC0A100 &lt;dbl&gt;, LUG_NAL &lt;dbl&gt;, LUG_EDO &lt;dbl&gt;</code></pre>
<p>Como puede apreciarse en la tabla anterior, las claves de los campos <em>Ent</em>, <em>Mun</em> y <em>Loc</em> aparecen como numéricos. La estructura deseada para estos campos es de tipo alfanumérico y de longitud 2, 3 y 4 respectivamente. Para lograr esta estructura de datos, es necesario concatenar tantos ceros como sean necesarios antes del valor actual hasta lograr la longitud deseada.</p>
<div class="sourceCode" id="cb275"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb275-1"><a href="tidyverse.html#cb275-1" aria-hidden="true" tabindex="-1"></a>Datos2 <span class="ot">&lt;-</span> Datos <span class="sc">%&gt;%</span> <span class="fu">select</span>(ENT, MUN, LOC)</span>
<span id="cb275-2"><a href="tidyverse.html#cb275-2" aria-hidden="true" tabindex="-1"></a>Datos2<span class="sc">$</span>ENT <span class="sc">%&lt;&gt;%</span> <span class="fu">str_pad</span>(<span class="at">width =</span> <span class="dv">2</span>, <span class="at">side =</span> <span class="st">&quot;left&quot;</span>, <span class="at">pad =</span> <span class="st">&quot;0&quot;</span>)</span>
<span id="cb275-3"><a href="tidyverse.html#cb275-3" aria-hidden="true" tabindex="-1"></a>Datos2<span class="sc">$</span>MUN <span class="sc">%&lt;&gt;%</span> <span class="fu">str_pad</span>(<span class="at">width =</span> <span class="dv">3</span>, <span class="at">side =</span> <span class="st">&quot;left&quot;</span>, <span class="at">pad =</span> <span class="st">&quot;0&quot;</span>)</span>
<span id="cb275-4"><a href="tidyverse.html#cb275-4" aria-hidden="true" tabindex="-1"></a>Datos2<span class="sc">$</span>LOC <span class="sc">%&lt;&gt;%</span> <span class="fu">str_pad</span>(<span class="at">width =</span> <span class="dv">4</span>, <span class="at">side =</span> <span class="st">&quot;left&quot;</span>, <span class="at">pad =</span> <span class="st">&quot;0&quot;</span>)</span>
<span id="cb275-5"><a href="tidyverse.html#cb275-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb275-6"><a href="tidyverse.html#cb275-6" aria-hidden="true" tabindex="-1"></a>Datos2 <span class="sc">%&gt;%</span> <span class="fu">head</span>(<span class="dv">5</span>)</span></code></pre></div>
<pre><code>## # A tibble: 5 × 3
##   ENT   MUN   LOC  
##   &lt;chr&gt; &lt;chr&gt; &lt;chr&gt;
## 1 01    001   0001 
## 2 01    001   0096 
## 3 01    001   0104 
## 4 01    001   0106 
## 5 01    001   0112</code></pre>
<div class="sourceCode" id="cb277"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb277-1"><a href="tidyverse.html#cb277-1" aria-hidden="true" tabindex="-1"></a>Datos2 <span class="sc">%&gt;%</span> </span>
<span id="cb277-2"><a href="tidyverse.html#cb277-2" aria-hidden="true" tabindex="-1"></a> <span class="fu">unite</span>(<span class="st">&quot;CVE_GEO&quot;</span>, <span class="fu">c</span>(<span class="st">&quot;ENT&quot;</span>,<span class="st">&quot;MUN&quot;</span>,<span class="st">&quot;LOC&quot;</span>), <span class="at">sep=</span><span class="st">&quot;&quot;</span>, <span class="at">remove =</span> F) <span class="sc">%&gt;%</span> </span>
<span id="cb277-3"><a href="tidyverse.html#cb277-3" aria-hidden="true" tabindex="-1"></a> <span class="fu">head</span>(<span class="dv">5</span>)</span></code></pre></div>
<pre><code>## # A tibble: 5 × 4
##   CVE_GEO   ENT   MUN   LOC  
##   &lt;chr&gt;     &lt;chr&gt; &lt;chr&gt; &lt;chr&gt;
## 1 010010001 01    001   0001 
## 2 010010096 01    001   0096 
## 3 010010104 01    001   0104 
## 4 010010106 01    001   0106 
## 5 010010112 01    001   0112</code></pre>
<div class="sourceCode" id="cb279"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb279-1"><a href="tidyverse.html#cb279-1" aria-hidden="true" tabindex="-1"></a>Datos2 <span class="sc">%&gt;%</span> </span>
<span id="cb279-2"><a href="tidyverse.html#cb279-2" aria-hidden="true" tabindex="-1"></a> <span class="fu">unite</span>(<span class="st">&quot;CVE_GEO&quot;</span>, <span class="fu">c</span>(<span class="st">&quot;ENT&quot;</span>,<span class="st">&quot;MUN&quot;</span>,<span class="st">&quot;LOC&quot;</span>), <span class="at">sep=</span><span class="st">&quot;/&quot;</span>,<span class="at">remove =</span> T) <span class="sc">%&gt;%</span> </span>
<span id="cb279-3"><a href="tidyverse.html#cb279-3" aria-hidden="true" tabindex="-1"></a> <span class="fu">head</span>(<span class="dv">5</span>)</span></code></pre></div>
<pre><code>## # A tibble: 5 × 1
##   CVE_GEO    
##   &lt;chr&gt;      
## 1 01/001/0001
## 2 01/001/0096
## 3 01/001/0104
## 4 01/001/0106
## 5 01/001/0112</code></pre>
<p>En el código anterior se carga la librería <em>magrittr</em> para poder hacer uso del operador pipe doble “%&lt;&gt;%”, que permite al igual que el operador pipe simple “%&gt;%”, usar como argumento al primer elemento y mandarlo hacia la función definida, además de guardar el resultado final de la cadena de pipes en el argumento original que fue usado como insumo para la función. Es importante tener en cuenta que el dato será reescrito y no se podrá tener acceso a su información almacenada antes de ser usado el operador.</p>
<p>Es opción del programador poder eliminar las variables originales que crearon la nueva variable o mantenerlas en el conjunto de datos. Esta opción está disponible en el parámetro <em>remove</em> de la función <em>unite()</em>.</p>
</div>
<div id="separador-de-columnas" class="section level3 hasAnchor" number="3.3.4">
<h3><span class="header-section-number">3.3.4</span> Separador de columnas<a href="tidyverse.html#separador-de-columnas" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Los procesos que se han visto hasta ahora han tenido cada uno una función inversa, este es también el caso de la función <em>unite</em> que tiene por objetivo unir dos o más columnas en una. La función <em>separate()</em> separará una columna en dos o más dependiendo de la longitud que tenga y de las especificaciones de separación.</p>
<div class="sourceCode" id="cb281"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb281-1"><a href="tidyverse.html#cb281-1" aria-hidden="true" tabindex="-1"></a>Datos_unite1 <span class="ot">&lt;-</span> Datos2 <span class="sc">%&gt;%</span> <span class="fu">unite</span>(<span class="st">&quot;CVE_GEO&quot;</span>, <span class="fu">c</span>(<span class="st">&quot;ENT&quot;</span>,<span class="st">&quot;MUN&quot;</span>,<span class="st">&quot;LOC&quot;</span>), <span class="at">sep =</span> <span class="st">&quot;&quot;</span>, <span class="at">remove =</span> T) </span>
<span id="cb281-2"><a href="tidyverse.html#cb281-2" aria-hidden="true" tabindex="-1"></a>Datos_unite1 <span class="sc">%&gt;%</span> <span class="fu">head</span>(<span class="dv">5</span>) </span></code></pre></div>
<pre><code>## # A tibble: 5 × 1
##   CVE_GEO  
##   &lt;chr&gt;    
## 1 010010001
## 2 010010096
## 3 010010104
## 4 010010106
## 5 010010112</code></pre>
<div class="sourceCode" id="cb283"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb283-1"><a href="tidyverse.html#cb283-1" aria-hidden="true" tabindex="-1"></a>Datos_unite1 <span class="sc">%&gt;%</span> </span>
<span id="cb283-2"><a href="tidyverse.html#cb283-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">separate</span>(<span class="st">&quot;CVE_GEO&quot;</span>, <span class="fu">c</span>(<span class="st">&quot;EDO&quot;</span>,<span class="st">&quot;MUNI&quot;</span>,<span class="st">&quot;LOC&quot;</span>), <span class="at">sep =</span> <span class="fu">c</span>(<span class="dv">2</span>, <span class="dv">5</span>), <span class="at">remove=</span>F) <span class="sc">%&gt;%</span> </span>
<span id="cb283-3"><a href="tidyverse.html#cb283-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">head</span>(<span class="dv">5</span>)</span></code></pre></div>
<pre><code>## # A tibble: 5 × 4
##   CVE_GEO   EDO   MUNI  LOC  
##   &lt;chr&gt;     &lt;chr&gt; &lt;chr&gt; &lt;chr&gt;
## 1 010010001 01    001   0001 
## 2 010010096 01    001   0096 
## 3 010010104 01    001   0104 
## 4 010010106 01    001   0106 
## 5 010010112 01    001   0112</code></pre>
<p>Ya sea que se le especifique el número de caracteres que debe de contar para hacer un corte o que se le indique qué caracter debe identificar para hacer la separación, la función <em>separate()</em> puede dividir la columna indicada y crear nuevas a partir de la original.</p>
</div>
</div>
<div id="manipulación-de-texto" class="section level2 hasAnchor" number="3.4">
<h2><span class="header-section-number">3.4</span> Manipulación de texto<a href="tidyverse.html#manipulación-de-texto" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Anteriormente se mencionaron algunas paqueterías que están incluidas dentro del conjunto Tidyverse. La paquetería stringr no forma parte del núcleo de Tidyverse, no obstante, sí pertenece a dicho conjunto y es ampliamente usada junto a las paqueterías nucleares debido a la facilidad que tiene para trabajar con cadenas, textos y expresiones regulares en general.</p>
<p><img src="img/04-tidyverse/clean_text.png" width="700pt" style="display: block; margin: auto;" /></p>
<p>Las expresiones regulares, también conocidas como <em>regex</em> o <em>regexp</em>, <strong>son patrones de texto repetidos en los datos y que son usados para operar con otras cadenas de texto</strong>. El resultado de dichas operaciones es obtener o resumir información, además de manipular y ordenar los conjuntos de datos. Entre las principales operaciones se encuentran los conteos, concatenaciones, separaciones, búsquedas, extracciones, imputaciones y sustituciones.</p>
<div id="caracteres-especiales" class="section level3 hasAnchor" number="3.4.1">
<h3><span class="header-section-number">3.4.1</span> Caracteres especiales<a href="tidyverse.html#caracteres-especiales" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Debido a que la paquetería <em>stringr</em> trabaja principalmente con cadenas de texto, es importante tener en cuenta que <strong>los objetos de caracteres se definen a través de comillas</strong>, ya sea simples o dobles. La única diferencia está en el caso en que se pretendan usar comillas como parte del texto. En estos casos, la comilla simple es preferible para ser la que defina el texto.</p>
<div class="sourceCode" id="cb285"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb285-1"><a href="tidyverse.html#cb285-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(stringr)</span>
<span id="cb285-2"><a href="tidyverse.html#cb285-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb285-3"><a href="tidyverse.html#cb285-3" aria-hidden="true" tabindex="-1"></a>Cadena1 <span class="ot">&lt;-</span> <span class="st">&quot;Se definen cadenas a través de comillas dobles&quot;</span></span>
<span id="cb285-4"><a href="tidyverse.html#cb285-4" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(Cadena1)</span></code></pre></div>
<pre><code>## [1] &quot;Se definen cadenas a través de comillas dobles&quot;</code></pre>
<div class="sourceCode" id="cb287"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb287-1"><a href="tidyverse.html#cb287-1" aria-hidden="true" tabindex="-1"></a>Cadena2 <span class="ot">&lt;-</span> <span class="st">&#39;También es posible con comillas simples y el resultado es el mismo&#39;</span></span>
<span id="cb287-2"><a href="tidyverse.html#cb287-2" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(Cadena2)</span></code></pre></div>
<pre><code>## [1] &quot;También es posible con comillas simples y el resultado es el mismo&quot;</code></pre>
<div class="sourceCode" id="cb289"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb289-1"><a href="tidyverse.html#cb289-1" aria-hidden="true" tabindex="-1"></a>Cadena3 <span class="ot">&lt;-</span> <span class="st">&#39;Se pueden implementar &quot;comillas&quot; dentro de la cadena&#39;</span></span>
<span id="cb289-2"><a href="tidyverse.html#cb289-2" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(Cadena3)</span></code></pre></div>
<pre><code>## [1] &quot;Se pueden implementar \&quot;comillas\&quot; dentro de la cadena&quot;</code></pre>
<div class="sourceCode" id="cb291"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb291-1"><a href="tidyverse.html#cb291-1" aria-hidden="true" tabindex="-1"></a>Cadena4 <span class="ot">&lt;-</span> <span class="st">&#39;Esta es otra forma de incluir </span><span class="sc">\&quot;</span><span class="st">comillas</span><span class="sc">\&quot;</span><span class="st"> dentro de un texto&#39;</span></span>
<span id="cb291-2"><a href="tidyverse.html#cb291-2" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(Cadena4)</span></code></pre></div>
<pre><code>## [1] &quot;Esta es otra forma de incluir \&quot;comillas\&quot; dentro de un texto&quot;</code></pre>
<p>Como es posible apreciar en los ejemplos anteriores, la cadena 3 y 4 no se imprimen exactamente como se definieron. Podría parecer que existe un error, ya que aparecen diagonales antes de los caracteres deseados. Para resolver este problema, únicamente es necesario mandar llamar a la función <em>cat()</em> . Esta función sirve como intérprete de los caracteres que se definen en una cadena.</p>
<p>La función <em>cat()</em> <strong>sirve como sustituto</strong> de la función <em>print()</em> (cuya función es imprimir de forma literal lo que existe dentro de las comillas), con la diferencia de que <em>cat()</em> <strong>interpreta las salidas</strong> de caracteres especiales en el texto y concatena las salidas finales con el separador específico que se indique. Por default, el separador es un espacio vacío, sin embargo, es posible modificarlo. A continuación se ejemplifica su uso.</p>
<div class="sourceCode" id="cb293"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb293-1"><a href="tidyverse.html#cb293-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(Cadena3)</span></code></pre></div>
<pre><code>## Se pueden implementar &quot;comillas&quot; dentro de la cadena</code></pre>
<div class="sourceCode" id="cb295"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb295-1"><a href="tidyverse.html#cb295-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(Cadena4)</span></code></pre></div>
<pre><code>## Esta es otra forma de incluir &quot;comillas&quot; dentro de un texto</code></pre>
<p>A través del operador diagonal invertida “\” también es posible definir comillas de manera literal. En caso de querer escribir textualmente una diagonal invertida, se necesitará escribir entre comillas dos diagonales invertidas “\\”. Existen otros caracteres espaciales que ayudan a mejorar el formato de las cadenas. Algunos de los caracteres más comunes son “\n” (nueva línea) y “\t” (tabulador).</p>
<p>Todas las funciones que se presentarán a continuación, son posibles encontrarlas con otro nombre dentro de la paquetería básica. La ventaja que tienen las funciones de la paquetería <em>stringr</em> es que, los nombres son más intuitivos y comienzan con el mismo prefijo “str_”, haciendo que al escribir las primeras tres letras, la función de autocompletar de RStudio muestre una lista con sugerencias de los nombres de las posibles funciones a usarse.</p>
</div>
<div id="tamaño-de-cadena" class="section level3 hasAnchor" number="3.4.2">
<h3><span class="header-section-number">3.4.2</span> Tamaño de cadena<a href="tidyverse.html#tamaño-de-cadena" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Es común que al procesar los conjuntos de datos, se requiera contar el número de caracteres que tiene una cadena. La paquetería básica cuenta con la función <em>nchar()</em> para realizar esta tarea. Con la ayuda de la paquetería <em>stringr</em>, es posible realizar esta misma tarea a través de la función <em>str_length()</em></p>
<div class="sourceCode" id="cb297"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb297-1"><a href="tidyverse.html#cb297-1" aria-hidden="true" tabindex="-1"></a><span class="fu">str_length</span>(<span class="st">&quot;Esta es una cadena de 35 caracteres&quot;</span>)</span></code></pre></div>
<pre><code>## [1] 35</code></pre>
<div class="sourceCode" id="cb299"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb299-1"><a href="tidyverse.html#cb299-1" aria-hidden="true" tabindex="-1"></a><span class="fu">str_length</span>(<span class="fu">c</span>(<span class="st">&quot;Un&quot;</span>,<span class="st">&quot;vector&quot;</span>,<span class="st">&quot;con&quot;</span>,<span class="st">&quot;diferente&quot;</span>,<span class="st">&quot;cantidad&quot;</span>,<span class="st">&quot;de&quot;</span>,<span class="st">&quot;carecteres&quot;</span>,<span class="st">&quot;por&quot;</span>,<span class="st">&quot;cadena&quot;</span>))</span></code></pre></div>
<pre><code>## [1]  2  6  3  9  8  2 10  3  6</code></pre>
<p>Puede usarse la función tanto para objetos de cadenas individuales como para vectores.</p>
<p>Existen muchos conjuntos de datos que durante su manipulación podemos encontrar claves alfanuméricas, que pueden ser necesarias <strong>unir información</strong> relevante o para crear claves de identificación única, por ejemplo poder unir el nombre completo de las personas dentro de una base de datos. Uniendo Nombre + Segundo Nombre + Primer Apellido + Segundo Apellido.</p>
<p>Por otro lado de esto puede extraerse información sobre la CURP o en algunos otros ejemplos la unión de un ID + una matricula de carrera + el año pueden ser el registro para un estudiante o podrías querer replicar mensajes para alertas que dependan de una variable.</p>
</div>
<div id="concatenar" class="section level3 hasAnchor" number="3.4.3">
<h3><span class="header-section-number">3.4.3</span> Concatenar<a href="tidyverse.html#concatenar" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Concatenar cadenas es una de las prácticas constantes en el manejo de conjuntos de datos. La función de la paquetería básica que se encarga de dicha tarea es la función <em>paste()</em>. A través de la paquetería <em>stringr</em> se logrará el <strong>concatenado</strong> mediante la función <em>str_c()</em>. Existe la opción de definir el caracter que hará la combinación de las cadenas mediante el argumento “sep”, que por default no deja ni un espacio entre las cadenas a combinar. Varios ejemplos se mostrarán a continuación.</p>
<p><img src="img/04-tidyverse/concatenate.png" width="700pt" style="display: block; margin: auto;" /></p>
<div class="sourceCode" id="cb301"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb301-1"><a href="tidyverse.html#cb301-1" aria-hidden="true" tabindex="-1"></a><span class="fu">str_c</span>(<span class="st">&quot;Concatenado&quot;</span>, <span class="st">&quot;de&quot;</span>,<span class="st">&quot;varias&quot;</span>, <span class="st">&quot;cadenas&quot;</span>, <span class="st">&quot;sin&quot;</span>,<span class="st">&quot;espacios&quot;</span>)</span></code></pre></div>
<pre><code>## [1] &quot;Concatenadodevariascadenassinespacios&quot;</code></pre>
<div class="sourceCode" id="cb303"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb303-1"><a href="tidyverse.html#cb303-1" aria-hidden="true" tabindex="-1"></a><span class="fu">str_c</span>(<span class="st">&quot;Concatenado&quot;</span>,<span class="st">&quot;con&quot;</span>,<span class="st">&quot;espacios&quot;</span>, <span class="at">sep=</span><span class="st">&quot; &quot;</span>)</span></code></pre></div>
<pre><code>## [1] &quot;Concatenado con espacios&quot;</code></pre>
<div class="sourceCode" id="cb305"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb305-1"><a href="tidyverse.html#cb305-1" aria-hidden="true" tabindex="-1"></a><span class="fu">str_c</span>(<span class="st">&quot;separando&quot;</span>,<span class="st">&quot;mediante&quot;</span>,<span class="st">&quot;otro&quot;</span>,<span class="st">&quot;caracter&quot;</span>,<span class="st">&quot;definido&quot;</span>, <span class="at">sep=</span><span class="st">&quot;-&quot;</span>)</span></code></pre></div>
<pre><code>## [1] &quot;separando-mediante-otro-caracter-definido&quot;</code></pre>
<div class="sourceCode" id="cb307"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb307-1"><a href="tidyverse.html#cb307-1" aria-hidden="true" tabindex="-1"></a><span class="fu">str_c</span>(<span class="st">&quot;Valores&quot;</span>,<span class="fu">str_c</span>(<span class="st">&quot;09&quot;</span>,<span class="st">&quot;006&quot;</span>),<span class="st">&quot;anidados también se pueden concatenar&quot;</span>,<span class="at">sep=</span><span class="st">&quot; &quot;</span>)</span></code></pre></div>
<pre><code>## [1] &quot;Valores 09006 anidados también se pueden concatenar&quot;</code></pre>
<p>Es posible, al igual que con la función <em>paste()</em>, colapsar todas las cadenas de un vector en una sola cadena mediante el mismo parámetro: “collapse”. El caracter que divide a los elementos del vector debe ser especificado entre comillas, de lo contrario el valor por default será ” “.</p>
<div class="sourceCode" id="cb309"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb309-1"><a href="tidyverse.html#cb309-1" aria-hidden="true" tabindex="-1"></a><span class="fu">str_c</span>(<span class="fu">c</span>(<span class="st">&quot;Colapsamiento&quot;</span>, <span class="st">&quot;de&quot;</span>,<span class="st">&quot;un&quot;</span>,<span class="st">&quot;vector&quot;</span>,<span class="st">&quot;de&quot;</span>, <span class="st">&quot;cadenas&quot;</span>, <span class="st">&quot;en&quot;</span>,<span class="st">&quot;una&quot;</span>,</span>
<span id="cb309-2"><a href="tidyverse.html#cb309-2" aria-hidden="true" tabindex="-1"></a>        <span class="st">&quot;sola&quot;</span>,<span class="st">&quot;cadena&quot;</span>), <span class="at">collapse =</span> <span class="st">&quot; &quot;</span>)</span></code></pre></div>
<pre><code>## [1] &quot;Colapsamiento de un vector de cadenas en una sola cadena&quot;</code></pre>
<div class="sourceCode" id="cb311"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb311-1"><a href="tidyverse.html#cb311-1" aria-hidden="true" tabindex="-1"></a><span class="fu">str_c</span>(<span class="fu">c</span>(<span class="st">&quot;Colapsamiento&quot;</span>, <span class="st">&quot;de&quot;</span>,<span class="st">&quot;un&quot;</span>,<span class="st">&quot;vector&quot;</span>,<span class="st">&quot;de&quot;</span>, <span class="st">&quot;cadenas&quot;</span>,</span>
<span id="cb311-2"><a href="tidyverse.html#cb311-2" aria-hidden="true" tabindex="-1"></a>        <span class="st">&quot;separado&quot;</span>,<span class="st">&quot;por&quot;</span>,<span class="st">&quot;signos&quot;</span>), <span class="at">collapse =</span> <span class="st">&quot;+&quot;</span>)</span></code></pre></div>
<pre><code>## [1] &quot;Colapsamiento+de+un+vector+de+cadenas+separado+por+signos&quot;</code></pre>
</div>
<div id="extraer-y-reemplazar" class="section level3 hasAnchor" number="3.4.4">
<h3><span class="header-section-number">3.4.4</span> Extraer y reemplazar<a href="tidyverse.html#extraer-y-reemplazar" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Cuando únicamente interesa un <strong>subconjunto de alguna cadena</strong> para continuar con el manejo de la información, suele recurrirse a la expresión regular <em>substr()</em> de la paquetería básica para extraer este subconjunto de interés. Con <em>stringr</em>, la función para usar esta expresión regular es <em>str_sub()</em>. Esta función recibe como parámetros el texto desde el cuál se desea extraer el subconjunto, el índice que marque el inicio de la subcadena y el índice del final de la subcadena.</p>
<div class="sourceCode" id="cb313"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb313-1"><a href="tidyverse.html#cb313-1" aria-hidden="true" tabindex="-1"></a><span class="fu">str_sub</span>(<span class="st">&quot;subcadenas&quot;</span>, <span class="at">start =</span> <span class="dv">4</span>, <span class="at">end =</span> <span class="dv">9</span>)</span></code></pre></div>
<pre><code>## [1] &quot;cadena&quot;</code></pre>
<div class="sourceCode" id="cb315"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb315-1"><a href="tidyverse.html#cb315-1" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="st">&quot;00000090060002&quot;</span></span>
<span id="cb315-2"><a href="tidyverse.html#cb315-2" aria-hidden="true" tabindex="-1"></a><span class="fu">str_sub</span>(x, <span class="at">start =</span> <span class="fu">str_length</span>(x) <span class="sc">-</span> <span class="dv">8</span>, <span class="fu">str_length</span>(x))</span></code></pre></div>
<pre><code>## [1] &quot;090060002&quot;</code></pre>
<div class="sourceCode" id="cb317"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb317-1"><a href="tidyverse.html#cb317-1" aria-hidden="true" tabindex="-1"></a><span class="fu">str_sub</span>(x, <span class="at">start =</span> <span class="sc">-</span><span class="dv">9</span>)</span></code></pre></div>
<pre><code>## [1] &quot;090060002&quot;</code></pre>
<p>Con la misma función <em>str_sub()</em> es posible <strong>sustituir parcial o totalmente</strong> la cadena “X” que sea introducida como argumento. Ésto se logra asignando a la subcadena seleccionada el valor que se usará para sustituir. En los siguientes ejemplos se muestra cómo modificar la cadena “substring” y la cadena “090060002”.</p>
<p>En el primer caso, a partir de la cadena de caracteres “substring” se procede a generar una nueva cadena al sustituir las letras 4 a la 9, reemplazando así la subcadena “string” por “cadena”, dando lugar a “subcadena”. En el segundo ejemplo, es la clave correspondiente a los dígitos 3 a 5 los que cambian para dar lugar a otra clave numérica.</p>
<div class="sourceCode" id="cb319"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb319-1"><a href="tidyverse.html#cb319-1" aria-hidden="true" tabindex="-1"></a>y <span class="ot">&lt;-</span> <span class="st">&quot;substring&quot;</span></span>
<span id="cb319-2"><a href="tidyverse.html#cb319-2" aria-hidden="true" tabindex="-1"></a><span class="fu">str_sub</span>(y, <span class="at">start =</span> <span class="dv">4</span>, <span class="at">end =</span> <span class="dv">9</span>) <span class="ot">&lt;-</span> <span class="st">&quot;cadena&quot;</span>; y</span></code></pre></div>
<pre><code>## [1] &quot;subcadena&quot;</code></pre>
<div class="sourceCode" id="cb321"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb321-1"><a href="tidyverse.html#cb321-1" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="st">&quot;090060002&quot;</span></span>
<span id="cb321-2"><a href="tidyverse.html#cb321-2" aria-hidden="true" tabindex="-1"></a><span class="fu">str_sub</span>(x, <span class="at">start =</span> <span class="fu">str_length</span>(x)<span class="sc">-</span><span class="dv">6</span>,<span class="fu">str_length</span>(x)<span class="sc">-</span><span class="dv">4</span>) <span class="ot">&lt;-</span> <span class="st">&quot;555&quot;</span>; x </span></code></pre></div>
<pre><code>## [1] &quot;095550002&quot;</code></pre>
<p>Lo anterior es ampliamente usado en el proceso de limpieza de los datos. A veces es posible encontrar errores ortográficos o los llamados errores “de dedo” (hacen referencia a errores accidentales al escribir) que se dan a la hora de capturar la información. Cuando una gran cantidad de datos presentan el mismo error, es buena idea recurrir a esta función.</p>
</div>
<div id="expresiones-regulares" class="section level3 hasAnchor" number="3.4.5">
<h3><span class="header-section-number">3.4.5</span> Expresiones regulares<a href="tidyverse.html#expresiones-regulares" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>En el estudio de las expresiones regulares se puede encontrar de manera sobresaliente la aplicación de los <em>patrones coincidentes</em>, los cuáles sirven para describir y descubrir coincidencias de interés en conjuntos específicos a partir de cadenas de caracteres.</p>
<p>Con el fin de comprender y visualizar de manera práctica el uso de los patrones coincidentes con las expresiones regulares, se hará uso de la función <em>str_view()</em>, que permite distinguir los elementos coincidentes de un vector con un patrón de caracteres descrito.</p>
<p>La paquetería <em>stringr</em> cuenta con tres conjuntos predefinidos de oraciones y palabras que sirven para ejemplificar el uso de las expresiones regulares. Estos conjuntos llevan el nombre de <strong>sentences, words y fruit</strong>, su contenido es de sentencias, palabras y nombres de frutas. En los tres casos, estos conjuntos han sido escritos en inglés. Los conjuntos sirven bien para ejemplificar el uso de las siguientes funciones y de las expresiones regulares.</p>
<div class="sourceCode" id="cb323"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb323-1"><a href="tidyverse.html#cb323-1" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(sentences, <span class="dv">10</span>)</span></code></pre></div>
<pre><code>##  [1] &quot;The birch canoe slid on the smooth planks.&quot; 
##  [2] &quot;Glue the sheet to the dark blue background.&quot;
##  [3] &quot;It&#39;s easy to tell the depth of a well.&quot;     
##  [4] &quot;These days a chicken leg is a rare dish.&quot;   
##  [5] &quot;Rice is often served in round bowls.&quot;       
##  [6] &quot;The juice of lemons makes fine punch.&quot;      
##  [7] &quot;The box was thrown beside the parked truck.&quot;
##  [8] &quot;The hogs were fed chopped corn and garbage.&quot;
##  [9] &quot;Four hours of steady work faced us.&quot;        
## [10] &quot;Large size in stockings is hard to sell.&quot;</code></pre>
<div class="sourceCode" id="cb325"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb325-1"><a href="tidyverse.html#cb325-1" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(words, <span class="dv">20</span>)</span></code></pre></div>
<pre><code>##  [1] &quot;a&quot;         &quot;able&quot;      &quot;about&quot;     &quot;absolute&quot;  &quot;accept&quot;    &quot;account&quot;  
##  [7] &quot;achieve&quot;   &quot;across&quot;    &quot;act&quot;       &quot;active&quot;    &quot;actual&quot;    &quot;add&quot;      
## [13] &quot;address&quot;   &quot;admit&quot;     &quot;advertise&quot; &quot;affect&quot;    &quot;afford&quot;    &quot;after&quot;    
## [19] &quot;afternoon&quot; &quot;again&quot;</code></pre>
<div class="sourceCode" id="cb327"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb327-1"><a href="tidyverse.html#cb327-1" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(fruit, <span class="dv">20</span>)</span></code></pre></div>
<pre><code>##  [1] &quot;apple&quot;        &quot;apricot&quot;      &quot;avocado&quot;      &quot;banana&quot;       &quot;bell pepper&quot; 
##  [6] &quot;bilberry&quot;     &quot;blackberry&quot;   &quot;blackcurrant&quot; &quot;blood orange&quot; &quot;blueberry&quot;   
## [11] &quot;boysenberry&quot;  &quot;breadfruit&quot;   &quot;canary melon&quot; &quot;cantaloupe&quot;   &quot;cherimoya&quot;   
## [16] &quot;cherry&quot;       &quot;chili pepper&quot; &quot;clementine&quot;   &quot;cloudberry&quot;   &quot;coconut&quot;</code></pre>
<p>Para realizar una coincidencia de patrones, es necesario ingresar como argumento el vector de cadenas de caracteres en donde se desea hacer la búsqueda. Como segundo argumento, se ingresa el patrón con el cuál se desea buscar las coincidencias. Para que únicamente se muestren las coincidencias exitosas se debe agregar el argumento match = TRUE.</p>
<div class="sourceCode" id="cb329"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb329-1"><a href="tidyverse.html#cb329-1" aria-hidden="true" tabindex="-1"></a><span class="fu">str_view</span>(sentences,<span class="st">&quot;great&quot;</span>, <span class="at">match =</span> <span class="cn">TRUE</span>)</span></code></pre></div>
<div id="htmlwidget-8b912759ab9078d64c84" style="width:960px;height:100%;" class="str_view html-widget"></div>
<script type="application/json" data-for="htmlwidget-8b912759ab9078d64c84">{"x":{"html":"<ul>\n  <li>Act on these orders with <span class='match'>great<\/span> speed.<\/li>\n  <li>He knew the skill of the <span class='match'>great<\/span> young actress.<\/li>\n  <li>The aim of the contest is to raise a <span class='match'>great<\/span> fund.<\/li>\n  <li>Seven seals were stamped on <span class='match'>great<\/span> sheets.<\/li>\n<\/ul>"},"evals":[],"jsHooks":[]}</script>
<div class="sourceCode" id="cb330"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb330-1"><a href="tidyverse.html#cb330-1" aria-hidden="true" tabindex="-1"></a><span class="fu">str_view</span>(sentences,<span class="st">&quot;this&quot;</span>, <span class="at">match =</span> <span class="cn">TRUE</span>)</span></code></pre></div>
<div id="htmlwidget-362a2199539b68a5ed62" style="width:960px;height:100%;" class="str_view html-widget"></div>
<script type="application/json" data-for="htmlwidget-362a2199539b68a5ed62">{"x":{"html":"<ul>\n  <li>These <span class='match'>this<\/span>tles bend in a high wind.<\/li>\n  <li>A speedy man can beat <span class='match'>this<\/span> track mark.<\/li>\n  <li>Madam, <span class='match'>this<\/span> is the best brand of corn.<\/li>\n  <li>Dispense with a vest on a day like <span class='match'>this<\/span>.<\/li>\n  <li>The water in <span class='match'>this<\/span> well is a source of good health.<\/li>\n  <li>Take shelter in <span class='match'>this<\/span> tent, but keep still.<\/li>\n  <li>Shake hands with <span class='match'>this<\/span> friendly child.<\/li>\n  <li>A rich farm is rare in <span class='match'>this<\/span> sandy waste.<\/li>\n  <li>Flood the mails with requests for <span class='match'>this<\/span> book.<\/li>\n  <li>Post no bills on <span class='match'>this<\/span> office wall.<\/li>\n<\/ul>"},"evals":[],"jsHooks":[]}</script>
<p>Como es posible apreciarse en los dos ejemplos anteriores, la función <em>str_view()</em> filtra los casos coincidentes con los patrones “great” y “this”. Esta coincidencia no necesariamente es perfecta. Basta con que un subconjunto de la sentencia coincida con el patrón definido para que la función <em>str_view()</em> reconozca como coincidencia válida a toda la cadena.</p>
<p>En caso de no contar con todos los caracteres del patrón deseado o de querer ver todas las combinaciones que tengan un patrón adyacente común, es posible ingresar un “comodín” a través del caracter punto “.”, el cuál coincidirá con cualquier caracter. Este caracter especial puede usarse al principio, al final o de manera intermedia dentro del patrón.</p>
<div class="sourceCode" id="cb331"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb331-1"><a href="tidyverse.html#cb331-1" aria-hidden="true" tabindex="-1"></a><span class="fu">str_view</span>(sentences,<span class="st">&quot;up.&quot;</span>, <span class="at">match =</span> <span class="cn">TRUE</span>)</span></code></pre></div>
<div id="htmlwidget-e546bfa15d6fc454bd38" style="width:960px;height:100%;" class="str_view html-widget"></div>
<script type="application/json" data-for="htmlwidget-e546bfa15d6fc454bd38">{"x":{"html":"<ul>\n  <li>The small p<span class='match'>up <\/span>gnawed a hole in the sock.<\/li>\n  <li>A c<span class='match'>up <\/span>of sugar makes sweet fudge.<\/li>\n  <li>The play seems dull and quite st<span class='match'>upi<\/span>d.<\/li>\n  <li>The c<span class='match'>up <\/span>cracked and spilled its contents.<\/li>\n  <li>An abr<span class='match'>upt<\/span> start does not win the prize.<\/li>\n  <li>A rag will soak <span class='match'>up <\/span>spilled water.<\/li>\n  <li>Rake the rubbish <span class='match'>up <\/span>and then burn it.<\/li>\n  <li>He broke his ties with gro<span class='match'>ups<\/span> of former friends.<\/li>\n  <li>Jump the fence and hurry <span class='match'>up <\/span>the bank.<\/li>\n  <li>Women form less than half of the gro<span class='match'>up.<\/span><\/li>\n  <li>Just hoist it <span class='match'>up <\/span>and take it away,<\/li>\n  <li>The sun came <span class='match'>up <\/span>to light the eastern sky.<\/li>\n  <li>Grace makes <span class='match'>up <\/span>for lack of beauty.<\/li>\n  <li>The ramp led <span class='match'>up <\/span>to the wide highway.<\/li>\n  <li>He picked <span class='match'>up <\/span>the dice for a second roll.<\/li>\n  <li>Throw out the used paper c<span class='match'>up <\/span>and plate.<\/li>\n  <li>Footprints showed the path he took <span class='match'>up <\/span>the beach.<\/li>\n  <li>A six comes <span class='match'>up <\/span>more often than a ten.<\/li>\n  <li>The p<span class='match'>up <\/span>jerked the leash as he saw a feline shape.<\/li>\n<\/ul>"},"evals":[],"jsHooks":[]}</script>
<p>Como se puede observar, esta es una manera de detectar subconjuntos de particular interés.</p>
<p>Si \ es usado para escapar un caracter especial, ¿cómo hacemos para hacer match con el caracter \ literalmente? Necesita ser escapado, creando la expresión regular \\. Para crear la expresión regular, se necesita usar un string, el cual también requiere ser escapado. Esto significa que para hacer match con  se necesita escribir “\\\\” cuatro diagonales invertidas para hacer match con una sola diagonal invertida \.</p>
<p>Los primeros 2 diagonales son para crear la expresión regular, la tercera es para escapar el caracter especial siguiente, el cual corresponde a la cuarta diagonal.</p>
<p><strong>Anclajes</strong></p>
<p>Como se mencionó anteriormente, por default, la coincidencia de patrones se efectuará sobre cualquier subconjunto de la cadena de caracteres. Es posible definir el caracter inicial y/o el caracter final con el cuál se buscará la coincidencia de patrones. Esto se logra al hacer uso de los siguientes caracteres especiales.</p>
<ul>
<li>^ Para hacer coincidir el inicio de la cadena</li>
<li>$ Para hacer coincidir el final de la cadena</li>
</ul>
<div class="sourceCode" id="cb332"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb332-1"><a href="tidyverse.html#cb332-1" aria-hidden="true" tabindex="-1"></a><span class="fu">str_view</span>(words,<span class="st">&quot;^y&quot;</span>, <span class="at">match =</span> <span class="cn">TRUE</span>)</span></code></pre></div>
<div id="htmlwidget-e9dafe808fa7229e4bb4" style="width:960px;height:100%;" class="str_view html-widget"></div>
<script type="application/json" data-for="htmlwidget-e9dafe808fa7229e4bb4">{"x":{"html":"<ul>\n  <li><span class='match'>y<\/span>ear<\/li>\n  <li><span class='match'>y<\/span>es<\/li>\n  <li><span class='match'>y<\/span>esterday<\/li>\n  <li><span class='match'>y<\/span>et<\/li>\n  <li><span class='match'>y<\/span>ou<\/li>\n  <li><span class='match'>y<\/span>oung<\/li>\n<\/ul>"},"evals":[],"jsHooks":[]}</script>
<div class="sourceCode" id="cb333"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb333-1"><a href="tidyverse.html#cb333-1" aria-hidden="true" tabindex="-1"></a><span class="fu">str_view</span>(words,<span class="st">&quot;x$&quot;</span>, <span class="at">match =</span> <span class="cn">TRUE</span>)</span></code></pre></div>
<div id="htmlwidget-a2048a6b8334550f0906" style="width:960px;height:100%;" class="str_view html-widget"></div>
<script type="application/json" data-for="htmlwidget-a2048a6b8334550f0906">{"x":{"html":"<ul>\n  <li>bo<span class='match'>x<\/span><\/li>\n  <li>se<span class='match'>x<\/span><\/li>\n  <li>si<span class='match'>x<\/span><\/li>\n  <li>ta<span class='match'>x<\/span><\/li>\n<\/ul>"},"evals":[],"jsHooks":[]}</script>
<p>En caso de desear hacer coincidir todo el contenido de la cadena, deben usarse ambos caracteres especiales para definir el inicio y el final del patrón coincidente como se muestra a continuación.</p>
<div class="sourceCode" id="cb334"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb334-1"><a href="tidyverse.html#cb334-1" aria-hidden="true" tabindex="-1"></a>vector <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;nulo aprendizaje&quot;</span>, <span class="st">&quot;poco aprendizaje&quot;</span>,<span class="st">&quot;aprendizaje moderado&quot;</span>,<span class="st">&quot;aprendizaje&quot;</span>, <span class="st">&quot;aprendizaje total&quot;</span>)</span></code></pre></div>
<div class="sourceCode" id="cb335"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb335-1"><a href="tidyverse.html#cb335-1" aria-hidden="true" tabindex="-1"></a><span class="fu">str_view</span>(vector,<span class="st">&quot;^aprendizaje$&quot;</span>)</span></code></pre></div>
<div id="htmlwidget-3e43e87240e8621fe119" style="width:960px;height:100%;" class="str_view html-widget"></div>
<script type="application/json" data-for="htmlwidget-3e43e87240e8621fe119">{"x":{"html":"<ul>\n  <li>nulo aprendizaje<\/li>\n  <li>poco aprendizaje<\/li>\n  <li>aprendizaje moderado<\/li>\n  <li><span class='match'>aprendizaje<\/span><\/li>\n  <li>aprendizaje total<\/li>\n<\/ul>"},"evals":[],"jsHooks":[]}</script>
<p>Wickham menciona que, además del caracter especial punto “.”, existen otros cuatro que resultan muy útiles para mostrar patrones particulares.</p>
<ul>
<li>\d Hace coincidir cualquier dígito.</li>
<li>\s Hace coincidir cualquier espacio en blanco (espacio, tabulador, salto de línea).</li>
<li>[abc] Hace coincidir a, b ó c.</li>
<li>[^abc] Coincide con cualquier cosa excepto a, b ó c.</li>
</ul>
<p>Al momento de definir cualquiera de estos 4 patrones coincidentes será necesario usar doble diagonal invertida. Por ejemplo, “\\d” será el patrón para encontrar la coincidencia con cualquier dígito.</p>
<div class="sourceCode" id="cb336"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb336-1"><a href="tidyverse.html#cb336-1" aria-hidden="true" tabindex="-1"></a>cadena <span class="ot">&lt;-</span> <span class="st">&quot;El año 2022 será un año de mucho crecimiento.&quot;</span></span></code></pre></div>
<div class="sourceCode" id="cb337"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb337-1"><a href="tidyverse.html#cb337-1" aria-hidden="true" tabindex="-1"></a><span class="fu">str_view</span>(cadena,<span class="st">&quot;</span><span class="sc">\\</span><span class="st">d&quot;</span>, <span class="at">match =</span> T)</span></code></pre></div>
<div id="htmlwidget-8439f1be904d72cbf198" style="width:960px;height:100%;" class="str_view html-widget"></div>
<script type="application/json" data-for="htmlwidget-8439f1be904d72cbf198">{"x":{"html":"<ul>\n  <li>El año <span class='match'>2<\/span>022 será un año de mucho crecimiento.<\/li>\n<\/ul>"},"evals":[],"jsHooks":[]}</script>
<p>Wickham menciona que, “es posible usar alternancias para elegir entre uno o más patrones alternativos. Por ejemplo, abc|d..f coincidirá con”abc” o con “deaf”. Haciendo notar que la prioridad para el operador “|” es baja, por lo que abc|xyz coincide con abc o xyz, no con abcyz o abxyz. Al igual que en las matemáticas, si existe ambigüedad en la prioridad de las operaciones, usar paréntesis lo hará todo más claro.”</p>
<div class="sourceCode" id="cb338"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb338-1"><a href="tidyverse.html#cb338-1" aria-hidden="true" tabindex="-1"></a><span class="fu">str_view</span>(<span class="fu">c</span>(<span class="st">&quot;tamaño&quot;</span>,<span class="st">&quot;tasa&quot;</span>,<span class="st">&quot;tata&quot;</span>,<span class="st">&quot;taza&quot;</span>,<span class="st">&quot;tapa&quot;</span>),<span class="st">&quot;ta(s|z)a&quot;</span>)</span></code></pre></div>
<div id="htmlwidget-5aa9cf735da6dbc87219" style="width:960px;height:100%;" class="str_view html-widget"></div>
<script type="application/json" data-for="htmlwidget-5aa9cf735da6dbc87219">{"x":{"html":"<ul>\n  <li>tamaño<\/li>\n  <li><span class='match'>tasa<\/span><\/li>\n  <li>tata<\/li>\n  <li><span class='match'>taza<\/span><\/li>\n  <li>tapa<\/li>\n<\/ul>"},"evals":[],"jsHooks":[]}</script>
<p><strong>Repeticiones</strong></p>
<p>El siguiente paso en complejidad para las expresiones regulares es, controlar el número de veces que aparece un patrón coincidente.</p>
<ul>
<li>?: Se repite 0 o 1.</li>
<li>+: Se repite 1 o más veces.</li>
<li>*: Se repite 0 a más veces.</li>
</ul>
<div class="sourceCode" id="cb339"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb339-1"><a href="tidyverse.html#cb339-1" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="st">&quot;1888 es el año más largo en números romanos: MDCCCLXXXVIII&quot;</span></span></code></pre></div>
<div class="sourceCode" id="cb340"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb340-1"><a href="tidyverse.html#cb340-1" aria-hidden="true" tabindex="-1"></a><span class="fu">str_view</span>(x,<span class="st">&quot;XX?&quot;</span>)</span></code></pre></div>
<div id="htmlwidget-5a89276dbbbd8d67fce2" style="width:960px;height:100%;" class="str_view html-widget"></div>
<script type="application/json" data-for="htmlwidget-5a89276dbbbd8d67fce2">{"x":{"html":"<ul>\n  <li>1888 es el año más largo en números romanos: MDCCCL<span class='match'>XX<\/span>XVIII<\/li>\n<\/ul>"},"evals":[],"jsHooks":[]}</script>
<div class="sourceCode" id="cb341"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb341-1"><a href="tidyverse.html#cb341-1" aria-hidden="true" tabindex="-1"></a><span class="fu">str_view</span>(x,<span class="st">&quot;XX+&quot;</span>)</span></code></pre></div>
<div id="htmlwidget-845bc59302389bd4d119" style="width:960px;height:100%;" class="str_view html-widget"></div>
<script type="application/json" data-for="htmlwidget-845bc59302389bd4d119">{"x":{"html":"<ul>\n  <li>1888 es el año más largo en números romanos: MDCCCL<span class='match'>XXX<\/span>VIII<\/li>\n<\/ul>"},"evals":[],"jsHooks":[]}</script>
<div class="sourceCode" id="cb342"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb342-1"><a href="tidyverse.html#cb342-1" aria-hidden="true" tabindex="-1"></a><span class="fu">str_view</span>(x,<span class="st">&quot;C[LX]+&quot;</span>)</span></code></pre></div>
<div id="htmlwidget-f3546425fb1514eadd08" style="width:960px;height:100%;" class="str_view html-widget"></div>
<script type="application/json" data-for="htmlwidget-f3546425fb1514eadd08">{"x":{"html":"<ul>\n  <li>1888 es el año más largo en números romanos: MDCC<span class='match'>CLXXX<\/span>VIII<\/li>\n<\/ul>"},"evals":[],"jsHooks":[]}</script>
<p>Es posible especificar el número de repeticiones que se desea hacer coincidir un patrón. Ya sea de manera exacta o dentro de un intervalo. Esta repetición en el patrón se define de la siguiente manera.</p>
<ul>
<li>{n}: exactamente n veces</li>
<li>{n,}: n o más veces</li>
<li>{,m}: a lo más m veces</li>
<li>{n,m}: entre n y m veces</li>
</ul>
<div class="sourceCode" id="cb343"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb343-1"><a href="tidyverse.html#cb343-1" aria-hidden="true" tabindex="-1"></a><span class="fu">str_view</span>(x,<span class="st">&quot;X{3}&quot;</span>)</span></code></pre></div>
<div id="htmlwidget-074f3a04a072e22e5cfd" style="width:960px;height:100%;" class="str_view html-widget"></div>
<script type="application/json" data-for="htmlwidget-074f3a04a072e22e5cfd">{"x":{"html":"<ul>\n  <li>1888 es el año más largo en números romanos: MDCCCL<span class='match'>XXX<\/span>VIII<\/li>\n<\/ul>"},"evals":[],"jsHooks":[]}</script>
<div class="sourceCode" id="cb344"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb344-1"><a href="tidyverse.html#cb344-1" aria-hidden="true" tabindex="-1"></a><span class="fu">str_view</span>(x,<span class="st">&quot;X{1,2}&quot;</span>)</span></code></pre></div>
<div id="htmlwidget-b876c6d75cd3a5a17d08" style="width:960px;height:100%;" class="str_view html-widget"></div>
<script type="application/json" data-for="htmlwidget-b876c6d75cd3a5a17d08">{"x":{"html":"<ul>\n  <li>1888 es el año más largo en números romanos: MDCCCL<span class='match'>XX<\/span>XVIII<\/li>\n<\/ul>"},"evals":[],"jsHooks":[]}</script>
<p><strong>Match múltiple / nulo</strong></p>
<p>Es interesante el siguiente ejemplo. ¿Qué es lo que sucede?</p>
<div class="sourceCode" id="cb345"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb345-1"><a href="tidyverse.html#cb345-1" aria-hidden="true" tabindex="-1"></a><span class="fu">str_view</span>(x,<span class="st">&quot;M*&quot;</span>)</span></code></pre></div>
<div id="htmlwidget-5436d2c8542b23cf1984" style="width:960px;height:100%;" class="str_view html-widget"></div>
<script type="application/json" data-for="htmlwidget-5436d2c8542b23cf1984">{"x":{"html":"<ul>\n  <li><span class='match'><\/span>1888 es el año más largo en números romanos: MDCCCLXXXVIII<\/li>\n<\/ul>"},"evals":[],"jsHooks":[]}</script>
<p>Recordemos que los operadores * o ? busca un patrón que puede o no encontrarse dentro de la cadena de interés. En el caso anterior, la letra “M” puede o no encontrarse en la cadena “x”. En el ejemplo anterior, en cada posible caracter existe el hallazgo o no hallazgo de la letra “M”, de forma que el primer match que hace se encuentra al principio de la cadena. Una limitante de la función <em>str_view()</em> es que <strong>únicamente resalta la primer coincidencia</strong> encontrada con el patrón regular, sin embargo, la función <em>str_view_all()</em> se encarga de resaltar todas las coincidencias en la cadena, como se muestra a continuación.</p>
<div class="sourceCode" id="cb346"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb346-1"><a href="tidyverse.html#cb346-1" aria-hidden="true" tabindex="-1"></a><span class="fu">str_view_all</span>(x,<span class="st">&quot;M*&quot;</span>)</span></code></pre></div>
<div id="htmlwidget-1fc1e9fa82d2a11c44e9" style="width:960px;height:100%;" class="str_view html-widget"></div>
<script type="application/json" data-for="htmlwidget-1fc1e9fa82d2a11c44e9">{"x":{"html":"<ul>\n  <li><span class='match'><\/span>1<span class='match'><\/span>8<span class='match'><\/span>8<span class='match'><\/span>8<span class='match'><\/span> <span class='match'><\/span>e<span class='match'><\/span>s<span class='match'><\/span> <span class='match'><\/span>e<span class='match'><\/span>l<span class='match'><\/span> <span class='match'><\/span>a<span class='match'><\/span>ñ<span class='match'><\/span>o<span class='match'><\/span> <span class='match'><\/span>m<span class='match'><\/span>á<span class='match'><\/span>s<span class='match'><\/span> <span class='match'><\/span>l<span class='match'><\/span>a<span class='match'><\/span>r<span class='match'><\/span>g<span class='match'><\/span>o<span class='match'><\/span> <span class='match'><\/span>e<span class='match'><\/span>n<span class='match'><\/span> <span class='match'><\/span>n<span class='match'><\/span>ú<span class='match'><\/span>m<span class='match'><\/span>e<span class='match'><\/span>r<span class='match'><\/span>o<span class='match'><\/span>s<span class='match'><\/span> <span class='match'><\/span>r<span class='match'><\/span>o<span class='match'><\/span>m<span class='match'><\/span>a<span class='match'><\/span>n<span class='match'><\/span>o<span class='match'><\/span>s<span class='match'><\/span>:<span class='match'><\/span> <span class='match'>M<\/span><span class='match'><\/span>D<span class='match'><\/span>C<span class='match'><\/span>C<span class='match'><\/span>C<span class='match'><\/span>L<span class='match'><\/span>X<span class='match'><\/span>X<span class='match'><\/span>X<span class='match'><\/span>V<span class='match'><\/span>I<span class='match'><\/span>I<span class='match'><\/span>I<span class='match'><\/span><\/li>\n<\/ul>"},"evals":[],"jsHooks":[]}</script>
<p><strong>Herramientas</strong></p>
<p>Una vez que se han visto los aspectos básicos de las expresiones regulares, es posible utilizar los patrones coincidentes y combinarlos para aplicarlos en problemas reales. Algunas de las aplicaciones más comunes son:</p>
<ul>
<li>Determinar cuáles cadenas coinciden con un patrón.</li>
<li>Encontrar la posición de las coincidencias.</li>
<li>Extraer el contenido de las coincidencias.</li>
<li>Reemplazar coincidencias con nuevos valores.</li>
<li>Dividir una cadena basándose en una coincidencia.</li>
</ul>
<p>A continuación se analizarán las funciones que permitirán realizar las acciones anteriores.</p>
</div>
<div id="detectar-coincidencias" class="section level3 hasAnchor" number="3.4.6">
<h3><span class="header-section-number">3.4.6</span> Detectar coincidencias<a href="tidyverse.html#detectar-coincidencias" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Para determinar las cadenas de caracteres dentro de un vector que coinciden con un patrón, es posible utilizar la función <em>str_detect()</em>. La función regresará un vector booleano una vez que se introduzcan como argumentos el vector con cadenas y el patrón con el que se desea hacer la coincidencia.</p>
<p>Aplicando esta función a un marco de muestreo es posible apreciar si los elementos coinciden o no con algún patrón indicado.</p>
<p>En el siguiente ejemplo se puede apreciar cuáles frutas tienen entre sus letras una “a” o una “u”.</p>
<div class="sourceCode" id="cb347"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb347-1"><a href="tidyverse.html#cb347-1" aria-hidden="true" tabindex="-1"></a><span class="fu">str_detect</span>(fruit, <span class="st">&quot;[au]&quot;</span>)</span></code></pre></div>
<pre><code>##  [1]  TRUE  TRUE  TRUE  TRUE FALSE FALSE  TRUE  TRUE  TRUE  TRUE FALSE  TRUE
## [13]  TRUE  TRUE  TRUE FALSE FALSE FALSE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE
## [25]  TRUE  TRUE  TRUE  TRUE FALSE  TRUE FALSE FALSE FALSE  TRUE  TRUE  TRUE
## [37] FALSE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE FALSE FALSE  TRUE FALSE  TRUE
## [49]  TRUE  TRUE  TRUE  TRUE FALSE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE FALSE
## [61]  TRUE  TRUE  TRUE  TRUE FALSE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE FALSE
## [73]  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE</code></pre>
<p>A continuación se puede apreciar una aplicación de la función <em>str_detect()</em>. Se usará el vector booleano para seleccionar el subconjunto del objeto <strong>fruit</strong> que tiene entre su nombre una letra “l” o una letra “o”.</p>
<div class="sourceCode" id="cb349"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb349-1"><a href="tidyverse.html#cb349-1" aria-hidden="true" tabindex="-1"></a>fruit[<span class="fu">str_detect</span>(fruit, <span class="st">&quot;[lo]&quot;</span>)]</span></code></pre></div>
<pre><code>##  [1] &quot;apple&quot;             &quot;apricot&quot;           &quot;avocado&quot;          
##  [4] &quot;bell pepper&quot;       &quot;bilberry&quot;          &quot;blackberry&quot;       
##  [7] &quot;blackcurrant&quot;      &quot;blood orange&quot;      &quot;blueberry&quot;        
## [10] &quot;boysenberry&quot;       &quot;canary melon&quot;      &quot;cantaloupe&quot;       
## [13] &quot;cherimoya&quot;         &quot;chili pepper&quot;      &quot;clementine&quot;       
## [16] &quot;cloudberry&quot;        &quot;coconut&quot;           &quot;damson&quot;           
## [19] &quot;dragonfruit&quot;       &quot;eggplant&quot;          &quot;elderberry&quot;       
## [22] &quot;feijoa&quot;            &quot;goji berry&quot;        &quot;gooseberry&quot;       
## [25] &quot;honeydew&quot;          &quot;huckleberry&quot;       &quot;jambul&quot;           
## [28] &quot;lemon&quot;             &quot;lime&quot;              &quot;loquat&quot;           
## [31] &quot;lychee&quot;            &quot;mango&quot;             &quot;mulberry&quot;         
## [34] &quot;olive&quot;             &quot;orange&quot;            &quot;pamelo&quot;           
## [37] &quot;passionfruit&quot;      &quot;persimmon&quot;         &quot;physalis&quot;         
## [40] &quot;pineapple&quot;         &quot;plum&quot;              &quot;pomegranate&quot;      
## [43] &quot;pomelo&quot;            &quot;purple mangosteen&quot; &quot;rock melon&quot;       
## [46] &quot;salal berry&quot;       &quot;tamarillo&quot;         &quot;ugli fruit&quot;       
## [49] &quot;watermelon&quot;</code></pre>
<p>De esta manera se va filtrando un marco muestral para quedarse únicamente con los elementos que coincidan con un patrón coincidente.</p>
</div>
<div id="contabilizar-coincidencias" class="section level3 hasAnchor" number="3.4.7">
<h3><span class="header-section-number">3.4.7</span> Contabilizar coincidencias<a href="tidyverse.html#contabilizar-coincidencias" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Una variación de la función anterior, es la función <em>str_count()</em>. Esta función en lugar de devolver un vector lógico, devuelve un vector de conteos que corresponde al número de veces que detectó una coincidencia para cada cadena dentro de un vector.</p>
<p>La manera de usarse es análoga a la función str_detect().</p>
<div class="sourceCode" id="cb351"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb351-1"><a href="tidyverse.html#cb351-1" aria-hidden="true" tabindex="-1"></a><span class="fu">str_count</span>(fruit, <span class="st">&quot;[aeiou]&quot;</span>)</span></code></pre></div>
<pre><code>##  [1] 2 3 4 3 3 2 2 3 5 3 3 4 4 5 4 1 4 4 3 3 2 3 2 2 2 4 3 2 3 4 1 3 4 2 4 3 3 3
## [39] 3 2 3 4 3 2 2 3 2 4 2 2 4 1 3 3 3 3 5 2 2 3 2 4 1 5 3 6 3 3 3 2 3 3 3 3 3 2
## [77] 4 4 4 4</code></pre>
<p>En el ejemplo anterior se puede apreciar el número de vocales que existen dentro de cada una de los nombres de las frutas.</p>
<p>Una de las aplicaciones más comunes para esta función, se encuentra en los estudios de análisis de textos. A continuación, se puede apreciar el promedio de vocales que son usadas dentro de los nombres de frutas en el objeto <strong>fruit</strong>.</p>
<div class="sourceCode" id="cb353"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb353-1"><a href="tidyverse.html#cb353-1" aria-hidden="true" tabindex="-1"></a><span class="fu">mean</span>(<span class="fu">str_count</span>(fruit, <span class="st">&quot;[aeiou]&quot;</span>))</span></code></pre></div>
<pre><code>## [1] 3.0125</code></pre>
<p>Otro ejemplo más complejo de esta función y sus aplicaciones es el siguiente:</p>
<div class="sourceCode" id="cb355"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb355-1"><a href="tidyverse.html#cb355-1" aria-hidden="true" tabindex="-1"></a>tabla <span class="ot">&lt;-</span> <span class="fu">tibble</span>(</span>
<span id="cb355-2"><a href="tidyverse.html#cb355-2" aria-hidden="true" tabindex="-1"></a>  <span class="st">&quot;Vocal&quot;</span> <span class="ot">=</span> <span class="fu">c</span>(<span class="st">&quot;a&quot;</span>,<span class="st">&quot;e&quot;</span>,<span class="st">&quot;i&quot;</span>,<span class="st">&quot;o&quot;</span>,<span class="st">&quot;u&quot;</span>),</span>
<span id="cb355-3"><a href="tidyverse.html#cb355-3" aria-hidden="true" tabindex="-1"></a>  <span class="st">&quot;Conteos&quot;</span> <span class="ot">=</span> <span class="fu">c</span>(<span class="fu">sum</span>(<span class="fu">str_count</span>(fruit, <span class="st">&quot;a&quot;</span>)),<span class="fu">sum</span>(<span class="fu">str_count</span>(fruit, <span class="st">&quot;e&quot;</span>)),</span>
<span id="cb355-4"><a href="tidyverse.html#cb355-4" aria-hidden="true" tabindex="-1"></a>                <span class="fu">sum</span>(<span class="fu">str_count</span>(fruit, <span class="st">&quot;i&quot;</span>)),<span class="fu">sum</span>(<span class="fu">str_count</span>(fruit, <span class="st">&quot;o&quot;</span>)),</span>
<span id="cb355-5"><a href="tidyverse.html#cb355-5" aria-hidden="true" tabindex="-1"></a>                <span class="fu">sum</span>(<span class="fu">str_count</span>(fruit, <span class="st">&quot;u&quot;</span>)))) <span class="sc">%&gt;%</span> </span>
<span id="cb355-6"><a href="tidyverse.html#cb355-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Porcentaje =</span> Conteos<span class="sc">/</span><span class="fu">sum</span>(Conteos))</span>
<span id="cb355-7"><a href="tidyverse.html#cb355-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb355-8"><a href="tidyverse.html#cb355-8" aria-hidden="true" tabindex="-1"></a>tabla</span></code></pre></div>
<pre><code>## # A tibble: 5 × 3
##   Vocal Conteos Porcentaje
##   &lt;chr&gt;   &lt;int&gt;      &lt;dbl&gt;
## 1 a          65      0.270
## 2 e          72      0.299
## 3 i          34      0.141
## 4 o          36      0.149
## 5 u          34      0.141</code></pre>
<p>De esta manera es posible visualizar los conteos totales que tuvo cada vocal. Se calculó el porcentaje de aparición que tiene cada vocal con respecto al total de vocales en el conjunto.</p>
<p>Un dato curioso que es posible concluir con este ejemplo, es que, las vocales “a” y “e” aparecen casi dos veces más que el resto de las vocales en el conjunto <strong>fruit</strong>.</p>
<p>El anterior es un ejemplo sencillo que tiene por objetivo ilustrar el aprovechamiento de las funciones, sin embargo, una aplicación más robusta podría permitir que a través de los tweets emitidos a candidatos políticos, se realice un análisis de sentimientos, en el cual cada tweet sea asociado a uno o más sentimientos tales como: alegría, enojo, miedo, tristeza, aversión, etc.</p>
<p>Posteriormente, de manera análoga a los conteos de vocales con porcentajes, se podría analizar la distribución de los sentimientos asociados a las opiniones de cada uno de los candidatos políticos. Adicionalmente, se podría realizar un análisis en donde se muestren las palabras que más se repiten al expresarse de un candidato.</p>
</div>
<div id="extraer-coincidencias" class="section level3 hasAnchor" number="3.4.8">
<h3><span class="header-section-number">3.4.8</span> Extraer coincidencias<a href="tidyverse.html#extraer-coincidencias" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Cuando se desea identificar y extraer un subgrupo particular de elementos que cumplan con cierta condición definida a través de un patrón coincidente, la función <em>str_extract()</em> es la mejor opción para realizar esta tarea.</p>
<p>Si se desea extraer el subconjunto de sentencias conjuntivas o disyuntivas es necesario definir el patrón coincidente con el cuál se compararán las sentencias para ser extraídas.</p>
<div class="sourceCode" id="cb357"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb357-1"><a href="tidyverse.html#cb357-1" aria-hidden="true" tabindex="-1"></a>patron <span class="ot">&lt;-</span> <span class="st">&quot;( and )|( or )&quot;</span></span></code></pre></div>
<p>Por su traducción en inglés, “and” y “or” son los conectores “y” y “o” respectivamente. Primero se filtrarán las oraciones que cumplen con la condición de que las conjunciones “and” u “or” se encuentren dentro y posteriormente se extraerán los elementos coincidentes.</p>
<div class="sourceCode" id="cb358"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb358-1"><a href="tidyverse.html#cb358-1" aria-hidden="true" tabindex="-1"></a>coincidencias <span class="ot">&lt;-</span> <span class="fu">str_subset</span>(sentences, patron)</span>
<span id="cb358-2"><a href="tidyverse.html#cb358-2" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(coincidencias,<span class="dv">10</span>)</span></code></pre></div>
<pre><code>##  [1] &quot;The hogs were fed chopped corn and garbage.&quot;    
##  [2] &quot;Kick the ball straight and follow through.&quot;     
##  [3] &quot;Smoky fires lack flame and heat.&quot;               
##  [4] &quot;The fish twisted and turned on the bent hook.&quot;  
##  [5] &quot;Press the pants and sew a button on the vest.&quot;  
##  [6] &quot;The colt reared and threw the tall rider.&quot;      
##  [7] &quot;It snowed, rained, and hailed the same morning.&quot;
##  [8] &quot;The wrist was badly strained and hung limp.&quot;    
##  [9] &quot;Hop over the fence and plunge in.&quot;              
## [10] &quot;Cars and busses stalled in snow drifts.&quot;</code></pre>
<p>Apenas 123 sentencias cumplen con la condición. Éstas representan el 17.08% del total. Para extraer los elementos coincidentes, la función <em>str_extract()</em> se usa de la siguiente manera:</p>
<div class="sourceCode" id="cb360"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb360-1"><a href="tidyverse.html#cb360-1" aria-hidden="true" tabindex="-1"></a><span class="fu">str_extract</span>(coincidencias, patron)</span></code></pre></div>
<pre><code>##   [1] &quot; and &quot; &quot; and &quot; &quot; and &quot; &quot; and &quot; &quot; and &quot; &quot; and &quot; &quot; and &quot; &quot; and &quot; &quot; and &quot;
##  [10] &quot; and &quot; &quot; and &quot; &quot; and &quot; &quot; and &quot; &quot; and &quot; &quot; and &quot; &quot; and &quot; &quot; and &quot; &quot; and &quot;
##  [19] &quot; and &quot; &quot; and &quot; &quot; and &quot; &quot; and &quot; &quot; and &quot; &quot; and &quot; &quot; and &quot; &quot; and &quot; &quot; and &quot;
##  [28] &quot; and &quot; &quot; or &quot;  &quot; or &quot;  &quot; and &quot; &quot; and &quot; &quot; and &quot; &quot; and &quot; &quot; and &quot; &quot; and &quot;
##  [37] &quot; and &quot; &quot; and &quot; &quot; and &quot; &quot; and &quot; &quot; and &quot; &quot; or &quot;  &quot; and &quot; &quot; and &quot; &quot; and &quot;
##  [46] &quot; or &quot;  &quot; and &quot; &quot; or &quot;  &quot; and &quot; &quot; and &quot; &quot; and &quot; &quot; and &quot; &quot; and &quot; &quot; and &quot;
##  [55] &quot; and &quot; &quot; and &quot; &quot; and &quot; &quot; and &quot; &quot; and &quot; &quot; and &quot; &quot; and &quot; &quot; and &quot; &quot; and &quot;
##  [64] &quot; and &quot; &quot; and &quot; &quot; and &quot; &quot; and &quot; &quot; and &quot; &quot; and &quot; &quot; and &quot; &quot; and &quot; &quot; and &quot;
##  [73] &quot; and &quot; &quot; and &quot; &quot; and &quot; &quot; and &quot; &quot; and &quot; &quot; and &quot; &quot; and &quot; &quot; and &quot; &quot; and &quot;
##  [82] &quot; and &quot; &quot; and &quot; &quot; and &quot; &quot; and &quot; &quot; and &quot; &quot; or &quot;  &quot; and &quot; &quot; and &quot; &quot; or &quot; 
##  [91] &quot; and &quot; &quot; and &quot; &quot; and &quot; &quot; and &quot; &quot; and &quot; &quot; and &quot; &quot; and &quot; &quot; and &quot; &quot; and &quot;
## [100] &quot; and &quot; &quot; and &quot; &quot; and &quot; &quot; and &quot; &quot; and &quot; &quot; and &quot; &quot; or &quot;  &quot; and &quot; &quot; and &quot;
## [109] &quot; and &quot; &quot; and &quot; &quot; and &quot; &quot; and &quot; &quot; and &quot; &quot; and &quot; &quot; and &quot; &quot; and &quot; &quot; and &quot;
## [118] &quot; and &quot; &quot; and &quot; &quot; and &quot; &quot; and &quot; &quot; and &quot; &quot; and &quot;</code></pre>
<p>Con el código anterior se logra extraer el patrón coincidente de cada una de las sentencias, sin embargo, sólo se logra extraer la primer coincidencia de cada cadena en donde hubo al menos una coincidencia. Para extender este resultado a todos los patrones coincidentes dentro de la sentencia, se debe agregar el sufijo “_all” a la función. La función <em>str_extract_all()</em> extraerá todas las coincidencias y las agrupará en un objeto cuya estructura será la de una “lista”. Con la función <em>head()</em> se logrará visualizar los 5 primeros elementos de la lista que guarda el resultado generado por la función <em>str_extract_all()</em>.</p>
<div class="sourceCode" id="cb362"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb362-1"><a href="tidyverse.html#cb362-1" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(<span class="fu">str_extract_all</span>(coincidencias,patron), <span class="dv">5</span>)</span></code></pre></div>
<pre><code>## [[1]]
## [1] &quot; and &quot;
## 
## [[2]]
## [1] &quot; and &quot;
## 
## [[3]]
## [1] &quot; and &quot;
## 
## [[4]]
## [1] &quot; and &quot;
## 
## [[5]]
## [1] &quot; and &quot;</code></pre>
<p>Un formato más compacto del resultado anterior se logra al agregar el parámetro “simplfy = TRUE” dentro de la función de extracción. Para visualizar aleatoriamente diez de los resultados generados, se puede hacer uso de la función <em>sample_n()</em> de la librería <em>dplyr</em>.</p>
<div class="sourceCode" id="cb364"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb364-1"><a href="tidyverse.html#cb364-1" aria-hidden="true" tabindex="-1"></a>dplyr<span class="sc">::</span><span class="fu">sample_n</span>(</span>
<span id="cb364-2"><a href="tidyverse.html#cb364-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">tbl =</span> <span class="fu">as_tibble</span>(<span class="fu">str_extract_all</span>(coincidencias, patron, <span class="at">simplify =</span> <span class="cn">TRUE</span>)), </span>
<span id="cb364-3"><a href="tidyverse.html#cb364-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">size =</span> <span class="dv">10</span></span>
<span id="cb364-4"><a href="tidyverse.html#cb364-4" aria-hidden="true" tabindex="-1"></a>)</span></code></pre></div>
<pre><code>## # A tibble: 10 × 2
##    V1      V2   
##    &lt;chr&gt;   &lt;chr&gt;
##  1 &quot; and &quot; &quot;&quot;   
##  2 &quot; and &quot; &quot;&quot;   
##  3 &quot; and &quot; &quot;&quot;   
##  4 &quot; or &quot;  &quot;&quot;   
##  5 &quot; and &quot; &quot;&quot;   
##  6 &quot; and &quot; &quot;&quot;   
##  7 &quot; or &quot;  &quot;&quot;   
##  8 &quot; and &quot; &quot;&quot;   
##  9 &quot; and &quot; &quot;&quot;   
## 10 &quot; and &quot; &quot;&quot;</code></pre>
<p>Si en alguna cadena existieran más de dos patrones coincidentes, aparecería en la segunda columna el patrón encontrado (e.g., elemento en el séptimo renglón), de lo contrario, el elemento de la segunda columna permanecerá vacío a través de dos comillas.</p>
<p>El resultado será un objeto de la clase <em>data.frame</em> que tendrá tantas columnas como coincidencias máximas hayan existido en una sentencia.</p>
<p>La siguientes línea de código permite hacer conteos del número de veces que el patrón coincidente fue detectado en el vector de oraciones. La función <em>str_count()</em> indicará el número de veces que el patrón fue detectado en cada oración. Finalmente, el vector numérico se suma.</p>
<div class="sourceCode" id="cb366"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb366-1"><a href="tidyverse.html#cb366-1" aria-hidden="true" tabindex="-1"></a><span class="fu">sum</span>(<span class="fu">str_count</span>(coincidencias, <span class="at">pattern =</span> patron))</span></code></pre></div>
<pre><code>## [1] 126</code></pre>
<p>Con este dato, se puede decir que a lo largo de 123 oraciones, se puede encontrar 126 veces el patrón indicado. Este tipo de análisis nos permite hacer reportes como el siguiente: En promedio, cada oración tiene incluido 1.02 veces el patrón coincidente.</p>
<p>A continuación, se revisará el modo de detectar y reemplazar patrones regulares.</p>
</div>
<div id="reemplazar-coincidencias" class="section level3 hasAnchor" number="3.4.9">
<h3><span class="header-section-number">3.4.9</span> Reemplazar coincidencias<a href="tidyverse.html#reemplazar-coincidencias" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>A menudo es necesario reemplazar algunos patrones. Ya sea derivado de un error en las cadenas de texto o por interés de presentar los resultados de una manera distinta, identificar y sustituir un subconjunto de caracteres es algo que la función <em>str_replace()</em> de la paquetería stringr puede hacer.</p>
<p>Como todas las funciones vistas hasta el momento provenientes de la paquetería stringr, la función <em>str_replace()</em> recibe el objeto con las cadenas de caracteres originales y a través de un patrón de texto se hace la búsqueda de las coincidencias. Es posible incluir más de 1 patrón y asignar el nuevo texto que sustituirá al anterior para cada uno de los patrones definidos. La función <em>str_replace()</em> hará la sustitución de un solo patrón coincidente y la función <em>str_replace_all()</em> lo hará para todos los patrones definidos.</p>
<div class="sourceCode" id="cb368"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb368-1"><a href="tidyverse.html#cb368-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Ejemplos de cambio de códigos a palabras o invertido  </span></span>
<span id="cb368-2"><a href="tidyverse.html#cb368-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb368-3"><a href="tidyverse.html#cb368-3" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;1&quot;</span>,<span class="st">&quot;2&quot;</span>,<span class="st">&quot;1&quot;</span>,<span class="st">&quot;2&quot;</span>,<span class="st">&quot;1&quot;</span>,<span class="st">&quot;2&quot;</span>,<span class="st">&quot;1&quot;</span>,<span class="st">&quot;2&quot;</span>,<span class="st">&quot;1&quot;</span>,<span class="st">&quot;2&quot;</span>)</span>
<span id="cb368-4"><a href="tidyverse.html#cb368-4" aria-hidden="true" tabindex="-1"></a>x1 <span class="ot">&lt;-</span> <span class="fu">str_replace</span>(x, <span class="st">&quot;1&quot;</span>,<span class="st">&quot;Hombre&quot;</span>)</span>
<span id="cb368-5"><a href="tidyverse.html#cb368-5" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(x1)</span></code></pre></div>
<pre><code>##  [1] &quot;Hombre&quot; &quot;2&quot;      &quot;Hombre&quot; &quot;2&quot;      &quot;Hombre&quot; &quot;2&quot;      &quot;Hombre&quot; &quot;2&quot;     
##  [9] &quot;Hombre&quot; &quot;2&quot;</code></pre>
<div class="sourceCode" id="cb370"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb370-1"><a href="tidyverse.html#cb370-1" aria-hidden="true" tabindex="-1"></a>x2 <span class="ot">&lt;-</span> <span class="fu">str_replace</span>(x1, <span class="st">&quot;2&quot;</span>,<span class="st">&quot;Mujer&quot;</span>)</span>
<span id="cb370-2"><a href="tidyverse.html#cb370-2" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(x2)</span></code></pre></div>
<pre><code>##  [1] &quot;Hombre&quot; &quot;Mujer&quot;  &quot;Hombre&quot; &quot;Mujer&quot;  &quot;Hombre&quot; &quot;Mujer&quot;  &quot;Hombre&quot; &quot;Mujer&quot; 
##  [9] &quot;Hombre&quot; &quot;Mujer&quot;</code></pre>
<div class="sourceCode" id="cb372"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb372-1"><a href="tidyverse.html#cb372-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Es posible replicar el resultado en un solo paso mediante str_replace_all</span></span>
<span id="cb372-2"><a href="tidyverse.html#cb372-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb372-3"><a href="tidyverse.html#cb372-3" aria-hidden="true" tabindex="-1"></a><span class="fu">str_replace_all</span>(x, <span class="fu">c</span>(<span class="st">&quot;1&quot;</span> <span class="ot">=</span> <span class="st">&quot;Hombre&quot;</span>, <span class="st">&quot;2&quot;</span> <span class="ot">=</span> <span class="st">&quot;Mujer&quot;</span>))</span></code></pre></div>
<pre><code>##  [1] &quot;Hombre&quot; &quot;Mujer&quot;  &quot;Hombre&quot; &quot;Mujer&quot;  &quot;Hombre&quot; &quot;Mujer&quot;  &quot;Hombre&quot; &quot;Mujer&quot; 
##  [9] &quot;Hombre&quot; &quot;Mujer&quot;</code></pre>
</div>
<div id="divisiones-mediante-patrones" class="section level3 hasAnchor" number="3.4.10">
<h3><span class="header-section-number">3.4.10</span> Divisiones mediante patrones<a href="tidyverse.html#divisiones-mediante-patrones" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>La información se presenta en diferentes formatos todo el tiempo. A veces cada variable tiene su propia columna, pero a veces la información está mezclada y es necesario dividirla a fin de trabajar mejor con ella.</p>
<p>Un caso recurrente en donde se presenta esta operación es con las fechas. El formato de una fecha a menudo se presenta como dd/mm/aaaa. Bajo este formato se puede encontrar tres datos en uno solo (día, mes y año). Para dividirlo, se podría utilizar el caracter “/” como patrón de coincidencia que permita dividir los datos en tres columnas separadas. Se debe agregar el parámetro “<em>simplify = T</em>” para poder simplificar los resultados y visualizarlos en un objeto <em>data.frame()</em>. La manera de hacerlo es la siguiente:</p>
<p>Primero se genera un vector con fechas</p>
<div class="sourceCode" id="cb374"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb374-1"><a href="tidyverse.html#cb374-1" aria-hidden="true" tabindex="-1"></a>fechas <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;15/11/1991&quot;</span>,<span class="st">&quot;20/11/1981&quot;</span>,<span class="st">&quot;04/02/1966&quot;</span>,<span class="st">&quot;01/10/1958&quot;</span>,<span class="st">&quot;23/04/1992&quot;</span>);fechas</span></code></pre></div>
<pre><code>## [1] &quot;15/11/1991&quot; &quot;20/11/1981&quot; &quot;04/02/1966&quot; &quot;01/10/1958&quot; &quot;23/04/1992&quot;</code></pre>
<p>Ahora, se generan tres columnas, una para el campo “Día”, otra para el campo “Mes” y otra para “Año”</p>
<div class="sourceCode" id="cb376"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb376-1"><a href="tidyverse.html#cb376-1" aria-hidden="true" tabindex="-1"></a><span class="fu">str_split</span>(<span class="at">string =</span> fechas,<span class="at">pattern =</span> <span class="st">&quot;/&quot;</span>,<span class="at">n =</span> <span class="dv">3</span>, <span class="at">simplify =</span> T) <span class="sc">%&gt;%</span> </span>
<span id="cb376-2"><a href="tidyverse.html#cb376-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as_tibble</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb376-3"><a href="tidyverse.html#cb376-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="at">day =</span> V1, <span class="at">month =</span> V2, <span class="at">year =</span> V3)</span></code></pre></div>
<pre><code>## # A tibble: 5 × 3
##   day   month year 
##   &lt;chr&gt; &lt;chr&gt; &lt;chr&gt;
## 1 15    11    1991 
## 2 20    11    1981 
## 3 04    02    1966 
## 4 01    10    1958 
## 5 23    04    1992</code></pre>
</div>
<div id="localización-de-coincidencias" class="section level3 hasAnchor" number="3.4.11">
<h3><span class="header-section-number">3.4.11</span> Localización de coincidencias<a href="tidyverse.html#localización-de-coincidencias" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Para poder hacer operaciones con algunas cadenas de caracteres, en ocasiones es necesario proporcionar los índices que denotan el inicio y el término de algún patrón de caracteres. La función <em>str_locate()</em> devuelve dichos índices una vez que se le haya proporcionado como argumento el patrón coincidente y el vector de cadenas de texto.</p>
<div class="sourceCode" id="cb378"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb378-1"><a href="tidyverse.html#cb378-1" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;090020001-123&quot;</span>,<span class="st">&quot;090001-512&quot;</span>,<span class="st">&quot;09002-1236&quot;</span>,<span class="st">&quot;90020001-1237&quot;</span>,<span class="st">&quot;09001-123811&quot;</span>)</span>
<span id="cb378-2"><a href="tidyverse.html#cb378-2" aria-hidden="true" tabindex="-1"></a><span class="fu">str_locate</span>(x,<span class="st">&quot;-</span><span class="sc">\\</span><span class="st">d{2,}&quot;</span>)</span></code></pre></div>
<pre><code>##      start end
## [1,]    10  13
## [2,]     7  10
## [3,]     6  10
## [4,]     9  13
## [5,]     6  12</code></pre>
<p>El ejemplo anterior muestra la manera en la que se localizan los índices iniciales y finales de los caracteres posteriores al símbolo “-”, que cumplan con tener al menos 2 dígitos. Hay que tomar en cuenta que bajo esta forma de extraer los índices, la posición del caracter “-” está incluida y es ahí donde inicia el conteo.</p>
<p>Habiendo platicado de esto, podemos hablar de uno de los temas importantes en muchas ocasiones complejos de la manipulación de datos… las fechas.</p>
<p><img src="img/04-tidyverse/regexp.jpeg" width="700pt" style="display: block; margin: auto;" /></p>
</div>
</div>
<div id="manipulación-de-tiempo" class="section level2 hasAnchor" number="3.5">
<h2><span class="header-section-number">3.5</span> Manipulación de tiempo<a href="tidyverse.html#manipulación-de-tiempo" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p><img src="img/04-tidyverse/build_time.png" width="400pt" style="display: block; margin: auto;" /></p>
<div id="lectura-y-creación-de-datos-temporales" class="section level3 hasAnchor" number="3.5.1">
<h3><span class="header-section-number">3.5.1</span> Lectura y creación de datos temporales<a href="tidyverse.html#lectura-y-creación-de-datos-temporales" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Una de la tareas más comunes en el análisis de datos es la manipulación de fechas y horas. Existe una infinidad de situaciones en donde saber operar con esta clase de datos es vital para el análisis de datos general. El primer paso es lograr identificar una cadena de caracteres como un dato temporal. Veamos un primer ejemplo:</p>
<div class="sourceCode" id="cb380"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb380-1"><a href="tidyverse.html#cb380-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(lubridate)</span>
<span id="cb380-2"><a href="tidyverse.html#cb380-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb380-3"><a href="tidyverse.html#cb380-3" aria-hidden="true" tabindex="-1"></a>fechas <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;2018/09/11&quot;</span>, <span class="st">&quot;1992/04/23&quot;</span>, <span class="st">&quot;1966/02/04&quot;</span>, <span class="st">&quot;1958/10/01&quot;</span>, <span class="st">&quot;1991/11/15&quot;</span>)</span>
<span id="cb380-4"><a href="tidyverse.html#cb380-4" aria-hidden="true" tabindex="-1"></a><span class="fu">class</span>(fechas)</span></code></pre></div>
<pre><code>## [1] &quot;character&quot;</code></pre>
<div class="sourceCode" id="cb382"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb382-1"><a href="tidyverse.html#cb382-1" aria-hidden="true" tabindex="-1"></a><span class="fu">class</span>(<span class="fu">as_date</span>(fechas))</span></code></pre></div>
<pre><code>## [1] &quot;Date&quot;</code></pre>
<p>Como puede apreciarse, los elementos del vector ahora son de la clase “Date”. La función <em>as_date()</em> transforma caracteres a fechas. Otra forma de realizar la implementación de datos temporales es directamente la creación de datos temporales a través de las funciones <em>make_date()</em> y <em>make_datetime()</em>. Esta función recibe los parámetros de cada unidad temporal y crea el dato adecuado para representarlo, ya sea <em>date</em> o <em>datetime</em>.</p>
<div class="sourceCode" id="cb384"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb384-1"><a href="tidyverse.html#cb384-1" aria-hidden="true" tabindex="-1"></a><span class="fu">make_date</span>(<span class="at">year =</span> <span class="dv">1999</span>, <span class="at">month =</span> <span class="dv">06</span>, <span class="at">day =</span> <span class="dv">16</span>)</span></code></pre></div>
<pre><code>## [1] &quot;1999-06-16&quot;</code></pre>
<div class="sourceCode" id="cb386"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb386-1"><a href="tidyverse.html#cb386-1" aria-hidden="true" tabindex="-1"></a><span class="fu">make_datetime</span>(<span class="at">year =</span> <span class="dv">1999</span><span class="sc">:</span><span class="dv">2001</span>, <span class="at">month =</span> <span class="dv">06</span>, <span class="at">day =</span> <span class="dv">16</span>, <span class="at">hour =</span> <span class="dv">10</span><span class="sc">:</span><span class="dv">12</span>, <span class="at">min =</span> <span class="dv">37</span>, <span class="at">sec =</span> <span class="dv">15</span>)</span></code></pre></div>
<pre><code>## [1] &quot;1999-06-16 10:37:15 UTC&quot; &quot;2000-06-16 11:37:15 UTC&quot;
## [3] &quot;2001-06-16 12:37:15 UTC&quot;</code></pre>
<p>El segundo ejemplo muestra la capacidad de estas funciones para crear una secuencia de fechas a partir de vectores de cada posible unidad temporal (día, mes año, hora, etc)</p>
<p>Algo que puede apreciarse en los ejemplos anteriores y que es necesario mencionar, es que el formato universal de fecha se escribe: <strong>yyyy/mm/dd</strong>. En países como USA el formato es <strong>mm/dd/yyyy</strong> y en México y otras partes del mundo puede escribirse comúnmente <strong>dd/mm/yyyy</strong>. Este tipo de diferencia a veces puede llegar a generar confusión sobre la fecha exacta en cuestión, más aún si se abrevia el año a dos caracteres <strong>yy</strong>.</p>
<p>La librería <strong>lubridate</strong> ofrece funciones para lidiar con el formato de lectura. Estas funciones son:</p>
<ul>
<li><p>dmy / dmy_h / dmy_hm / dmy_hms</p></li>
<li><p>mdy / mdy_h / mdy_hm / mdy_hms</p></li>
<li><p>ymd / ymd_h / ymd_hm / ymd_hms</p></li>
<li><p>hm / hms</p></li>
</ul>
<p>Con todas las funciones mencionadas anteriormente se puede leer cualquier cadena de caracteres que contenga el formato especificado. A continuación, un ejemplo:</p>
<div class="sourceCode" id="cb388"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb388-1"><a href="tidyverse.html#cb388-1" aria-hidden="true" tabindex="-1"></a><span class="fu">mdy</span>(<span class="st">&quot;11/25/1982&quot;</span>)</span></code></pre></div>
<pre><code>## [1] &quot;1982-11-25&quot;</code></pre>
<p>Automáticamente cualquiera de las funciones antes mencionadas transforma el formato específico al formato universal.</p>
</div>
<div id="extracción-de-datos-temporales" class="section level3 hasAnchor" number="3.5.2">
<h3><span class="header-section-number">3.5.2</span> Extracción de datos temporales<a href="tidyverse.html#extracción-de-datos-temporales" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Una vez que los datos temporales ya se encuentran creados, es importante saber la manera de extraer información particular de nuestro interés. En esta sección se revisará la manera de extraer cualquier unidad temporal a partir de una cadena completa de caracteres. a través de lubridate, las funciones para extracción de sub-unidades temporales son intuitivas.</p>
<div class="sourceCode" id="cb390"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb390-1"><a href="tidyverse.html#cb390-1" aria-hidden="true" tabindex="-1"></a>tiempo <span class="ot">&lt;-</span> <span class="fu">make_datetime</span>(<span class="at">year =</span> <span class="dv">2004</span>, <span class="at">month =</span> <span class="dv">9</span>, <span class="at">day =</span> <span class="dv">25</span>, <span class="at">hour =</span> <span class="dv">11</span>, <span class="at">min =</span> <span class="dv">30</span>, <span class="at">sec =</span> <span class="dv">1</span>)</span>
<span id="cb390-2"><a href="tidyverse.html#cb390-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb390-3"><a href="tidyverse.html#cb390-3" aria-hidden="true" tabindex="-1"></a><span class="fu">year</span>(tiempo)</span></code></pre></div>
<pre><code>## [1] 2004</code></pre>
<div class="sourceCode" id="cb392"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb392-1"><a href="tidyverse.html#cb392-1" aria-hidden="true" tabindex="-1"></a><span class="fu">month</span>(tiempo)</span></code></pre></div>
<pre><code>## [1] 9</code></pre>
<div class="sourceCode" id="cb394"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb394-1"><a href="tidyverse.html#cb394-1" aria-hidden="true" tabindex="-1"></a><span class="fu">month</span>(tiempo, <span class="at">label =</span> T, <span class="at">abbr =</span> F)</span></code></pre></div>
<pre><code>## [1] septiembre
## 12 Levels: enero &lt; febrero &lt; marzo &lt; abril &lt; mayo &lt; junio &lt; ... &lt; diciembre</code></pre>
<div class="sourceCode" id="cb396"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb396-1"><a href="tidyverse.html#cb396-1" aria-hidden="true" tabindex="-1"></a><span class="fu">day</span>(tiempo)</span></code></pre></div>
<pre><code>## [1] 25</code></pre>
<div class="sourceCode" id="cb398"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb398-1"><a href="tidyverse.html#cb398-1" aria-hidden="true" tabindex="-1"></a><span class="fu">hour</span>(tiempo)</span></code></pre></div>
<pre><code>## [1] 11</code></pre>
<div class="sourceCode" id="cb400"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb400-1"><a href="tidyverse.html#cb400-1" aria-hidden="true" tabindex="-1"></a><span class="fu">minute</span>(tiempo)</span></code></pre></div>
<pre><code>## [1] 30</code></pre>
<div class="sourceCode" id="cb402"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb402-1"><a href="tidyverse.html#cb402-1" aria-hidden="true" tabindex="-1"></a><span class="fu">second</span>(tiempo)</span></code></pre></div>
<pre><code>## [1] 1</code></pre>
<p>Después de las unidades temporales básicas, es posible también extraer día de la semana o día del mes, si es de interés.</p>
<div class="sourceCode" id="cb404"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb404-1"><a href="tidyverse.html#cb404-1" aria-hidden="true" tabindex="-1"></a><span class="fu">wday</span>(tiempo)</span></code></pre></div>
<pre><code>## [1] 7</code></pre>
<div class="sourceCode" id="cb406"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb406-1"><a href="tidyverse.html#cb406-1" aria-hidden="true" tabindex="-1"></a><span class="fu">wday</span>(tiempo, <span class="at">label =</span> T, <span class="at">abbr =</span> F)</span></code></pre></div>
<pre><code>## [1] sábado
## 7 Levels: domingo &lt; lunes &lt; martes &lt; miércoles &lt; jueves &lt; ... &lt; sábado</code></pre>
<div class="sourceCode" id="cb408"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb408-1"><a href="tidyverse.html#cb408-1" aria-hidden="true" tabindex="-1"></a><span class="fu">mday</span>(tiempo)</span></code></pre></div>
<pre><code>## [1] 25</code></pre>
<div class="sourceCode" id="cb410"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb410-1"><a href="tidyverse.html#cb410-1" aria-hidden="true" tabindex="-1"></a><span class="fu">yday</span>(tiempo)</span></code></pre></div>
<pre><code>## [1] 269</code></pre>
</div>
<div id="operaciones-temporales" class="section level3 hasAnchor" number="3.5.3">
<h3><span class="header-section-number">3.5.3</span> Operaciones temporales<a href="tidyverse.html#operaciones-temporales" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Las operaciones aritméticas entre datos temporales es cotidiano en todo momento cuando se analizan datos. Operaciones de sumas y restas de fechas y horas que permiten conocer la longitud de tiempo en dos momentos es una tarea que puede resolverse a través de los operadores aritméticos y lógicos.</p>
<p>Resta entre fechas</p>
<div class="sourceCode" id="cb412"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb412-1"><a href="tidyverse.html#cb412-1" aria-hidden="true" tabindex="-1"></a><span class="fu">as_date</span>(<span class="st">&quot;1991/11/15&quot;</span>) <span class="sc">-</span> <span class="fu">as_date</span>(<span class="st">&quot;1992/04/23&quot;</span>)</span></code></pre></div>
<pre><code>## Time difference of -160 days</code></pre>
<div class="sourceCode" id="cb414"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb414-1"><a href="tidyverse.html#cb414-1" aria-hidden="true" tabindex="-1"></a><span class="fu">as_date</span>(<span class="st">&quot;1992/04/23&quot;</span>) <span class="sc">-</span> <span class="fu">as_date</span>(<span class="st">&quot;1991/11/15&quot;</span>)</span></code></pre></div>
<pre><code>## Time difference of 160 days</code></pre>
<p>Suma y resta de días</p>
<div class="sourceCode" id="cb416"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb416-1"><a href="tidyverse.html#cb416-1" aria-hidden="true" tabindex="-1"></a><span class="fu">as_date</span>(<span class="st">&quot;1991/11/15&quot;</span>) <span class="sc">+</span> <span class="dv">365</span></span></code></pre></div>
<pre><code>## [1] &quot;1992-11-14&quot;</code></pre>
<p>Operadores lógicos</p>
<div class="sourceCode" id="cb418"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb418-1"><a href="tidyverse.html#cb418-1" aria-hidden="true" tabindex="-1"></a><span class="fu">as_date</span>(<span class="st">&quot;1992/04/23&quot;</span>) <span class="sc">&gt;</span> <span class="fu">as_date</span>(<span class="st">&quot;1991/11/15&quot;</span>)</span></code></pre></div>
<pre><code>## [1] TRUE</code></pre>
<div class="sourceCode" id="cb420"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb420-1"><a href="tidyverse.html#cb420-1" aria-hidden="true" tabindex="-1"></a><span class="fu">as_date</span>(<span class="st">&quot;1992/04/23&quot;</span>) <span class="sc">&lt;</span> <span class="fu">as_date</span>(<span class="st">&quot;1991/11/15&quot;</span>)</span></code></pre></div>
<pre><code>## [1] FALSE</code></pre>
<p>Cada una de las operaciones vistas en este capítulo son compatibles con dplyr y el resto de las librerías tidyverse.</p>
</div>
</div>
<div id="iteraciones" class="section level2 hasAnchor" number="3.6">
<h2><span class="header-section-number">3.6</span> Iteraciones<a href="tidyverse.html#iteraciones" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Los procesos en <em>R</em> muchas veces son iterativos en distintas partes del desarrollo de una solución. Existe una librería que facilita el entendimiento, orden, legibilidad y limpieza a la orden de iterar. La librería lleva por nombre <em>purrr</em>. Purrr presenta funciones de mapeo, así como algunas funciones nuevas para manipular listas.</p>
<p>Mientras que el caballo de batalla de <em>dplyr</em> es el marco de datos (data.frame / tibble), el caballo de batalla de purrr es la lista.</p>
<ul>
<li><p>Recordemos que un vector es una forma de almacenar muchos elementos individuales (un solo número o un solo carácter o cadena) del mismo tipo en un solo objeto.</p></li>
<li><p>Un marco de datos (data.frame / tibble) es una forma de almacenar muchos vectores de la misma longitud pero posiblemente de diferentes tipos juntos en un solo objeto.</p></li>
<li><p>Una lista es una forma de almacenar muchos objetos de cualquier tipo (por ejemplo, marcos de datos, diagramas, vectores) juntos en un solo objeto.</p></li>
</ul>
<p>Aquí hay un ejemplo de una lista que tiene tres elementos: un solo número, un vector y un marco de datos</p>
<div class="sourceCode" id="cb422"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb422-1"><a href="tidyverse.html#cb422-1" aria-hidden="true" tabindex="-1"></a>mi_2da_lista <span class="ot">&lt;-</span> <span class="fu">list</span>(</span>
<span id="cb422-2"><a href="tidyverse.html#cb422-2" aria-hidden="true" tabindex="-1"></a> <span class="at">my_number =</span> <span class="dv">5</span>,</span>
<span id="cb422-3"><a href="tidyverse.html#cb422-3" aria-hidden="true" tabindex="-1"></a> <span class="at">my_vector =</span> <span class="fu">c</span>(<span class="st">&quot;a&quot;</span>, <span class="st">&quot;b&quot;</span>, <span class="st">&quot;c&quot;</span>),</span>
<span id="cb422-4"><a href="tidyverse.html#cb422-4" aria-hidden="true" tabindex="-1"></a> <span class="at">my_dataframe =</span> <span class="fu">data.frame</span>(</span>
<span id="cb422-5"><a href="tidyverse.html#cb422-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">a =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>, <span class="at">b =</span> <span class="fu">c</span>(<span class="st">&quot;q&quot;</span>, <span class="st">&quot;b&quot;</span>, <span class="st">&quot;z&quot;</span>), </span>
<span id="cb422-6"><a href="tidyverse.html#cb422-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">c =</span> <span class="fu">c</span>(<span class="st">&quot;bananas&quot;</span>, <span class="st">&quot;are&quot;</span>, <span class="st">&quot;so very great&quot;</span>))</span>
<span id="cb422-7"><a href="tidyverse.html#cb422-7" aria-hidden="true" tabindex="-1"></a> )</span>
<span id="cb422-8"><a href="tidyverse.html#cb422-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb422-9"><a href="tidyverse.html#cb422-9" aria-hidden="true" tabindex="-1"></a>mi_2da_lista</span></code></pre></div>
<pre><code>## $my_number
## [1] 5
## 
## $my_vector
## [1] &quot;a&quot; &quot;b&quot; &quot;c&quot;
## 
## $my_dataframe
##   a b             c
## 1 1 q       bananas
## 2 2 b           are
## 3 3 z so very great</code></pre>
<p><em>Un marco de datos es en realidad un caso especial de una lista donde cada elemento de la lista es un vector de la misma longitud.</em></p>
<p>Una función de mapeo es aquella que <strong>aplica la misma acción/función a cada elemento</strong> de un objeto (por ejemplo, cada entrada de una lista o un vector, o cada una de las columnas de un marco de datos).</p>
<div class="infobox tip">
<p><strong>¡¡ RECORDAR !!</strong></p>
<p>La funciones que serán revisadas son súper útiles para realizar una acción de forma iterativa en las entradas de un vector o lista sin tener que escribir un bucle <em>for</em>.</p>
</div>
<p>La convención de nomenclatura de las funciones de mapeo es tal que el tipo de salida se especifica mediante el término que sigue al guión bajo en el nombre de la función.</p>
<ul>
<li><p>map(.x, .f) Es la función principal y regresa una lista</p></li>
<li><p>map_df(.x, .f) regresa un data frame</p></li>
<li><p>map_dbl(.x, .f) regresa un vector numérico (double)</p></li>
<li><p>map_chr(.x, .f) regresa un vector de caracter</p></li>
<li><p>map_lgl(.x, .f) regresa un vector lógico</p></li>
</ul>
<p>De acuerdo con la forma del tidyverse, el primer argumento de cada función de mapeo es siempre el objeto de datos sobre el que desea mapear, y <strong>el segundo argumento es siempre la función que desea aplicar iterativamente a cada elemento del objeto de entrada.</strong></p>
<div id="bucles-1" class="section level3 hasAnchor" number="3.6.1">
<h3><span class="header-section-number">3.6.1</span> Bucles<a href="tidyverse.html#bucles-1" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Fundamentalmente, los mapeos son para iteraciones. En el ejemplo de abajo, se iterará sobre el vector 1, 4, 7 añadiendo el valor 10 a cada entrada del vector a través de una función llamada <em>addTen()</em>. Esta función será aplicada a cada número único, el cual llamaremos “.x”.</p>
<div class="sourceCode" id="cb424"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb424-1"><a href="tidyverse.html#cb424-1" aria-hidden="true" tabindex="-1"></a>addTen <span class="ot">&lt;-</span> <span class="cf">function</span>(.x) {</span>
<span id="cb424-2"><a href="tidyverse.html#cb424-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(.x <span class="sc">+</span> <span class="dv">10</span>)</span>
<span id="cb424-3"><a href="tidyverse.html#cb424-3" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<p>La función <em>map()</em> de abajo, itera sobre todos los enteros aplicando la función <em>addTen()</em> a los elementos del vector y regresa la salida como una lista.</p>
<div class="sourceCode" id="cb425"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb425-1"><a href="tidyverse.html#cb425-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(purrr)</span>
<span id="cb425-2"><a href="tidyverse.html#cb425-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb425-3"><a href="tidyverse.html#cb425-3" aria-hidden="true" tabindex="-1"></a><span class="fu">map</span>(</span>
<span id="cb425-4"><a href="tidyverse.html#cb425-4" aria-hidden="true" tabindex="-1"></a> <span class="at">.x =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">4</span>, <span class="dv">7</span>), </span>
<span id="cb425-5"><a href="tidyverse.html#cb425-5" aria-hidden="true" tabindex="-1"></a> <span class="at">.f =</span> addTen</span>
<span id="cb425-6"><a href="tidyverse.html#cb425-6" aria-hidden="true" tabindex="-1"></a> )</span></code></pre></div>
<pre><code>## [[1]]
## [1] 11
## 
## [[2]]
## [1] 14
## 
## [[3]]
## [1] 17</code></pre>
<p>Hay que notar en los siguientes ejemplos que el mecanismo es funcional independientemente de si se trata de una lista o un marco de datos:</p>
<div class="sourceCode" id="cb427"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb427-1"><a href="tidyverse.html#cb427-1" aria-hidden="true" tabindex="-1"></a><span class="fu">map</span>(<span class="fu">list</span>(<span class="dv">1</span>, <span class="dv">4</span>, <span class="dv">7</span>), addTen)</span></code></pre></div>
<pre><code>## [[1]]
## [1] 11
## 
## [[2]]
## [1] 14
## 
## [[3]]
## [1] 17</code></pre>
<div class="sourceCode" id="cb429"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb429-1"><a href="tidyverse.html#cb429-1" aria-hidden="true" tabindex="-1"></a><span class="fu">map</span>(<span class="fu">data.frame</span>(<span class="at">a =</span> <span class="dv">1</span>, <span class="at">b =</span> <span class="dv">4</span>, <span class="at">c =</span> <span class="dv">7</span>), addTen)</span></code></pre></div>
<pre><code>## $a
## [1] 11
## 
## $b
## [1] 14
## 
## $c
## [1] 17</code></pre>
<p>la estructura resultante por default es una lista, no obstante, es posible especificar el tipo de salida deseado. Por ejemplo, para mapear el resultado de una iteración en un vector ‘<em>double</em>’, puede implementarse la función <em>map_dbl()</em>, la cual mapea a un vector double:</p>
<div class="sourceCode" id="cb431"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb431-1"><a href="tidyverse.html#cb431-1" aria-hidden="true" tabindex="-1"></a><span class="fu">map_dbl</span>(<span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">4</span>, <span class="dv">7</span>), addTen)</span></code></pre></div>
<pre><code>## [1] 11 14 17</code></pre>
<p>Para mapear a un vector de clase ‘caracter’, puede implementarse la función <em>map_chr()</em>:</p>
<div class="sourceCode" id="cb433"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb433-1"><a href="tidyverse.html#cb433-1" aria-hidden="true" tabindex="-1"></a><span class="fu">map_chr</span>(<span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">4</span>, <span class="dv">7</span>), addTen)</span></code></pre></div>
<pre><code>## [1] &quot;11.000000&quot; &quot;14.000000&quot; &quot;17.000000&quot;</code></pre>
<p>Incluso puede realizarse este mismo proceso iterativo en búsqueda de obtener como resultado un data frame:</p>
<div class="sourceCode" id="cb435"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb435-1"><a href="tidyverse.html#cb435-1" aria-hidden="true" tabindex="-1"></a><span class="fu">map_df</span>(<span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">4</span>, <span class="dv">7</span>), <span class="cf">function</span>(.x) {</span>
<span id="cb435-2"><a href="tidyverse.html#cb435-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(<span class="fu">data.frame</span>(<span class="at">old_number =</span> .x, </span>
<span id="cb435-3"><a href="tidyverse.html#cb435-3" aria-hidden="true" tabindex="-1"></a>                    <span class="at">new_number =</span> <span class="fu">addTen</span>(.x)))</span>
<span id="cb435-4"><a href="tidyverse.html#cb435-4" aria-hidden="true" tabindex="-1"></a>})</span></code></pre></div>
<pre><code>##   old_number new_number
## 1          1         11
## 2          4         14
## 3          7         17</code></pre>
</div>
<div id="bucles-dobles" class="section level3 hasAnchor" number="3.6.2">
<h3><span class="header-section-number">3.6.2</span> Bucles dobles<a href="tidyverse.html#bucles-dobles" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>En caso de haber dominado el uso del bucle mediante la función <em>map()</em>, es posible proceder a intentar iterar sobre dos objetos. El código de abajo una las funciones de mapeo para crear una lista de gráficos para comparar la esperanza de vida y el ingreso per cápita en cada combinación de continente y país.</p>
<p>La función de mapeo que itera sobre dos objetos en vez de uno, es llamada <em>map2()</em>. Los primeros dos argumentos son los dos objetos sobre los cuales se realiza la iteración y el tercero es la función con 2 argumentos (uno por cada objeto).</p>
<div class="sourceCode" id="cb437"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb437-1"><a href="tidyverse.html#cb437-1" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">list</span>(<span class="dv">1</span>, <span class="dv">5</span>, <span class="dv">15</span>)</span>
<span id="cb437-2"><a href="tidyverse.html#cb437-2" aria-hidden="true" tabindex="-1"></a>y <span class="ot">&lt;-</span> <span class="fu">list</span>(<span class="dv">10</span>, <span class="dv">20</span>, <span class="dv">30</span>)</span>
<span id="cb437-3"><a href="tidyverse.html#cb437-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb437-4"><a href="tidyverse.html#cb437-4" aria-hidden="true" tabindex="-1"></a><span class="fu">map2</span>(x, y, <span class="sc">~</span> .x <span class="sc">+</span> .y)</span></code></pre></div>
<pre><code>## [[1]]
## [1] 11
## 
## [[2]]
## [1] 25
## 
## [[3]]
## [1] 45</code></pre>
<div class="sourceCode" id="cb439"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb439-1"><a href="tidyverse.html#cb439-1" aria-hidden="true" tabindex="-1"></a><span class="fu">map2_dbl</span>(x, y, <span class="sc">~</span> .x <span class="sc">+</span> .y)</span></code></pre></div>
<pre><code>## [1] 11 25 45</code></pre>
<div class="sourceCode" id="cb441"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb441-1"><a href="tidyverse.html#cb441-1" aria-hidden="true" tabindex="-1"></a><span class="fu">map2_chr</span>(x, y, <span class="sc">~</span> .x <span class="sc">+</span> .y)</span></code></pre></div>
<pre><code>## [1] &quot;11.000000&quot; &quot;25.000000&quot; &quot;45.000000&quot;</code></pre>
<p>Otro ejemplo:</p>
<div class="sourceCode" id="cb443"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb443-1"><a href="tidyverse.html#cb443-1" aria-hidden="true" tabindex="-1"></a>df <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb443-2"><a href="tidyverse.html#cb443-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">x =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">5</span>),</span>
<span id="cb443-3"><a href="tidyverse.html#cb443-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">y =</span> <span class="fu">c</span>(<span class="dv">5</span>, <span class="dv">4</span>, <span class="dv">8</span>)</span>
<span id="cb443-4"><a href="tidyverse.html#cb443-4" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb443-5"><a href="tidyverse.html#cb443-5" aria-hidden="true" tabindex="-1"></a>df</span></code></pre></div>
<pre><code>##   x y
## 1 1 5
## 2 2 4
## 3 5 8</code></pre>
<div class="sourceCode" id="cb445"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb445-1"><a href="tidyverse.html#cb445-1" aria-hidden="true" tabindex="-1"></a><span class="fu">map2_dbl</span>(df<span class="sc">$</span>x, df<span class="sc">$</span>y, min)</span></code></pre></div>
<pre><code>## [1] 1 2 5</code></pre>

<div class="watermark">
<p><img src="img/header.png" width="400"/></p>
</div>
</div>
</div>
</div>
<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
<script>

$('.pipehover_incremental tr').hover(function() {
  $(this).removeClass()
  $(this).prevAll().removeClass()
  $(this).nextAll().removeClass()
  $(this).addClass('hover');
  $(this).prevAll().addClass('hover');
  $(this).closest('div').next().find('img').attr("src", $(this).attr("link"));
});


$('.pipehover_select_one_row tr').hover(function() {
  $(this).removeClass()
  $(this).prevAll().removeClass()
  $(this).nextAll().removeClass()
  $(this).addClass('hover');
  $(this).closest('div').next().find('img').attr("src", $(this).attr("link"));
});

</script>
            </section>

          </div>
        </div>
      </div>
<a href="introducción-a-r.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="visualización.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["amt22_aserta_intro2dsml.pdf"],
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
