<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Capítulo 10 Regularización Elasticnet | Ciencia de Datos y Machine Learning</title>
  <meta name="description" content="Capítulo 10 Regularización Elasticnet | Ciencia de Datos y Machine Learning" />
  <meta name="generator" content="bookdown 0.29 and GitBook 2.6.7" />

  <meta property="og:title" content="Capítulo 10 Regularización Elasticnet | Ciencia de Datos y Machine Learning" />
  <meta property="og:type" content="book" />
  
  <meta property="og:description" content="Capítulo 10 Regularización Elasticnet | Ciencia de Datos y Machine Learning" />
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Capítulo 10 Regularización Elasticnet | Ciencia de Datos y Machine Learning" />
  
  <meta name="twitter:description" content="Capítulo 10 Regularización Elasticnet | Ciencia de Datos y Machine Learning" />
  




  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="árboles-de-decisión.html"/>
<link rel="next" href="workflowsets-stacking.html"/>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>
<script src="libs/htmlwidgets-1.5.4/htmlwidgets.js"></script>
<link href="libs/str_view-0.1.0/str_view.css" rel="stylesheet" />
<script src="libs/str_view-binding-1.4.1/str_view.js"></script>
<script src="libs/plotly-binding-4.10.0/plotly.js"></script>
<script src="libs/typedarray-0.1/typedarray.min.js"></script>
<link href="libs/crosstalk-1.2.0/css/crosstalk.min.css" rel="stylesheet" />
<script src="libs/crosstalk-1.2.0/js/crosstalk.min.js"></script>
<link href="libs/plotly-htmlwidgets-css-2.5.1/plotly-htmlwidgets.css" rel="stylesheet" />
<script src="libs/plotly-main-2.5.1/plotly-latest.min.js"></script>
<script src="libs/kePrint-0.0.1/kePrint.js"></script>
<link href="libs/lightable-0.0.1/lightable.css" rel="stylesheet" />


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./"><img src="img/aserta-logo.png" width="280"></a></li|
|:-:|  
<center>Ciencia de Datos y Machine Learning</center>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>BIENVENIDA</a>
<ul>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#objetivo"><i class="fa fa-check"></i>Objetivo</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#alcances-del-curso"><i class="fa fa-check"></i>Alcances del curso</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#instructores"><i class="fa fa-check"></i>Instructores</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#temario"><i class="fa fa-check"></i>Temario</a>
<ul>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#módulo-1-introducción-a-r-22-hrs"><i class="fa fa-check"></i>Módulo 1: Introducción a R (22 hrs)</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#módulo-2-introducción-a-ciencia-de-datos-18-hrs"><i class="fa fa-check"></i>Módulo 2: Introducción a Ciencia de Datos (18 hrs)</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#módulo-3-machine-learning-supervisado-38-hrs"><i class="fa fa-check"></i>Módulo 3: Machine Learning: Supervisado (38 hrs)</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#módulo-4-machine-learning-no-supervisado-12-hrs"><i class="fa fa-check"></i>Módulo 4: Machine Learning: No Supervisado (12 hrs)</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#requisitos"><i class="fa fa-check"></i>Requisitos</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#duración-y-evaluación-del-curso"><i class="fa fa-check"></i>Duración y evaluación del curso</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#recursos-y-dinámica-de-clase"><i class="fa fa-check"></i>Recursos y dinámica de clase</a></li>
</ul></li>
<li class="part"><span><b>Parte 1: Introducción</b></span></li>
<li class="chapter" data-level="1" data-path="conceptos-de-ciencia-de-datos.html"><a href="conceptos-de-ciencia-de-datos.html"><i class="fa fa-check"></i><b>1</b> Conceptos de Ciencia de Datos</a>
<ul>
<li class="chapter" data-level="1.1" data-path="conceptos-de-ciencia-de-datos.html"><a href="conceptos-de-ciencia-de-datos.html#qué-es-ciencia-de-datos"><i class="fa fa-check"></i><b>1.1</b> ¿Qué es Ciencia de Datos?</a>
<ul>
<li class="chapter" data-level="" data-path="conceptos-de-ciencia-de-datos.html"><a href="conceptos-de-ciencia-de-datos.html#definiendo-conceptos"><i class="fa fa-check"></i>Definiendo conceptos:</a></li>
</ul></li>
<li class="chapter" data-level="1.2" data-path="conceptos-de-ciencia-de-datos.html"><a href="conceptos-de-ciencia-de-datos.html#objetivos"><i class="fa fa-check"></i><b>1.2</b> Objetivos</a></li>
<li class="chapter" data-level="1.3" data-path="conceptos-de-ciencia-de-datos.html"><a href="conceptos-de-ciencia-de-datos.html#requisitos-1"><i class="fa fa-check"></i><b>1.3</b> Requisitos</a></li>
<li class="chapter" data-level="1.4" data-path="conceptos-de-ciencia-de-datos.html"><a href="conceptos-de-ciencia-de-datos.html#aplicaciones"><i class="fa fa-check"></i><b>1.4</b> Aplicaciones</a></li>
<li class="chapter" data-level="1.5" data-path="conceptos-de-ciencia-de-datos.html"><a href="conceptos-de-ciencia-de-datos.html#tipos-de-algoritmos"><i class="fa fa-check"></i><b>1.5</b> Tipos de algoritmos</a>
<ul>
<li class="chapter" data-level="1.5.1" data-path="conceptos-de-ciencia-de-datos.html"><a href="conceptos-de-ciencia-de-datos.html#aprendizaje-supervisado"><i class="fa fa-check"></i><b>1.5.1</b> Aprendizaje supervisado</a></li>
<li class="chapter" data-level="1.5.2" data-path="conceptos-de-ciencia-de-datos.html"><a href="conceptos-de-ciencia-de-datos.html#aprendizaje-no-supervisado"><i class="fa fa-check"></i><b>1.5.2</b> Aprendizaje no supervisado</a></li>
<li class="chapter" data-level="1.5.3" data-path="conceptos-de-ciencia-de-datos.html"><a href="conceptos-de-ciencia-de-datos.html#aprendizaje-por-refuerzo"><i class="fa fa-check"></i><b>1.5.3</b> Aprendizaje por refuerzo</a></li>
</ul></li>
<li class="chapter" data-level="1.6" data-path="conceptos-de-ciencia-de-datos.html"><a href="conceptos-de-ciencia-de-datos.html#perfiles-de-un-equipo"><i class="fa fa-check"></i><b>1.6</b> Perfiles de un equipo</a>
<ul>
<li class="chapter" data-level="" data-path="conceptos-de-ciencia-de-datos.html"><a href="conceptos-de-ciencia-de-datos.html#ingeniero-de-datos"><i class="fa fa-check"></i>1) Ingeniero de datos</a></li>
<li class="chapter" data-level="" data-path="conceptos-de-ciencia-de-datos.html"><a href="conceptos-de-ciencia-de-datos.html#decisor"><i class="fa fa-check"></i>2) Decisor</a></li>
<li class="chapter" data-level="" data-path="conceptos-de-ciencia-de-datos.html"><a href="conceptos-de-ciencia-de-datos.html#analista"><i class="fa fa-check"></i>3) Analista</a></li>
<li class="chapter" data-level="" data-path="conceptos-de-ciencia-de-datos.html"><a href="conceptos-de-ciencia-de-datos.html#analista-experto"><i class="fa fa-check"></i>4) Analista experto</a></li>
<li class="chapter" data-level="" data-path="conceptos-de-ciencia-de-datos.html"><a href="conceptos-de-ciencia-de-datos.html#estadístico"><i class="fa fa-check"></i>5) Estadístico</a></li>
<li class="chapter" data-level="" data-path="conceptos-de-ciencia-de-datos.html"><a href="conceptos-de-ciencia-de-datos.html#ingeniero-de-machine-learning"><i class="fa fa-check"></i>6) Ingeniero de Machine Learning</a></li>
<li class="chapter" data-level="" data-path="conceptos-de-ciencia-de-datos.html"><a href="conceptos-de-ciencia-de-datos.html#científico-de-datos"><i class="fa fa-check"></i>7) Científico de Datos</a></li>
<li class="chapter" data-level="" data-path="conceptos-de-ciencia-de-datos.html"><a href="conceptos-de-ciencia-de-datos.html#gerente-de-análisis-líder-de-ciencia-de-datos"><i class="fa fa-check"></i>8) Gerente de Análisis / Líder de Ciencia de Datos</a></li>
<li class="chapter" data-level="" data-path="conceptos-de-ciencia-de-datos.html"><a href="conceptos-de-ciencia-de-datos.html#experto-cualitativo-científico-social"><i class="fa fa-check"></i>9) Experto Cualitativo / Científico Social</a></li>
<li class="chapter" data-level="" data-path="conceptos-de-ciencia-de-datos.html"><a href="conceptos-de-ciencia-de-datos.html#investigador"><i class="fa fa-check"></i>10) Investigador</a></li>
<li class="chapter" data-level="" data-path="conceptos-de-ciencia-de-datos.html"><a href="conceptos-de-ciencia-de-datos.html#extra-personal-adicional"><i class="fa fa-check"></i>Extra) Personal Adicional</a></li>
<li class="chapter" data-level="" data-path="conceptos-de-ciencia-de-datos.html"><a href="conceptos-de-ciencia-de-datos.html#google-data-career-path"><i class="fa fa-check"></i>Google Data Career Path</a></li>
</ul></li>
<li class="chapter" data-level="1.7" data-path="conceptos-de-ciencia-de-datos.html"><a href="conceptos-de-ciencia-de-datos.html#flujo-de-trabajo-en-ml"><i class="fa fa-check"></i><b>1.7</b> Flujo de trabajo en <em>ML</em></a></li>
<li class="chapter" data-level="1.8" data-path="conceptos-de-ciencia-de-datos.html"><a href="conceptos-de-ciencia-de-datos.html#ciclo-de-un-proyecto"><i class="fa fa-check"></i><b>1.8</b> Ciclo de un proyecto</a></li>
<li class="chapter" data-level="1.9" data-path="conceptos-de-ciencia-de-datos.html"><a href="conceptos-de-ciencia-de-datos.html#taller-de-scoping"><i class="fa fa-check"></i><b>1.9</b> Taller de Scoping</a>
<ul>
<li class="chapter" data-level="1.9.1" data-path="conceptos-de-ciencia-de-datos.html"><a href="conceptos-de-ciencia-de-datos.html#data-maturity-framework"><i class="fa fa-check"></i><b>1.9.1</b> Data Maturity Framework</a></li>
<li class="chapter" data-level="1.9.2" data-path="conceptos-de-ciencia-de-datos.html"><a href="conceptos-de-ciencia-de-datos.html#scoping"><i class="fa fa-check"></i><b>1.9.2</b> Scoping</a></li>
<li class="chapter" data-level="" data-path="conceptos-de-ciencia-de-datos.html"><a href="conceptos-de-ciencia-de-datos.html#ejemplos"><i class="fa fa-check"></i>Ejemplos</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="2" data-path="introducción-a-r.html"><a href="introducción-a-r.html"><i class="fa fa-check"></i><b>2</b> Introducción a R</a>
<ul>
<li class="chapter" data-level="2.1" data-path="introducción-a-r.html"><a href="introducción-a-r.html#cómo-obtener-r"><i class="fa fa-check"></i><b>2.1</b> ¿Cómo obtener <em>R</em>?</a></li>
<li class="chapter" data-level="2.2" data-path="introducción-a-r.html"><a href="introducción-a-r.html#qué-es-rstudio"><i class="fa fa-check"></i><b>2.2</b> ¿Qué es RStudio?</a></li>
<li class="chapter" data-level="2.3" data-path="introducción-a-r.html"><a href="introducción-a-r.html#r-como-lenguaje-orientado-a-objetos"><i class="fa fa-check"></i><b>2.3</b> <em>R</em> como lenguaje orientado a objetos</a></li>
<li class="chapter" data-level="2.4" data-path="introducción-a-r.html"><a href="introducción-a-r.html#estructuras-de-almacenamiento"><i class="fa fa-check"></i><b>2.4</b> Estructuras de almacenamiento</a>
<ul>
<li class="chapter" data-level="2.4.1" data-path="introducción-a-r.html"><a href="introducción-a-r.html#operadores-de-asignación"><i class="fa fa-check"></i><b>2.4.1</b> Operadores de asignación</a></li>
<li class="chapter" data-level="2.4.2" data-path="introducción-a-r.html"><a href="introducción-a-r.html#variables"><i class="fa fa-check"></i><b>2.4.2</b> Variables</a></li>
<li class="chapter" data-level="2.4.3" data-path="introducción-a-r.html"><a href="introducción-a-r.html#vectores"><i class="fa fa-check"></i><b>2.4.3</b> Vectores</a></li>
<li class="chapter" data-level="2.4.4" data-path="introducción-a-r.html"><a href="introducción-a-r.html#matrices"><i class="fa fa-check"></i><b>2.4.4</b> Matrices</a></li>
<li class="chapter" data-level="2.4.5" data-path="introducción-a-r.html"><a href="introducción-a-r.html#arreglos"><i class="fa fa-check"></i><b>2.4.5</b> Arreglos</a></li>
<li class="chapter" data-level="2.4.6" data-path="introducción-a-r.html"><a href="introducción-a-r.html#data-frames"><i class="fa fa-check"></i><b>2.4.6</b> Data Frames</a></li>
<li class="chapter" data-level="2.4.7" data-path="introducción-a-r.html"><a href="introducción-a-r.html#listas"><i class="fa fa-check"></i><b>2.4.7</b> Listas</a></li>
<li class="chapter" data-level="2.4.8" data-path="introducción-a-r.html"><a href="introducción-a-r.html#ejercicios"><i class="fa fa-check"></i><b>2.4.8</b> Ejercicios</a></li>
</ul></li>
<li class="chapter" data-level="2.5" data-path="introducción-a-r.html"><a href="introducción-a-r.html#funbas"><i class="fa fa-check"></i><b>2.5</b> Funciones básicas de R</a>
<ul>
<li class="chapter" data-level="2.5.1" data-path="introducción-a-r.html"><a href="introducción-a-r.html#qué-es-una-función-de-r"><i class="fa fa-check"></i><b>2.5.1</b> ¿Qué es una función de R?</a></li>
<li class="chapter" data-level="2.5.2" data-path="introducción-a-r.html"><a href="introducción-a-r.html#operaciones-básicas"><i class="fa fa-check"></i><b>2.5.2</b> Operaciones básicas</a></li>
<li class="chapter" data-level="2.5.3" data-path="introducción-a-r.html"><a href="introducción-a-r.html#pruebas-lógicas"><i class="fa fa-check"></i><b>2.5.3</b> Pruebas lógicas</a></li>
<li class="chapter" data-level="2.5.4" data-path="introducción-a-r.html"><a href="introducción-a-r.html#operadores-lógicos"><i class="fa fa-check"></i><b>2.5.4</b> Operadores lógicos</a></li>
<li class="chapter" data-level="2.5.5" data-path="introducción-a-r.html"><a href="introducción-a-r.html#funciones-sobre-vectores"><i class="fa fa-check"></i><b>2.5.5</b> Funciones sobre vectores</a></li>
<li class="chapter" data-level="2.5.6" data-path="introducción-a-r.html"><a href="introducción-a-r.html#función-rep"><i class="fa fa-check"></i><b>2.5.6</b> Función <code>rep</code></a></li>
<li class="chapter" data-level="2.5.7" data-path="introducción-a-r.html"><a href="introducción-a-r.html#función-seq"><i class="fa fa-check"></i><b>2.5.7</b> Función <code>seq</code></a></li>
<li class="chapter" data-level="2.5.8" data-path="introducción-a-r.html"><a href="introducción-a-r.html#ejercicios-1"><i class="fa fa-check"></i><b>2.5.8</b> EJERCICIOS</a></li>
</ul></li>
<li class="chapter" data-level="2.6" data-path="introducción-a-r.html"><a href="introducción-a-r.html#bucles"><i class="fa fa-check"></i><b>2.6</b> Estructuras de control</a>
<ul>
<li class="chapter" data-level="2.6.1" data-path="introducción-a-r.html"><a href="introducción-a-r.html#instrucción-if"><i class="fa fa-check"></i><b>2.6.1</b> Instrucción <code>if</code></a></li>
<li class="chapter" data-level="2.6.2" data-path="introducción-a-r.html"><a href="introducción-a-r.html#instrucción-if-else"><i class="fa fa-check"></i><b>2.6.2</b> Instrucción <code>if</code> <code>else</code></a></li>
<li class="chapter" data-level="2.6.3" data-path="introducción-a-r.html"><a href="introducción-a-r.html#instrucción-ifelse"><i class="fa fa-check"></i><b>2.6.3</b> Instrucción <code>ifelse</code></a></li>
<li class="chapter" data-level="2.6.4" data-path="introducción-a-r.html"><a href="introducción-a-r.html#instrucción-else-if"><i class="fa fa-check"></i><b>2.6.4</b> Instrucción else if</a></li>
<li class="chapter" data-level="2.6.5" data-path="introducción-a-r.html"><a href="introducción-a-r.html#instrucción-for"><i class="fa fa-check"></i><b>2.6.5</b> Instrucción <code>for</code></a></li>
<li class="chapter" data-level="2.6.6" data-path="introducción-a-r.html"><a href="introducción-a-r.html#instrucción-while"><i class="fa fa-check"></i><b>2.6.6</b> Instrucción <code>while</code></a></li>
<li class="chapter" data-level="2.6.7" data-path="introducción-a-r.html"><a href="introducción-a-r.html#instrucción-repeat"><i class="fa fa-check"></i><b>2.6.7</b> Instrucción <code>repeat</code></a></li>
</ul></li>
<li class="chapter" data-level="2.7" data-path="introducción-a-r.html"><a href="introducción-a-r.html#estilo"><i class="fa fa-check"></i><b>2.7</b> Guía de estilo</a>
<ul>
<li class="chapter" data-level="2.7.1" data-path="introducción-a-r.html"><a href="introducción-a-r.html#nombres-de-los-archivos"><i class="fa fa-check"></i><b>2.7.1</b> Nombres de los archivos</a></li>
<li class="chapter" data-level="2.7.2" data-path="introducción-a-r.html"><a href="introducción-a-r.html#nombres-de-los-objetos"><i class="fa fa-check"></i><b>2.7.2</b> Nombres de los objetos</a></li>
<li class="chapter" data-level="2.7.3" data-path="introducción-a-r.html"><a href="introducción-a-r.html#longitud-de-una-línea-de-código"><i class="fa fa-check"></i><b>2.7.3</b> Longitud de una línea de código</a></li>
<li class="chapter" data-level="2.7.4" data-path="introducción-a-r.html"><a href="introducción-a-r.html#espacios"><i class="fa fa-check"></i><b>2.7.4</b> Espacios</a></li>
<li class="chapter" data-level="2.7.5" data-path="introducción-a-r.html"><a href="introducción-a-r.html#asignación"><i class="fa fa-check"></i><b>2.7.5</b> Asignación</a></li>
<li class="chapter" data-level="2.7.6" data-path="introducción-a-r.html"><a href="introducción-a-r.html#punto-y-coma"><i class="fa fa-check"></i><b>2.7.6</b> Punto y coma</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="3" data-path="tidyverse.html"><a href="tidyverse.html"><i class="fa fa-check"></i><b>3</b> Tidyverse</a>
<ul>
<li class="chapter" data-level="3.1" data-path="tidyverse.html"><a href="tidyverse.html#lectura-de-archivos"><i class="fa fa-check"></i><b>3.1</b> Lectura de archivos</a>
<ul>
<li class="chapter" data-level="3.1.1" data-path="tidyverse.html"><a href="tidyverse.html#archivos-csv"><i class="fa fa-check"></i><b>3.1.1</b> Archivos <em>csv</em></a></li>
<li class="chapter" data-level="3.1.2" data-path="tidyverse.html"><a href="tidyverse.html#archivos-txt"><i class="fa fa-check"></i><b>3.1.2</b> Archivos txt</a></li>
<li class="chapter" data-level="3.1.3" data-path="tidyverse.html"><a href="tidyverse.html#archivos-xls-y-xlsx"><i class="fa fa-check"></i><b>3.1.3</b> Archivos <em>xls</em> y <em>xlsx</em></a></li>
<li class="chapter" data-level="3.1.4" data-path="tidyverse.html"><a href="tidyverse.html#archivos-json"><i class="fa fa-check"></i><b>3.1.4</b> Archivos json</a></li>
<li class="chapter" data-level="3.1.5" data-path="tidyverse.html"><a href="tidyverse.html#archivos-rds"><i class="fa fa-check"></i><b>3.1.5</b> Archivos rds</a></li>
<li class="chapter" data-level="3.1.6" data-path="tidyverse.html"><a href="tidyverse.html#bases-de-datos"><i class="fa fa-check"></i><b>3.1.6</b> Bases de Datos</a></li>
<li class="chapter" data-level="3.1.7" data-path="tidyverse.html"><a href="tidyverse.html#oracle-database"><i class="fa fa-check"></i><b>3.1.7</b> Oracle Database</a></li>
</ul></li>
<li class="chapter" data-level="3.2" data-path="tidyverse.html"><a href="tidyverse.html#consultas-de-datos"><i class="fa fa-check"></i><b>3.2</b> Consultas de datos</a>
<ul>
<li class="chapter" data-level="3.2.1" data-path="tidyverse.html"><a href="tidyverse.html#seleccionar-columnas"><i class="fa fa-check"></i><b>3.2.1</b> Seleccionar columnas</a></li>
<li class="chapter" data-level="3.2.2" data-path="tidyverse.html"><a href="tidyverse.html#filtrar-observaciones"><i class="fa fa-check"></i><b>3.2.2</b> Filtrar observaciones</a></li>
<li class="chapter" data-level="3.2.3" data-path="tidyverse.html"><a href="tidyverse.html#ordenar-registros"><i class="fa fa-check"></i><b>3.2.3</b> Ordenar registros</a></li>
<li class="chapter" data-level="3.2.4" data-path="tidyverse.html"><a href="tidyverse.html#agregar-modificar"><i class="fa fa-check"></i><b>3.2.4</b> Agregar / Modificar</a></li>
<li class="chapter" data-level="3.2.5" data-path="tidyverse.html"><a href="tidyverse.html#resumen-estadístico"><i class="fa fa-check"></i><b>3.2.5</b> Resumen estadístico</a></li>
<li class="chapter" data-level="3.2.6" data-path="tidyverse.html"><a href="tidyverse.html#agrupamiento"><i class="fa fa-check"></i><b>3.2.6</b> Agrupamiento</a></li>
<li class="chapter" data-level="3.2.7" data-path="tidyverse.html"><a href="tidyverse.html#cruces-de-tablas"><i class="fa fa-check"></i><b>3.2.7</b> Cruces de tablas</a></li>
</ul></li>
<li class="chapter" data-level="3.3" data-path="tidyverse.html"><a href="tidyverse.html#orden-y-estructura"><i class="fa fa-check"></i><b>3.3</b> Orden y estructura</a>
<ul>
<li class="chapter" data-level="3.3.1" data-path="tidyverse.html"><a href="tidyverse.html#pivote-horizontal"><i class="fa fa-check"></i><b>3.3.1</b> Pivote horizontal</a></li>
<li class="chapter" data-level="3.3.2" data-path="tidyverse.html"><a href="tidyverse.html#pivote-vertical"><i class="fa fa-check"></i><b>3.3.2</b> Pivote vertical</a></li>
<li class="chapter" data-level="3.3.3" data-path="tidyverse.html"><a href="tidyverse.html#unión-de-columnas"><i class="fa fa-check"></i><b>3.3.3</b> Unión de columnas</a></li>
<li class="chapter" data-level="3.3.4" data-path="tidyverse.html"><a href="tidyverse.html#separador-de-columnas"><i class="fa fa-check"></i><b>3.3.4</b> Separador de columnas</a></li>
</ul></li>
<li class="chapter" data-level="3.4" data-path="tidyverse.html"><a href="tidyverse.html#manipulación-de-texto"><i class="fa fa-check"></i><b>3.4</b> Manipulación de texto</a>
<ul>
<li class="chapter" data-level="3.4.1" data-path="tidyverse.html"><a href="tidyverse.html#caracteres-especiales"><i class="fa fa-check"></i><b>3.4.1</b> Caracteres especiales</a></li>
<li class="chapter" data-level="3.4.2" data-path="tidyverse.html"><a href="tidyverse.html#tamaño-de-cadena"><i class="fa fa-check"></i><b>3.4.2</b> Tamaño de cadena</a></li>
<li class="chapter" data-level="3.4.3" data-path="tidyverse.html"><a href="tidyverse.html#concatenar"><i class="fa fa-check"></i><b>3.4.3</b> Concatenar</a></li>
<li class="chapter" data-level="3.4.4" data-path="tidyverse.html"><a href="tidyverse.html#extraer-y-reemplazar"><i class="fa fa-check"></i><b>3.4.4</b> Extraer y reemplazar</a></li>
<li class="chapter" data-level="3.4.5" data-path="tidyverse.html"><a href="tidyverse.html#expresiones-regulares"><i class="fa fa-check"></i><b>3.4.5</b> Expresiones regulares</a></li>
<li class="chapter" data-level="3.4.6" data-path="tidyverse.html"><a href="tidyverse.html#detectar-coincidencias"><i class="fa fa-check"></i><b>3.4.6</b> Detectar coincidencias</a></li>
<li class="chapter" data-level="3.4.7" data-path="tidyverse.html"><a href="tidyverse.html#contabilizar-coincidencias"><i class="fa fa-check"></i><b>3.4.7</b> Contabilizar coincidencias</a></li>
<li class="chapter" data-level="3.4.8" data-path="tidyverse.html"><a href="tidyverse.html#extraer-coincidencias"><i class="fa fa-check"></i><b>3.4.8</b> Extraer coincidencias</a></li>
<li class="chapter" data-level="3.4.9" data-path="tidyverse.html"><a href="tidyverse.html#reemplazar-coincidencias"><i class="fa fa-check"></i><b>3.4.9</b> Reemplazar coincidencias</a></li>
<li class="chapter" data-level="3.4.10" data-path="tidyverse.html"><a href="tidyverse.html#divisiones-mediante-patrones"><i class="fa fa-check"></i><b>3.4.10</b> Divisiones mediante patrones</a></li>
<li class="chapter" data-level="3.4.11" data-path="tidyverse.html"><a href="tidyverse.html#localización-de-coincidencias"><i class="fa fa-check"></i><b>3.4.11</b> Localización de coincidencias</a></li>
</ul></li>
<li class="chapter" data-level="3.5" data-path="tidyverse.html"><a href="tidyverse.html#manipulación-de-tiempo"><i class="fa fa-check"></i><b>3.5</b> Manipulación de tiempo</a>
<ul>
<li class="chapter" data-level="3.5.1" data-path="tidyverse.html"><a href="tidyverse.html#lectura-y-creación-de-datos-temporales"><i class="fa fa-check"></i><b>3.5.1</b> Lectura y creación de datos temporales</a></li>
<li class="chapter" data-level="3.5.2" data-path="tidyverse.html"><a href="tidyverse.html#extracción-de-datos-temporales"><i class="fa fa-check"></i><b>3.5.2</b> Extracción de datos temporales</a></li>
<li class="chapter" data-level="3.5.3" data-path="tidyverse.html"><a href="tidyverse.html#operaciones-temporales"><i class="fa fa-check"></i><b>3.5.3</b> Operaciones temporales</a></li>
</ul></li>
<li class="chapter" data-level="3.6" data-path="tidyverse.html"><a href="tidyverse.html#iteraciones"><i class="fa fa-check"></i><b>3.6</b> Iteraciones</a>
<ul>
<li class="chapter" data-level="3.6.1" data-path="tidyverse.html"><a href="tidyverse.html#bucles-1"><i class="fa fa-check"></i><b>3.6.1</b> Bucles</a></li>
<li class="chapter" data-level="3.6.2" data-path="tidyverse.html"><a href="tidyverse.html#bucles-dobles"><i class="fa fa-check"></i><b>3.6.2</b> Bucles dobles</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="4" data-path="visualización.html"><a href="visualización.html"><i class="fa fa-check"></i><b>4</b> Visualización</a>
<ul>
<li class="chapter" data-level="4.1" data-path="visualización.html"><a href="visualización.html#eda-análisis-exploratorio-de-datos"><i class="fa fa-check"></i><b>4.1</b> EDA: Análisis Exploratorio de Datos</a></li>
<li class="chapter" data-level="4.2" data-path="visualización.html"><a href="visualización.html#geda-análisis-exploratorio-de-datos-gráficos"><i class="fa fa-check"></i><b>4.2</b> GEDA: Análisis Exploratorio de Datos Gráficos</a>
<ul>
<li class="chapter" data-level="4.2.1" data-path="visualización.html"><a href="visualización.html#lo-que-no-se-debe-hacer"><i class="fa fa-check"></i><b>4.2.1</b> Lo que no se debe hacer…</a></li>
<li class="chapter" data-level="4.2.2" data-path="visualización.html"><a href="visualización.html#principios-de-visualización"><i class="fa fa-check"></i><b>4.2.2</b> Principios de visualización</a></li>
<li class="chapter" data-level="4.2.3" data-path="visualización.html"><a href="visualización.html#principios-generales-del-diseño-analítico"><i class="fa fa-check"></i><b>4.2.3</b> Principios generales del diseño analítico:</a></li>
<li class="chapter" data-level="4.2.4" data-path="visualización.html"><a href="visualización.html#técnicas-de-visualización"><i class="fa fa-check"></i><b>4.2.4</b> Técnicas de visualización:</a></li>
<li class="chapter" data-level="4.2.5" data-path="visualización.html"><a href="visualización.html#indicadores-de-calidad-gráfica"><i class="fa fa-check"></i><b>4.2.5</b> Indicadores de calidad gráfica:</a></li>
<li class="chapter" data-level="4.2.6" data-path="visualización.html"><a href="visualización.html#gráficos-univariados"><i class="fa fa-check"></i><b>4.2.6</b> Gráficos univariados:</a></li>
<li class="chapter" data-level="4.2.7" data-path="visualización.html"><a href="visualización.html#gráficos-multivariados"><i class="fa fa-check"></i><b>4.2.7</b> Gráficos multivariados</a></li>
</ul></li>
<li class="chapter" data-level="4.3" data-path="visualización.html"><a href="visualización.html#creación-de-gráficos"><i class="fa fa-check"></i><b>4.3</b> Creación de gráficos</a>
<ul>
<li class="chapter" data-level="4.3.1" data-path="visualización.html"><a href="visualización.html#estéticas"><i class="fa fa-check"></i><b>4.3.1</b> Estéticas</a></li>
<li class="chapter" data-level="4.3.2" data-path="visualización.html"><a href="visualización.html#objetos-geométricos-o-capas"><i class="fa fa-check"></i><b>4.3.2</b> Objetos geométricos o capas</a></li>
<li class="chapter" data-level="4.3.3" data-path="visualización.html"><a href="visualización.html#facetas"><i class="fa fa-check"></i><b>4.3.3</b> Facetas</a></li>
<li class="chapter" data-level="4.3.4" data-path="visualización.html"><a href="visualización.html#más-sobre-estéticas"><i class="fa fa-check"></i><b>4.3.4</b> Más sobre estéticas</a></li>
<li class="chapter" data-level="4.3.5" data-path="visualización.html"><a href="visualización.html#quick-view"><i class="fa fa-check"></i><b>4.3.5</b> Quick View</a></li>
</ul></li>
<li class="chapter" data-level="4.4" data-path="visualización.html"><a href="visualización.html#análisis-univariado"><i class="fa fa-check"></i><b>4.4</b> Análisis univariado</a>
<ul>
<li class="chapter" data-level="4.4.1" data-path="visualización.html"><a href="visualización.html#variables-numéricas"><i class="fa fa-check"></i><b>4.4.1</b> Variables numéricas</a></li>
<li class="chapter" data-level="4.4.2" data-path="visualización.html"><a href="visualización.html#variables-nominalescategóricas"><i class="fa fa-check"></i><b>4.4.2</b> Variables nominales/categóricas</a></li>
</ul></li>
<li class="chapter" data-level="4.5" data-path="visualización.html"><a href="visualización.html#análisis-multivariado"><i class="fa fa-check"></i><b>4.5</b> Análisis multivariado</a></li>
<li class="chapter" data-level="4.6" data-path="visualización.html"><a href="visualización.html#visualización-interactiva"><i class="fa fa-check"></i><b>4.6</b> Visualización interactiva</a>
<ul>
<li class="chapter" data-level="" data-path="visualización.html"><a href="visualización.html#warning"><i class="fa fa-check"></i>¡ Warning !</a></li>
</ul></li>
<li class="chapter" data-level="4.7" data-path="visualización.html"><a href="visualización.html#reporte-interactivos"><i class="fa fa-check"></i><b>4.7</b> Reporte interactivos</a></li>
</ul></li>
<li class="part"><span><b>Parte 2: Machine Learning</b></span></li>
<li class="chapter" data-level="5" data-path="introducción-a-machine-learning.html"><a href="introducción-a-machine-learning.html"><i class="fa fa-check"></i><b>5</b> Introducción a Machine Learning</a>
<ul>
<li class="chapter" data-level="5.1" data-path="introducción-a-machine-learning.html"><a href="introducción-a-machine-learning.html#análisis-supervisado-vs-no-supervisado"><i class="fa fa-check"></i><b>5.1</b> Análisis Supervisado vs No supervisado</a>
<ul>
<li class="chapter" data-level="5.1.1" data-path="introducción-a-machine-learning.html"><a href="introducción-a-machine-learning.html#regresión-vs-clasificación"><i class="fa fa-check"></i><b>5.1.1</b> Regresión vs clasificación</a></li>
</ul></li>
<li class="chapter" data-level="5.2" data-path="introducción-a-machine-learning.html"><a href="introducción-a-machine-learning.html#sesgo-vs-varianza"><i class="fa fa-check"></i><b>5.2</b> Sesgo vs varianza</a>
<ul>
<li class="chapter" data-level="5.2.1" data-path="introducción-a-machine-learning.html"><a href="introducción-a-machine-learning.html#errores-reducibles"><i class="fa fa-check"></i><b>5.2.1</b> Errores reducibles</a></li>
<li class="chapter" data-level="5.2.2" data-path="introducción-a-machine-learning.html"><a href="introducción-a-machine-learning.html#error-irreducible"><i class="fa fa-check"></i><b>5.2.2</b> Error irreducible</a></li>
<li class="chapter" data-level="5.2.3" data-path="introducción-a-machine-learning.html"><a href="introducción-a-machine-learning.html#balance-entre-sesgo-y-varianza-o-trade-off"><i class="fa fa-check"></i><b>5.2.3</b> Balance entre sesgo y varianza o Trade-off</a></li>
<li class="chapter" data-level="5.2.4" data-path="introducción-a-machine-learning.html"><a href="introducción-a-machine-learning.html#error-total"><i class="fa fa-check"></i><b>5.2.4</b> Error total</a></li>
<li class="chapter" data-level="5.2.5" data-path="introducción-a-machine-learning.html"><a href="introducción-a-machine-learning.html#overfitting"><i class="fa fa-check"></i><b>5.2.5</b> Overfitting</a></li>
<li class="chapter" data-level="5.2.6" data-path="introducción-a-machine-learning.html"><a href="introducción-a-machine-learning.html#underfitting"><i class="fa fa-check"></i><b>5.2.6</b> Underfitting</a></li>
</ul></li>
<li class="chapter" data-level="5.3" data-path="introducción-a-machine-learning.html"><a href="introducción-a-machine-learning.html#orden-y-estructura-de-proyecto"><i class="fa fa-check"></i><b>5.3</b> Orden y estructura de proyecto</a>
<ul>
<li class="chapter" data-level="5.3.1" data-path="introducción-a-machine-learning.html"><a href="introducción-a-machine-learning.html#plantilla-de-estructura-proyecto"><i class="fa fa-check"></i><b>5.3.1</b> Plantilla de estructura proyecto</a></li>
<li class="chapter" data-level="5.3.2" data-path="introducción-a-machine-learning.html"><a href="introducción-a-machine-learning.html#reproducibilidad"><i class="fa fa-check"></i><b>5.3.2</b> Reproducibilidad</a></li>
</ul></li>
<li class="chapter" data-level="5.4" data-path="introducción-a-machine-learning.html"><a href="introducción-a-machine-learning.html#partición-de-datos"><i class="fa fa-check"></i><b>5.4</b> Partición de datos</a>
<ul>
<li class="chapter" data-level="5.4.1" data-path="introducción-a-machine-learning.html"><a href="introducción-a-machine-learning.html#métodos-comunes-para-particionar-datos"><i class="fa fa-check"></i><b>5.4.1</b> Métodos comunes para particionar datos</a></li>
<li class="chapter" data-level="5.4.2" data-path="introducción-a-machine-learning.html"><a href="introducción-a-machine-learning.html#conjunto-de-validación"><i class="fa fa-check"></i><b>5.4.2</b> Conjunto de validación</a></li>
<li class="chapter" data-level="5.4.3" data-path="introducción-a-machine-learning.html"><a href="introducción-a-machine-learning.html#leave-one-out-cross-validation"><i class="fa fa-check"></i><b>5.4.3</b> Leave-one-out cross-validation</a></li>
<li class="chapter" data-level="5.4.4" data-path="introducción-a-machine-learning.html"><a href="introducción-a-machine-learning.html#v-fold-cross-validation"><i class="fa fa-check"></i><b>5.4.4</b> V Fold Cross Validation</a></li>
<li class="chapter" data-level="5.4.5" data-path="introducción-a-machine-learning.html"><a href="introducción-a-machine-learning.html#medidas-de-ajuste"><i class="fa fa-check"></i><b>5.4.5</b> Medidas de ajuste</a></li>
<li class="chapter" data-level="5.4.6" data-path="introducción-a-machine-learning.html"><a href="introducción-a-machine-learning.html#validación-cruzada-para-series-de-tiempo"><i class="fa fa-check"></i><b>5.4.6</b> Validación cruzada para series de tiempo</a></li>
</ul></li>
<li class="chapter" data-level="5.5" data-path="introducción-a-machine-learning.html"><a href="introducción-a-machine-learning.html#pre-procesamiento-de-datos"><i class="fa fa-check"></i><b>5.5</b> Pre-procesamiento de datos</a></li>
<li class="chapter" data-level="5.6" data-path="introducción-a-machine-learning.html"><a href="introducción-a-machine-learning.html#ingeniería-de-datos"><i class="fa fa-check"></i><b>5.6</b> Ingeniería de datos</a></li>
<li class="chapter" data-level="5.7" data-path="introducción-a-machine-learning.html"><a href="introducción-a-machine-learning.html#recetas"><i class="fa fa-check"></i><b>5.7</b> Recetas</a>
<ul>
<li class="chapter" data-level="5.7.1" data-path="introducción-a-machine-learning.html"><a href="introducción-a-machine-learning.html#pasos-y-estructura-de-recetas"><i class="fa fa-check"></i><b>5.7.1</b> Pasos y estructura de recetas</a></li>
<li class="chapter" data-level="5.7.2" data-path="introducción-a-machine-learning.html"><a href="introducción-a-machine-learning.html#imputaciones"><i class="fa fa-check"></i><b>5.7.2</b> Imputaciones</a></li>
<li class="chapter" data-level="5.7.3" data-path="introducción-a-machine-learning.html"><a href="introducción-a-machine-learning.html#agregar-o-modificar-columnas"><i class="fa fa-check"></i><b>5.7.3</b> Agregar o modificar columnas</a></li>
<li class="chapter" data-level="5.7.4" data-path="introducción-a-machine-learning.html"><a href="introducción-a-machine-learning.html#interacciones"><i class="fa fa-check"></i><b>5.7.4</b> Interacciones</a></li>
<li class="chapter" data-level="5.7.5" data-path="introducción-a-machine-learning.html"><a href="introducción-a-machine-learning.html#transformaciones-generales"><i class="fa fa-check"></i><b>5.7.5</b> Transformaciones generales</a></li>
</ul></li>
<li class="chapter" data-level="5.8" data-path="introducción-a-machine-learning.html"><a href="introducción-a-machine-learning.html#datos-y-tipos-de-modelos"><i class="fa fa-check"></i><b>5.8</b> Datos y tipos de modelos</a>
<ul>
<li class="chapter" data-level="5.8.1" data-path="introducción-a-machine-learning.html"><a href="introducción-a-machine-learning.html#separación-de-los-datos"><i class="fa fa-check"></i><b>5.8.1</b> Separación de los datos</a></li>
<li class="chapter" data-level="5.8.2" data-path="introducción-a-machine-learning.html"><a href="introducción-a-machine-learning.html#definición-de-la-receta"><i class="fa fa-check"></i><b>5.8.2</b> Definición de la receta</a></li>
<li class="chapter" data-level="5.8.3" data-path="introducción-a-machine-learning.html"><a href="introducción-a-machine-learning.html#separación-de-los-datos-1"><i class="fa fa-check"></i><b>5.8.3</b> Separación de los datos</a></li>
<li class="chapter" data-level="5.8.4" data-path="introducción-a-machine-learning.html"><a href="introducción-a-machine-learning.html#definición-de-la-receta-1"><i class="fa fa-check"></i><b>5.8.4</b> Definición de la receta</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="6" data-path="regresión-lineal.html"><a href="regresión-lineal.html"><i class="fa fa-check"></i><b>6</b> Regresión Lineal</a>
<ul>
<li class="chapter" data-level="6.1" data-path="regresión-lineal.html"><a href="regresión-lineal.html#ajuste-de-modelo"><i class="fa fa-check"></i><b>6.1</b> Ajuste de modelo</a>
<ul>
<li class="chapter" data-level="6.1.1" data-path="regresión-lineal.html"><a href="regresión-lineal.html#estimación-de-parámetros-regresión-lineal-simple"><i class="fa fa-check"></i><b>6.1.1</b> Estimación de parámetros: Regresión lineal simple</a></li>
<li class="chapter" data-level="6.1.2" data-path="regresión-lineal.html"><a href="regresión-lineal.html#estimación-de-parámetros-regresión-lineal-múltiple"><i class="fa fa-check"></i><b>6.1.2</b> Estimación de parámetros: Regresión lineal múltiple</a></li>
</ul></li>
<li class="chapter" data-level="6.2" data-path="regresión-lineal.html"><a href="regresión-lineal.html#residuos-del-modelo"><i class="fa fa-check"></i><b>6.2</b> Residuos del modelo</a>
<ul>
<li class="chapter" data-level="" data-path="regresión-lineal.html"><a href="regresión-lineal.html#condiciones-para-el-ajuste-de-una-regresión-lineal"><i class="fa fa-check"></i>Condiciones para el ajuste de una regresión lineal:</a></li>
</ul></li>
<li class="chapter" data-level="6.3" data-path="regresión-lineal.html"><a href="regresión-lineal.html#métricas-de-desempeño"><i class="fa fa-check"></i><b>6.3</b> Métricas de desempeño</a></li>
<li class="chapter" data-level="6.4" data-path="regresión-lineal.html"><a href="regresión-lineal.html#implementación-en-r"><i class="fa fa-check"></i><b>6.4</b> Implementación en R</a>
<ul>
<li class="chapter" data-level="6.4.1" data-path="regresión-lineal.html"><a href="regresión-lineal.html#coeficientes-del-modelo"><i class="fa fa-check"></i><b>6.4.1</b> Coeficientes del modelo</a></li>
<li class="chapter" data-level="6.4.2" data-path="regresión-lineal.html"><a href="regresión-lineal.html#métricas-de-desempeño-1"><i class="fa fa-check"></i><b>6.4.2</b> Métricas de desempeño</a></li>
<li class="chapter" data-level="6.4.3" data-path="regresión-lineal.html"><a href="regresión-lineal.html#gráfica-de-ajuste"><i class="fa fa-check"></i><b>6.4.3</b> Gráfica de ajuste</a></li>
</ul></li>
<li class="chapter" data-level="6.5" data-path="regresión-lineal.html"><a href="regresión-lineal.html#métodos-se-selección-de-variables"><i class="fa fa-check"></i><b>6.5</b> Métodos se selección de variables</a>
<ul>
<li class="chapter" data-level="6.5.1" data-path="regresión-lineal.html"><a href="regresión-lineal.html#forward-selection-selección-hacia-adelante"><i class="fa fa-check"></i><b>6.5.1</b> Forward selection (selección hacia adelante)</a></li>
<li class="chapter" data-level="6.5.2" data-path="regresión-lineal.html"><a href="regresión-lineal.html#backward-selection-selección-hacia-atrás"><i class="fa fa-check"></i><b>6.5.2</b> Backward selection (selección hacia atrás)</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="7" data-path="regresión-logística.html"><a href="regresión-logística.html"><i class="fa fa-check"></i><b>7</b> Regresión Logística</a>
<ul>
<li class="chapter" data-level="7.1" data-path="regresión-logística.html"><a href="regresión-logística.html#función-sigmoide"><i class="fa fa-check"></i><b>7.1</b> Función sigmoide</a></li>
<li class="chapter" data-level="7.2" data-path="regresión-logística.html"><a href="regresión-logística.html#ajuste-del-modelo"><i class="fa fa-check"></i><b>7.2</b> Ajuste del modelo</a></li>
<li class="chapter" data-level="7.3" data-path="regresión-logística.html"><a href="regresión-logística.html#clasificación-2"><i class="fa fa-check"></i><b>7.3</b> Clasificación</a></li>
<li class="chapter" data-level="7.4" data-path="regresión-logística.html"><a href="regresión-logística.html#métricas-de-desempeño-2"><i class="fa fa-check"></i><b>7.4</b> Métricas de desempeño</a></li>
<li class="chapter" data-level="7.5" data-path="regresión-logística.html"><a href="regresión-logística.html#implementación-en-r-1"><i class="fa fa-check"></i><b>7.5</b> Implementación en R</a></li>
<li class="chapter" data-level="7.6" data-path="regresión-logística.html"><a href="regresión-logística.html#matriz-de-confusión"><i class="fa fa-check"></i><b>7.6</b> Matriz de Confusión</a></li>
</ul></li>
<li class="chapter" data-level="8" data-path="k-nearest-neighbor.html"><a href="k-nearest-neighbor.html"><i class="fa fa-check"></i><b>8</b> K-Nearest-Neighbor</a>
<ul>
<li class="chapter" data-level="8.1" data-path="k-nearest-neighbor.html"><a href="k-nearest-neighbor.html#clasificación-3"><i class="fa fa-check"></i><b>8.1</b> Clasificación</a></li>
<li class="chapter" data-level="8.2" data-path="k-nearest-neighbor.html"><a href="k-nearest-neighbor.html#regresión-2"><i class="fa fa-check"></i><b>8.2</b> Regresión</a></li>
<li class="chapter" data-level="8.3" data-path="k-nearest-neighbor.html"><a href="k-nearest-neighbor.html#ajuste-del-modelo-1"><i class="fa fa-check"></i><b>8.3</b> Ajuste del modelo</a>
<ul>
<li class="chapter" data-level="8.3.1" data-path="k-nearest-neighbor.html"><a href="k-nearest-neighbor.html#selección-de-hiper-parámetro-k"><i class="fa fa-check"></i><b>8.3.1</b> Selección de Hiper-parámetro K</a></li>
<li class="chapter" data-level="8.3.2" data-path="k-nearest-neighbor.html"><a href="k-nearest-neighbor.html#métodos-de-cálculo-de-la-distancia-entre-observaciones"><i class="fa fa-check"></i><b>8.3.2</b> Métodos de cálculo de la distancia entre observaciones</a></li>
</ul></li>
<li class="chapter" data-level="8.4" data-path="k-nearest-neighbor.html"><a href="k-nearest-neighbor.html#implementación-en-r-2"><i class="fa fa-check"></i><b>8.4</b> Implementación en R</a>
<ul>
<li class="chapter" data-level="8.4.1" data-path="k-nearest-neighbor.html"><a href="k-nearest-neighbor.html#regresión-3"><i class="fa fa-check"></i><b>8.4.1</b> Regresión</a></li>
<li class="chapter" data-level="8.4.2" data-path="k-nearest-neighbor.html"><a href="k-nearest-neighbor.html#clasificación-4"><i class="fa fa-check"></i><b>8.4.2</b> Clasificación</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="9" data-path="árboles-de-decisión.html"><a href="árboles-de-decisión.html"><i class="fa fa-check"></i><b>9</b> Árboles de decisión</a>
<ul>
<li class="chapter" data-level="9.1" data-path="árboles-de-decisión.html"><a href="árboles-de-decisión.html#ajuste-del-modelo-2"><i class="fa fa-check"></i><b>9.1</b> Ajuste del modelo</a>
<ul>
<li class="chapter" data-level="9.1.1" data-path="árboles-de-decisión.html"><a href="árboles-de-decisión.html#attribute-selective-measure-asm"><i class="fa fa-check"></i><b>9.1.1</b> Attribute Selective Measure (ASM)</a></li>
</ul></li>
<li class="chapter" data-level="9.2" data-path="árboles-de-decisión.html"><a href="árboles-de-decisión.html#regularización-de-árboles"><i class="fa fa-check"></i><b>9.2</b> Regularización de árboles</a>
<ul>
<li class="chapter" data-level="9.2.1" data-path="árboles-de-decisión.html"><a href="árboles-de-decisión.html#nivel-de-profundidad-de-árbol"><i class="fa fa-check"></i><b>9.2.1</b> Nivel de profundidad de árbol</a></li>
<li class="chapter" data-level="9.2.2" data-path="árboles-de-decisión.html"><a href="árboles-de-decisión.html#poda-de-árbol"><i class="fa fa-check"></i><b>9.2.2</b> Poda de árbol</a></li>
</ul></li>
<li class="chapter" data-level="9.3" data-path="árboles-de-decisión.html"><a href="árboles-de-decisión.html#aprendizaje-conjunto"><i class="fa fa-check"></i><b>9.3</b> Aprendizaje conjunto</a>
<ul>
<li class="chapter" data-level="9.3.1" data-path="árboles-de-decisión.html"><a href="árboles-de-decisión.html#bagging-vs.-boosting"><i class="fa fa-check"></i><b>9.3.1</b> Bagging vs. boosting</a></li>
<li class="chapter" data-level="9.3.2" data-path="árboles-de-decisión.html"><a href="árboles-de-decisión.html#error-out-of-bag"><i class="fa fa-check"></i><b>9.3.2</b> Error Out-Of-Bag</a></li>
</ul></li>
<li class="chapter" data-level="9.4" data-path="árboles-de-decisión.html"><a href="árboles-de-decisión.html#bagging"><i class="fa fa-check"></i><b>9.4</b> Bagging</a></li>
<li class="chapter" data-level="9.5" data-path="árboles-de-decisión.html"><a href="árboles-de-decisión.html#random-forest"><i class="fa fa-check"></i><b>9.5</b> Random Forest</a>
<ul>
<li class="chapter" data-level="9.5.1" data-path="árboles-de-decisión.html"><a href="árboles-de-decisión.html#qué-es"><i class="fa fa-check"></i><b>9.5.1</b> ¿Qué es?</a></li>
<li class="chapter" data-level="9.5.2" data-path="árboles-de-decisión.html"><a href="árboles-de-decisión.html#características-de-los-bosques-aleatorios"><i class="fa fa-check"></i><b>9.5.2</b> Características de los bosques aleatorios</a></li>
<li class="chapter" data-level="9.5.3" data-path="árboles-de-decisión.html"><a href="árboles-de-decisión.html#aplicar-árboles-de-decisión-en-un-bosque-aleatorio"><i class="fa fa-check"></i><b>9.5.3</b> Aplicar árboles de decisión en un bosque aleatorio</a></li>
<li class="chapter" data-level="9.5.4" data-path="árboles-de-decisión.html"><a href="árboles-de-decisión.html#ventajas-y-desventjas-de-bosques-aleatorios"><i class="fa fa-check"></i><b>9.5.4</b> Ventajas y desventjas de bosques aleatorios</a></li>
</ul></li>
<li class="chapter" data-level="9.6" data-path="árboles-de-decisión.html"><a href="árboles-de-decisión.html#implementación-de-rf-en-r"><i class="fa fa-check"></i><b>9.6</b> Implementación de RF en R</a>
<ul>
<li class="chapter" data-level="9.6.1" data-path="árboles-de-decisión.html"><a href="árboles-de-decisión.html#regresión-4"><i class="fa fa-check"></i><b>9.6.1</b> Regresión</a></li>
<li class="chapter" data-level="9.6.2" data-path="árboles-de-decisión.html"><a href="árboles-de-decisión.html#clasificación-5"><i class="fa fa-check"></i><b>9.6.2</b> Clasificación</a></li>
</ul></li>
<li class="chapter" data-level="9.7" data-path="árboles-de-decisión.html"><a href="árboles-de-decisión.html#boosting"><i class="fa fa-check"></i><b>9.7</b> Boosting</a>
<ul>
<li class="chapter" data-level="9.7.1" data-path="árboles-de-decisión.html"><a href="árboles-de-decisión.html#predicciones-boosting"><i class="fa fa-check"></i><b>9.7.1</b> Predicciones <em>Boosting</em></a></li>
<li class="chapter" data-level="9.7.2" data-path="árboles-de-decisión.html"><a href="árboles-de-decisión.html#modelos-boosting"><i class="fa fa-check"></i><b>9.7.2</b> Modelos <em>Boosting</em></a></li>
</ul></li>
<li class="chapter" data-level="9.8" data-path="árboles-de-decisión.html"><a href="árboles-de-decisión.html#implementación-de-xgb-en-r"><i class="fa fa-check"></i><b>9.8</b> Implementación de XGB en R</a>
<ul>
<li class="chapter" data-level="9.8.1" data-path="árboles-de-decisión.html"><a href="árboles-de-decisión.html#xgboost-para-regresión"><i class="fa fa-check"></i><b>9.8.1</b> XGBoost para regresión</a></li>
<li class="chapter" data-level="9.8.2" data-path="árboles-de-decisión.html"><a href="árboles-de-decisión.html#xgboost-para-clasificación"><i class="fa fa-check"></i><b>9.8.2</b> XGBoost para clasificación</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="10" data-path="regularización-elasticnet.html"><a href="regularización-elasticnet.html"><i class="fa fa-check"></i><b>10</b> Regularización Elasticnet</a>
<ul>
<li class="chapter" data-level="10.1" data-path="regularización-elasticnet.html"><a href="regularización-elasticnet.html#regularización-ridge"><i class="fa fa-check"></i><b>10.1</b> Regularización Ridge</a></li>
<li class="chapter" data-level="10.2" data-path="regularización-elasticnet.html"><a href="regularización-elasticnet.html#regularización-lasso"><i class="fa fa-check"></i><b>10.2</b> Regularización Lasso</a></li>
<li class="chapter" data-level="10.3" data-path="regularización-elasticnet.html"><a href="regularización-elasticnet.html#comparación-entre-ridge-y-lasso"><i class="fa fa-check"></i><b>10.3</b> Comparación entre Ridge y Lasso</a></li>
<li class="chapter" data-level="10.4" data-path="regularización-elasticnet.html"><a href="regularización-elasticnet.html#elasticnet"><i class="fa fa-check"></i><b>10.4</b> ElasticNet</a></li>
<li class="chapter" data-level="10.5" data-path="regularización-elasticnet.html"><a href="regularización-elasticnet.html#implementación-en-r-3"><i class="fa fa-check"></i><b>10.5</b> Implementación en R</a>
<ul>
<li class="chapter" data-level="10.5.1" data-path="regularización-elasticnet.html"><a href="regularización-elasticnet.html#regresión-5"><i class="fa fa-check"></i><b>10.5.1</b> Regresión</a></li>
<li class="chapter" data-level="10.5.2" data-path="regularización-elasticnet.html"><a href="regularización-elasticnet.html#clasificación-6"><i class="fa fa-check"></i><b>10.5.2</b> Clasificación</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="11" data-path="workflowsets-stacking.html"><a href="workflowsets-stacking.html"><i class="fa fa-check"></i><b>11</b> Workflowsets &amp; Stacking</a>
<ul>
<li class="chapter" data-level="11.1" data-path="workflowsets-stacking.html"><a href="workflowsets-stacking.html#múltiples-recetas"><i class="fa fa-check"></i><b>11.1</b> Múltiples recetas</a></li>
<li class="chapter" data-level="11.2" data-path="workflowsets-stacking.html"><a href="workflowsets-stacking.html#múltiples-modelos"><i class="fa fa-check"></i><b>11.2</b> Múltiples modelos</a></li>
<li class="chapter" data-level="11.3" data-path="workflowsets-stacking.html"><a href="workflowsets-stacking.html#creación-de-workflowset"><i class="fa fa-check"></i><b>11.3</b> Creación de workflowset</a></li>
<li class="chapter" data-level="11.4" data-path="workflowsets-stacking.html"><a href="workflowsets-stacking.html#ajuste-y-evaluación-de-modelos"><i class="fa fa-check"></i><b>11.4</b> Ajuste y evaluación de modelos</a></li>
<li class="chapter" data-level="11.5" data-path="workflowsets-stacking.html"><a href="workflowsets-stacking.html#extracción-de-modelos"><i class="fa fa-check"></i><b>11.5</b> Extracción de modelos</a>
<ul>
<li class="chapter" data-level="11.5.1" data-path="workflowsets-stacking.html"><a href="workflowsets-stacking.html#selección-de-modelo"><i class="fa fa-check"></i><b>11.5.1</b> Selección de modelo</a></li>
</ul></li>
<li class="chapter" data-level="11.6" data-path="workflowsets-stacking.html"><a href="workflowsets-stacking.html#stacking"><i class="fa fa-check"></i><b>11.6</b> Stacking</a>
<ul>
<li class="chapter" data-level="11.6.1" data-path="workflowsets-stacking.html"><a href="workflowsets-stacking.html#elección-de-modelos"><i class="fa fa-check"></i><b>11.6.1</b> Elección de modelos</a></li>
<li class="chapter" data-level="11.6.2" data-path="workflowsets-stacking.html"><a href="workflowsets-stacking.html#ajuste-final"><i class="fa fa-check"></i><b>11.6.2</b> Ajuste final</a></li>
<li class="chapter" data-level="11.6.3" data-path="workflowsets-stacking.html"><a href="workflowsets-stacking.html#comparación-de-métricas"><i class="fa fa-check"></i><b>11.6.3</b> Comparación de métricas</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="12" data-path="sesgo-e-inequidad.html"><a href="sesgo-e-inequidad.html"><i class="fa fa-check"></i><b>12</b> Sesgo e Inequidad</a>
<ul>
<li class="chapter" data-level="12.1" data-path="sesgo-e-inequidad.html"><a href="sesgo-e-inequidad.html#propósito-vs-error"><i class="fa fa-check"></i><b>12.1</b> Propósito Vs Error</a></li>
<li class="chapter" data-level="12.2" data-path="sesgo-e-inequidad.html"><a href="sesgo-e-inequidad.html#métricas"><i class="fa fa-check"></i><b>12.2</b> Métricas</a>
<ul>
<li class="chapter" data-level="12.2.1" data-path="sesgo-e-inequidad.html"><a href="sesgo-e-inequidad.html#equal-parity-or-demographic-or-statistical-parity"><i class="fa fa-check"></i><b>12.2.1</b> Equal Parity or Demographic or Statistical Parity</a></li>
<li class="chapter" data-level="12.2.2" data-path="sesgo-e-inequidad.html"><a href="sesgo-e-inequidad.html#proportional-parity-o-impact-parity-o-minimizing-disparate-impact"><i class="fa fa-check"></i><b>12.2.2</b> Proportional Parity o Impact Parity o Minimizing Disparate Impact</a></li>
<li class="chapter" data-level="12.2.3" data-path="sesgo-e-inequidad.html"><a href="sesgo-e-inequidad.html#equalized-odds"><i class="fa fa-check"></i><b>12.2.3</b> Equalized odds</a></li>
<li class="chapter" data-level="12.2.4" data-path="sesgo-e-inequidad.html"><a href="sesgo-e-inequidad.html#predictive-rate-parity"><i class="fa fa-check"></i><b>12.2.4</b> Predictive rate parity</a></li>
<li class="chapter" data-level="12.2.5" data-path="sesgo-e-inequidad.html"><a href="sesgo-e-inequidad.html#accuracy-parity"><i class="fa fa-check"></i><b>12.2.5</b> Accuracy parity</a></li>
<li class="chapter" data-level="12.2.6" data-path="sesgo-e-inequidad.html"><a href="sesgo-e-inequidad.html#false-negative-parity-o-equal-oppportunity"><i class="fa fa-check"></i><b>12.2.6</b> False Negative Parity o Equal Oppportunity</a></li>
<li class="chapter" data-level="12.2.7" data-path="sesgo-e-inequidad.html"><a href="sesgo-e-inequidad.html#false-positive-parity"><i class="fa fa-check"></i><b>12.2.7</b> False Positive Parity</a></li>
<li class="chapter" data-level="12.2.8" data-path="sesgo-e-inequidad.html"><a href="sesgo-e-inequidad.html#negative-predictive-value-parity"><i class="fa fa-check"></i><b>12.2.8</b> Negative predictive value parity</a></li>
<li class="chapter" data-level="12.2.9" data-path="sesgo-e-inequidad.html"><a href="sesgo-e-inequidad.html#specificity-parity"><i class="fa fa-check"></i><b>12.2.9</b> Specificity parity</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="13" data-path="interpretabilidad-local.html"><a href="interpretabilidad-local.html"><i class="fa fa-check"></i><b>13</b> Interpretabilidad local</a>
<ul>
<li class="chapter" data-level="13.1" data-path="interpretabilidad-local.html"><a href="interpretabilidad-local.html#interpretabilidad-lime"><i class="fa fa-check"></i><b>13.1</b> Interpretabilidad LIME</a>
<ul>
<li class="chapter" data-level="13.1.1" data-path="interpretabilidad-local.html"><a href="interpretabilidad-local.html#proceso"><i class="fa fa-check"></i><b>13.1.1</b> Proceso</a></li>
<li class="chapter" data-level="13.1.2" data-path="interpretabilidad-local.html"><a href="interpretabilidad-local.html#características-principales"><i class="fa fa-check"></i><b>13.1.2</b> Características principales</a></li>
<li class="chapter" data-level="13.1.3" data-path="interpretabilidad-local.html"><a href="interpretabilidad-local.html#implementación-con-r"><i class="fa fa-check"></i><b>13.1.3</b> Implementación con <em>R</em></a></li>
</ul></li>
<li class="chapter" data-level="13.2" data-path="interpretabilidad-local.html"><a href="interpretabilidad-local.html#interpretabilidad-dalextra"><i class="fa fa-check"></i><b>13.2</b> Interpretabilidad DALEXtra</a>
<ul>
<li class="chapter" data-level="13.2.1" data-path="interpretabilidad-local.html"><a href="interpretabilidad-local.html#otros-métodos"><i class="fa fa-check"></i><b>13.2.1</b> Otros métodos</a></li>
<li class="chapter" data-level="13.2.2" data-path="interpretabilidad-local.html"><a href="interpretabilidad-local.html#consejos"><i class="fa fa-check"></i><b>13.2.2</b> Consejos</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="14" data-path="a-b---testing.html"><a href="a-b---testing.html"><i class="fa fa-check"></i><b>14</b> A / B - testing</a>
<ul>
<li class="chapter" data-level="14.1" data-path="a-b---testing.html"><a href="a-b---testing.html#elementos-en-riesgo"><i class="fa fa-check"></i><b>14.1</b> Elementos en riesgo</a></li>
<li class="chapter" data-level="14.2" data-path="a-b---testing.html"><a href="a-b---testing.html#costo-de-retención"><i class="fa fa-check"></i><b>14.2</b> Costo de retención</a></li>
<li class="chapter" data-level="14.3" data-path="a-b---testing.html"><a href="a-b---testing.html#diseño-experimental"><i class="fa fa-check"></i><b>14.3</b> Diseño experimental</a>
<ul>
<li class="chapter" data-level="14.3.1" data-path="a-b---testing.html"><a href="a-b---testing.html#qué-es-y-para-qué-sirve-muestreo"><i class="fa fa-check"></i><b>14.3.1</b> ¿Qué es y para qué sirve muestreo?</a></li>
<li class="chapter" data-level="14.3.2" data-path="a-b---testing.html"><a href="a-b---testing.html#muestreo-estratificado"><i class="fa fa-check"></i><b>14.3.2</b> Muestreo estratificado</a></li>
<li class="chapter" data-level="14.3.3" data-path="a-b---testing.html"><a href="a-b---testing.html#marco-de-muestreo"><i class="fa fa-check"></i><b>14.3.3</b> Marco de muestreo</a></li>
<li class="chapter" data-level="14.3.4" data-path="a-b---testing.html"><a href="a-b---testing.html#tamaño-de-muestra"><i class="fa fa-check"></i><b>14.3.4</b> Tamaño de muestra</a></li>
<li class="chapter" data-level="14.3.5" data-path="a-b---testing.html"><a href="a-b---testing.html#distribución-muestral"><i class="fa fa-check"></i><b>14.3.5</b> Distribución muestral</a></li>
<li class="chapter" data-level="14.3.6" data-path="a-b---testing.html"><a href="a-b---testing.html#probabilidades-y-factores"><i class="fa fa-check"></i><b>14.3.6</b> Probabilidades y Factores</a></li>
</ul></li>
<li class="chapter" data-level="14.4" data-path="a-b---testing.html"><a href="a-b---testing.html#extracción-de-muestra"><i class="fa fa-check"></i><b>14.4</b> Extracción de muestra</a>
<ul>
<li class="chapter" data-level="14.4.1" data-path="a-b---testing.html"><a href="a-b---testing.html#muestreo-estratificado-1"><i class="fa fa-check"></i><b>14.4.1</b> Muestreo estratificado</a></li>
</ul></li>
<li class="chapter" data-level="14.5" data-path="a-b---testing.html"><a href="a-b---testing.html#estimación-muestral"><i class="fa fa-check"></i><b>14.5</b> Estimación muestral</a>
<ul>
<li class="chapter" data-level="14.5.1" data-path="a-b---testing.html"><a href="a-b---testing.html#implementación-de-diseño-muestral"><i class="fa fa-check"></i><b>14.5.1</b> Implementación de diseño muestral</a></li>
<li class="chapter" data-level="14.5.2" data-path="a-b---testing.html"><a href="a-b---testing.html#estimación-de-resultados"><i class="fa fa-check"></i><b>14.5.2</b> Estimación de resultados</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="15" data-path="análisis-de-componentes-principales.html"><a href="análisis-de-componentes-principales.html"><i class="fa fa-check"></i><b>15</b> Análisis de Componentes Principales</a>
<ul>
<li class="chapter" data-level="15.1" data-path="análisis-de-componentes-principales.html"><a href="análisis-de-componentes-principales.html#construcción-matemática"><i class="fa fa-check"></i><b>15.1</b> Construcción matemática</a></li>
<li class="chapter" data-level="15.2" data-path="análisis-de-componentes-principales.html"><a href="análisis-de-componentes-principales.html#implementación-en-r-6"><i class="fa fa-check"></i><b>15.2</b> Implementación en R</a></li>
<li class="chapter" data-level="15.3" data-path="análisis-de-componentes-principales.html"><a href="análisis-de-componentes-principales.html#reducción-de-dimensión"><i class="fa fa-check"></i><b>15.3</b> Reducción de dimensión</a></li>
<li class="chapter" data-level="15.4" data-path="análisis-de-componentes-principales.html"><a href="análisis-de-componentes-principales.html#representación-gráfica"><i class="fa fa-check"></i><b>15.4</b> Representación gráfica</a></li>
</ul></li>
<li class="divider"></li>
<li><a href="./"><img src="img/amat-logo.png" width="280"></a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Ciencia de Datos y Machine Learning</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="regularización-elasticnet" class="section level1 hasAnchor" number="10">
<h1><span class="header-section-number">Capítulo 10</span> Regularización Elasticnet<a href="regularización-elasticnet.html#regularización-elasticnet" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<p>En muchas técnicas de aprendizaje automático, <strong>el aprendizaje consiste en encontrar los coeficientes que minimizan una función de costo</strong>. Un modelo estándar de mínimos cuadrados tiende a tener alguna variación, es decir, este modelo no se generalizará bien para un conjunto de datos diferente a sus datos de entrenamiento.</p>
<p>La regularización consiste en <strong>añadir una penalización a la función de costo. Esta penalización produce modelos más simples que generalizan mejor y evita el riesgo de sobre-ajuste</strong>.</p>
<p>El procedimiento de ajuste implica una función de pérdida, conocida como suma de cuadrados residual o <em>RSS</em>. Los coeficientes <span class="math inline">\(\beta\)</span> se eligen de manera que minimicen esta función de pérdida.</p>
<p><span class="math display">\[RSS = \sum_{i=1}^n\left(y_i - \beta_0- \sum_{i=1}^p \beta_jx_{ij}\right)^2\]</span></p>
<p>Esto ajustará los coeficientes en función de sus datos de entrenamiento. Si hay ruido en los datos de entrenamiento, los coeficientes estimados no se generalizarán bien a los datos futuros. Aquí es donde entra la regularización y reduce o regulariza estas estimaciones aprendidas hacia cero.</p>
<p>En esta sección se verán las regularizaciones más usadas en machine learning:</p>
<ul>
<li>Ridge (conocida también como L2)</li>
<li>Lasso (también conocida como L1)</li>
<li>ElasticNet que combina tanto Lasso como Ridge.</li>
</ul>
<p>Para cada una de estas regularizaciones ajustaremos un modelo de regresión lineal al conjunto de datos de viviendas de <em>Ames</em> con ayuda del paquete de <em>tidymodels</em> llamado <em>parsnip</em>.</p>
<p><img src="img/10-ml-elasticnet/overfitting.png" width="500pt" height="250pt" style="display: block; margin: auto;" /></p>
<div id="regularización-ridge" class="section level2 hasAnchor" number="10.1">
<h2><span class="header-section-number">10.1</span> Regularización Ridge<a href="regularización-elasticnet.html#regularización-ridge" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>En este tipo de regularización <em>RSS</em> se modifica agregando una cantidad de <strong>contracción a los coeficientes</strong>, los cuales se estiman minimizando esta función. <span class="math inline">\(\lambda\)</span> es el parámetro de ajuste que decide cuánto queremos penalizar la flexibilidad de el modelo.</p>
<p><span class="math display">\[\sum_{i=1}^n\left(y_i - \beta_0- \sum_{i=1}^p \beta_jx_{ij}\right)^2 + \lambda \sum_{j=1}^p \beta_j^2 = RSS + \lambda \sum_{j=1}^p \beta_j^2\]</span></p>
<p>El aumento de la flexibilidad de un modelo está representado por el aumento de sus coeficientes, si se desea minimizar la función anterior, los coeficientes deben ser pequeños.</p>
<p>Así es como la técnica de regresión de <em>Ridge</em> evita que los coeficientes aumenten demasiado. Además, reduce la asociación estimada de cada variable con la respuesta excepto la intersección <span class="math inline">\(\beta_0\)</span>. Esta intersección es una medida del valor medio de la respuesta cuando <span class="math inline">\(x_{i1} = x_{i2} =\dots= x_{ip} = 0\)</span>.</p>
<blockquote>
<p>Cuando <span class="math inline">\(\lambda = 0\)</span>, el término de penalización no tiene efecto y las estimaciones serán iguales a mínimos cuadrados.</p>
</blockquote>
<blockquote>
<p>A medida que <span class="math inline">\(\lambda \rightarrow \infty\)</span>, el impacto de la penalización por contracción aumenta, y las estimaciones se acercarán a cero.</p>
</blockquote>
<p>La selección de un buen valor de <span class="math inline">\(\lambda\)</span> es fundamental. Las estimaciones de coeficientes producidas por este método también se conocen como la <strong>norma L2</strong>.</p>
<p><strong>Nota:</strong> Es necesario estandarizar los predictores o llevarlos a la misma escala antes de aplicar esta regularización.</p>
</div>
<div id="regularización-lasso" class="section level2 hasAnchor" number="10.2">
<h2><span class="header-section-number">10.2</span> Regularización Lasso<a href="regularización-elasticnet.html#regularización-lasso" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Lasso es otra variación, en la que se minimiza la función <em>RSS</em>. Utiliza <span class="math inline">\(|\beta_j|\)</span> en lugar de los cuadrados de <span class="math inline">\(\beta\)</span> como penalización. Las estimaciones de coeficientes producidas por este método también se conocen como la <strong>norma L1</strong>.</p>
<p><span class="math display">\[\sum_{i=1}^n\left(y_i - \beta_0- \sum_{i=1}^p \beta_jx_{ij}\right)^2 + \lambda \sum_{j=1}^p |\beta_j| = RSS + \lambda \sum_{j=1}^p |\beta_j|\]</span></p>
<blockquote>
<p>Cuando <span class="math inline">\(\lambda = 0\)</span>, el término de penalización no tiene efecto y las estimaciones serán iguales a mínimos cuadrados.</p>
</blockquote>
<blockquote>
<p>A medida que <span class="math inline">\(\lambda \rightarrow \infty\)</span>, el impacto de la penalización por contracción aumenta, y las estimaciones se convierten en cero (eliminando variables).</p>
</blockquote>
<p>Este método de regularización permite eliminar coeficientes con alta variación, lo cual <strong>ayuda a la selección de variables</strong>.</p>
</div>
<div id="comparación-entre-ridge-y-lasso" class="section level2 hasAnchor" number="10.3">
<h2><span class="header-section-number">10.3</span> Comparación entre Ridge y Lasso<a href="regularización-elasticnet.html#comparación-entre-ridge-y-lasso" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>La regresión <em>Ridge</em> se puede considerar como la solución de una ecuación, donde la suma de los cuadrados de los coeficientes es menor o igual que <span class="math inline">\(s\)</span>, donde <span class="math inline">\(s\)</span> es una constante que existe para cada valor del factor de contracción <span class="math inline">\(\lambda\)</span></p>
<p><span class="math display">\[\beta_1^2 + \beta_2^2 \leq s\]</span></p>
<p>Esto implica que los coeficientes de la regresión <em>Ridge</em> tienen el <em>RSS</em> (función de pérdida) más pequeño para todos los puntos que se encuentran dentro del círculo dado por la función de restricción <span class="math inline">\(\beta_1^2 + \beta_2^2 \leq s\)</span>.</p>
<p>Y en la regresión <em>Lasso</em> se puede considerar como una ecuación en la que la suma del módulo de coeficientes es menor o igual que <span class="math inline">\(s\)</span>.</p>
<p><span class="math display">\[|\beta_1| + |\beta_2| \leq s\]</span></p>
<p>Esto implica que los coeficientes de lasso tienen la <em>RSS</em> (función de pérdida) más pequeña para todos los puntos que se encuentran dentro del diamante dado por la función de restricción <span class="math inline">\(|\beta_1| + |\beta_2| \leq s\)</span></p>
<p><img src="img/10-ml-elasticnet/ridge-lasso.png" width="600pt" height="300pt" style="display: block; margin: auto;" /></p>
<p>La imagen de arriba muestra las funciones de restricción (áreas verdes) para <em>Lasso</em> (izquierda) y <em>Ridge</em> (derecha), junto con contornos para <em>RSS</em> (elipse roja).</p>
<p>Para un valor muy grande de <span class="math inline">\(s\)</span>, las regiones verdes contendrán el centro de la elipse, lo que hará que las estimaciones de los coeficientes de ambas técnicas de regresión sean iguales a las estimaciones de mínimos cuadrados. Pero este no es el caso en la imagen de arriba.</p>
<p>En este caso, las estimaciones del coeficiente de regresión de <em>Lasso</em> y <em>Ridge</em> vienen dadas por el primer punto en el que una elipse contacta con la región de restricción. Dado que la regresión <em>Ridge</em> tiene una restricción circular sin puntos agudos, <strong>esta intersección generalmente no ocurrirá en un eje, por lo que las estimaciones del coeficiente de regresión de <em>Ridge</em> serán exclusivamente distintas de cero</strong>.</p>
<p>Sin embargo, la restricción de <em>Lasso</em> <strong>tiene esquinas en cada uno de los ejes</strong>, por lo que la elipse a menudo intersectará la región de restricción en un eje. <strong>Cuando esto ocurre, uno de los coeficientes será igual a cero</strong>. En dimensiones más altas, muchas de las estimaciones de coeficientes pueden ser iguales a cero simultáneamente.</p>
<p><strong>Desventajas</strong></p>
<ul>
<li><p>Regresión <em>Ridge</em>: Reducirá los coeficientes de los predictores menos importantes, muy cerca de cero. Pero nunca los hará exactamente cero. En otras palabras, el modelo final incluirá todos los predictores.</p></li>
<li><p>Regresión <em>Lasso</em>: La penalización <em>L1</em> tiene el efecto de forzar algunas de las estimaciones de coeficientes a ser exactamente iguales a cero cuando el parámetro de ajuste <span class="math inline">\(\lambda\)</span> es suficientemente grande. Por lo tanto, este método realiza una selección de variables.</p></li>
</ul>
</div>
<div id="elasticnet" class="section level2 hasAnchor" number="10.4">
<h2><span class="header-section-number">10.4</span> ElasticNet<a href="regularización-elasticnet.html#elasticnet" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p><em>ElasticNet</em> surgió por primera vez como resultado de la crítica a <em>Lasso</em>, cuya selección de variables puede ser demasiado dependiente de los datos y, por lo tanto, inestable. La solución es <strong>combinar las penalizaciones</strong> de la regresión de <em>Ridge</em> y <em>Lasso</em> para obtener lo mejor de ambas regularizaciones.</p>
<p><em>ElasticNet</em> tiene como objetivo minimizar la siguiente función de pérdida:</p>
<p><span class="math display">\[\frac{\sum_{i=1}^n\left(y_i - \beta_0- \sum_{i=1}^p \beta_jx_{ij}\right)^2}{2n} +
\lambda\left( ({1-\alpha}) \sum_{j=1}^p|\beta_j| + \alpha \sum_{j=1}^p \beta_j ^2\right)\]</span></p>
<p><span class="math display">\[= \frac{RSS}{2n}+ \lambda\left( ({1-\alpha}) \sum_{j=1}^p|\beta_j| + \alpha \sum_{j=1}^p \beta_j ^2\right)\]</span></p>
<p>donde <span class="math inline">\(\alpha \in [0,1]\)</span> es el parámetro de mezcla entre la regularización <em>Ridge</em> <span class="math inline">\((\alpha = 0)\)</span> y la regularización <em>Lasso</em> <span class="math inline">\((\alpha = 1)\)</span>.</p>
<p>La combinación de ambas penalizaciones suele dar lugar a buenos resultados. Una estrategia frecuentemente utilizada es asignarle casi todo el peso a la penalización <em>L1</em> ( <span class="math inline">\(\alpha \approx 1\)</span>) para conseguir seleccionar predictores y menos peso a la regularización <span class="math inline">\(L2\)</span> para dar cierta estabilidad en el caso de que algunos predictores estén correlacionados.</p>
<p><img src="img/10-ml-elasticnet/elastic-net.png" width="550pt" height="400pt" style="display: block; margin: auto;" /></p>
</div>
<div id="implementación-en-r-3" class="section level2 hasAnchor" number="10.5">
<h2><span class="header-section-number">10.5</span> Implementación en R<a href="regularización-elasticnet.html#implementación-en-r-3" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div id="regresión-5" class="section level3 hasAnchor" number="10.5.1">
<h3><span class="header-section-number">10.5.1</span> Regresión<a href="regularización-elasticnet.html#regresión-5" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Utilizando el modelo <code>linear_reg()</code> del paquete <em>parsnip</em>. Hay varios mecanismos que pueden realizar la regularización/penalización, los paquetes <em>glmnet</em>, <em>sparklyr</em>, <em>keras</em> o <em>stan</em>.</p>
<p>Usemos el primero aquí. El paquete <em>glmnet</em> solo implementa un método que no es de fórmula, pero <em>parsnip</em> permitirá que se use cualquiera de ellos.</p>
<p>Cuando se utiliza la regularización, los predictores deben de centrarse y escalarse primero antes de pasar al modelo. El método de la fórmula no lo hará automáticamente, por lo que tendremos que hacerlo nosotros mismos como se hizo en la sección <strong>4.6 Preparación de conjunto de datos</strong> con la receta <code>receta_casas</code>.</p>
<p>En <em>R</em> existen dos parámetros que nos permiten hacer la regularización:</p>
<ul>
<li><p><code>penalty</code>: Es un número no negativo que representa la cantidad total de regularización (solo <em>glmnet</em>, <em>keras</em> y <em>spark</em>).</p></li>
<li><p><code>mixture</code>: Es un número entre cero y uno (inclusivo) que es la proporción de regularización <em>L1</em> en el modelo. Cuando <code>mixture = 1</code>, es un modelo de <em>Lasso</em> puro, mientras que <code>mixture = 0</code> indica que se está utilizando un modelo <em>Ridge</em>.</p></li>
</ul>
<p><strong>Paso 1: Separación inicial de datos ( test, train, KFCV )</strong></p>
<div class="sourceCode" id="cb765"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb765-1"><a href="regularización-elasticnet.html#cb765-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidymodels)</span>
<span id="cb765-2"><a href="regularización-elasticnet.html#cb765-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb765-3"><a href="regularización-elasticnet.html#cb765-3" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span>(ames)</span>
<span id="cb765-4"><a href="regularización-elasticnet.html#cb765-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb765-5"><a href="regularización-elasticnet.html#cb765-5" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">4595</span>)</span>
<span id="cb765-6"><a href="regularización-elasticnet.html#cb765-6" aria-hidden="true" tabindex="-1"></a>ames_split <span class="ot">&lt;-</span> <span class="fu">initial_split</span>(ames, <span class="at">prop =</span> <span class="fl">0.75</span>)</span>
<span id="cb765-7"><a href="regularización-elasticnet.html#cb765-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb765-8"><a href="regularización-elasticnet.html#cb765-8" aria-hidden="true" tabindex="-1"></a>ames_train <span class="ot">&lt;-</span> <span class="fu">training</span>(ames_split)</span>
<span id="cb765-9"><a href="regularización-elasticnet.html#cb765-9" aria-hidden="true" tabindex="-1"></a>ames_test  <span class="ot">&lt;-</span> <span class="fu">testing</span>(ames_split)</span>
<span id="cb765-10"><a href="regularización-elasticnet.html#cb765-10" aria-hidden="true" tabindex="-1"></a>ames_folds <span class="ot">&lt;-</span> <span class="fu">vfold_cv</span>(ames_train)</span></code></pre></div>
<p>Contando con datos de entrenamiento, procedemos a realizar el feature engineering para extraer las mejores características que permitirán realizar las estimaciones en el modelo.</p>
<p><strong>Paso 2: Pre-procesamiento e ingeniería de variables</strong></p>
<div class="sourceCode" id="cb766"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb766-1"><a href="regularización-elasticnet.html#cb766-1" aria-hidden="true" tabindex="-1"></a>receta_casas <span class="ot">&lt;-</span> <span class="fu">recipe</span>(</span>
<span id="cb766-2"><a href="regularización-elasticnet.html#cb766-2" aria-hidden="true" tabindex="-1"></a> Sale_Price <span class="sc">~</span> Gr_Liv_Area <span class="sc">+</span> TotRms_AbvGrd <span class="sc">+</span> Exter_Cond <span class="sc">+</span> Bsmt_Cond <span class="sc">+</span></span>
<span id="cb766-3"><a href="regularización-elasticnet.html#cb766-3" aria-hidden="true" tabindex="-1"></a>  Year_Sold <span class="sc">+</span> Year_Remod_Add, </span>
<span id="cb766-4"><a href="regularización-elasticnet.html#cb766-4" aria-hidden="true" tabindex="-1"></a> <span class="at">data =</span> ames_train) <span class="sc">%&gt;%</span></span>
<span id="cb766-5"><a href="regularización-elasticnet.html#cb766-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">step_mutate</span>(</span>
<span id="cb766-6"><a href="regularización-elasticnet.html#cb766-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">Age_House =</span> Year_Sold <span class="sc">-</span> Year_Remod_Add,</span>
<span id="cb766-7"><a href="regularización-elasticnet.html#cb766-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">Exter_Cond =</span> forcats<span class="sc">::</span><span class="fu">fct_collapse</span>(Exter_Cond, <span class="at">Good =</span> <span class="fu">c</span>(<span class="st">&quot;Typical&quot;</span>, <span class="st">&quot;Good&quot;</span>, <span class="st">&quot;Excellent&quot;</span>))) <span class="sc">%&gt;%</span> </span>
<span id="cb766-8"><a href="regularización-elasticnet.html#cb766-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">step_relevel</span>(Exter_Cond, <span class="at">ref_level =</span> <span class="st">&quot;Good&quot;</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb766-9"><a href="regularización-elasticnet.html#cb766-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">step_normalize</span>(<span class="fu">all_numeric_predictors</span>()) <span class="sc">%&gt;%</span></span>
<span id="cb766-10"><a href="regularización-elasticnet.html#cb766-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">step_dummy</span>(<span class="fu">all_nominal_predictors</span>()) <span class="sc">%&gt;%</span> </span>
<span id="cb766-11"><a href="regularización-elasticnet.html#cb766-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">step_interact</span>(<span class="sc">~</span> <span class="fu">matches</span>(<span class="st">&quot;Bsmt_Cond&quot;</span>)<span class="sc">:</span>TotRms_AbvGrd) <span class="sc">%&gt;%</span> </span>
<span id="cb766-12"><a href="regularización-elasticnet.html#cb766-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">prep</span>()</span>
<span id="cb766-13"><a href="regularización-elasticnet.html#cb766-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb766-14"><a href="regularización-elasticnet.html#cb766-14" aria-hidden="true" tabindex="-1"></a>receta_casas</span></code></pre></div>
<pre><code>## Recipe
## 
## Inputs:
## 
##       role #variables
##    outcome          1
##  predictor          6
## 
## Training data contained 2197 data points and no missing data.
## 
## Operations:
## 
## Variable mutation for ~Year_Sold - Year_Remod_Add, ~forcats::fct... [trained]
## Re-order factor level to ref_level for Exter_Cond [trained]
## Centering and scaling for Gr_Liv_Area, TotRms_AbvGrd, Year_Sold, Year_Rem... [trained]
## Dummy variables from Exter_Cond, Bsmt_Cond [trained]
## Interactions with (Bsmt_Cond_Fair + Bsmt_Cond_Good + Bsmt_Cond_No_Ba... [trained]</code></pre>
<p>Recordemos que la función <strong>recipe()</strong> solo son los pasos a seguir, necesitamos usar la función <strong>prep()</strong> que nos devuelve una receta actualizada con las estimaciones y la función <strong>juice()</strong> que nos devuelve la matriz de diseño.</p>
<p>Una vez que la receta de transformación de datos está lista, procedemos a implementar el pipeline del modelo de interés.</p>
<p><strong>Paso 3: Selección de tipo de modelo con hiperparámetros iniciales</strong></p>
<div class="sourceCode" id="cb768"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb768-1"><a href="regularización-elasticnet.html#cb768-1" aria-hidden="true" tabindex="-1"></a><span class="co"># install.packages(&quot;glmnet&quot;)</span></span>
<span id="cb768-2"><a href="regularización-elasticnet.html#cb768-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb768-3"><a href="regularización-elasticnet.html#cb768-3" aria-hidden="true" tabindex="-1"></a>elasticnet_regression_model <span class="ot">&lt;-</span> <span class="fu">linear_reg</span>(</span>
<span id="cb768-4"><a href="regularización-elasticnet.html#cb768-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">mixture =</span> <span class="fu">tune</span>(),</span>
<span id="cb768-5"><a href="regularización-elasticnet.html#cb768-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">penalty =</span> <span class="fu">tune</span>()) <span class="sc">%&gt;%</span> </span>
<span id="cb768-6"><a href="regularización-elasticnet.html#cb768-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">set_mode</span>(<span class="st">&quot;regression&quot;</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb768-7"><a href="regularización-elasticnet.html#cb768-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">set_engine</span>(<span class="st">&quot;glmnet&quot;</span>)</span></code></pre></div>
<p><strong>Paso 4: Inicialización de workflow o pipeline</strong></p>
<div class="sourceCode" id="cb769"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb769-1"><a href="regularización-elasticnet.html#cb769-1" aria-hidden="true" tabindex="-1"></a>elasticnet_workflow <span class="ot">&lt;-</span> <span class="fu">workflow</span>() <span class="sc">%&gt;%</span></span>
<span id="cb769-2"><a href="regularización-elasticnet.html#cb769-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">add_model</span>(elasticnet_regression_model) <span class="sc">%&gt;%</span></span>
<span id="cb769-3"><a href="regularización-elasticnet.html#cb769-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">add_recipe</span>(receta_casas)</span></code></pre></div>
<p><strong>Paso 5: Creación de grid search</strong></p>
<div class="sourceCode" id="cb770"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb770-1"><a href="regularización-elasticnet.html#cb770-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">195628</span>)</span>
<span id="cb770-2"><a href="regularización-elasticnet.html#cb770-2" aria-hidden="true" tabindex="-1"></a>elasticnet_param_grid <span class="ot">&lt;-</span> <span class="fu">grid_random</span>(</span>
<span id="cb770-3"><a href="regularización-elasticnet.html#cb770-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">penalty</span>(<span class="at">range =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">15</span>, <span class="dv">0</span>), <span class="at">trans =</span> <span class="fu">log10_trans</span>()),</span>
<span id="cb770-4"><a href="regularización-elasticnet.html#cb770-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mixture</span>(<span class="at">range =</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">1</span>)),</span>
<span id="cb770-5"><a href="regularización-elasticnet.html#cb770-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">size =</span> <span class="dv">100</span></span>
<span id="cb770-6"><a href="regularización-elasticnet.html#cb770-6" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb770-7"><a href="regularización-elasticnet.html#cb770-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb770-8"><a href="regularización-elasticnet.html#cb770-8" aria-hidden="true" tabindex="-1"></a>ctrl_grid <span class="ot">&lt;-</span> <span class="fu">control_grid</span>(<span class="at">save_pred =</span> T, <span class="at">verbose =</span> T)</span></code></pre></div>
<p><strong>Paso 6: Entrenamiento de modelos con hiperparámetros definidos</strong></p>
<div class="sourceCode" id="cb771"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb771-1"><a href="regularización-elasticnet.html#cb771-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(doParallel)</span>
<span id="cb771-2"><a href="regularización-elasticnet.html#cb771-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb771-3"><a href="regularización-elasticnet.html#cb771-3" aria-hidden="true" tabindex="-1"></a>UseCores <span class="ot">&lt;-</span> <span class="fu">detectCores</span>() <span class="sc">-</span> <span class="dv">1</span></span>
<span id="cb771-4"><a href="regularización-elasticnet.html#cb771-4" aria-hidden="true" tabindex="-1"></a>cluster <span class="ot">&lt;-</span> <span class="fu">makeCluster</span>(UseCores)</span>
<span id="cb771-5"><a href="regularización-elasticnet.html#cb771-5" aria-hidden="true" tabindex="-1"></a><span class="fu">registerDoParallel</span>(cluster)</span>
<span id="cb771-6"><a href="regularización-elasticnet.html#cb771-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb771-7"><a href="regularización-elasticnet.html#cb771-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Ajuste de parámetros</span></span>
<span id="cb771-8"><a href="regularización-elasticnet.html#cb771-8" aria-hidden="true" tabindex="-1"></a>elt1 <span class="ot">&lt;-</span> <span class="fu">Sys.time</span>()</span>
<span id="cb771-9"><a href="regularización-elasticnet.html#cb771-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb771-10"><a href="regularización-elasticnet.html#cb771-10" aria-hidden="true" tabindex="-1"></a>elasticnet_tune_result <span class="ot">&lt;-</span> <span class="fu">tune_grid</span>(</span>
<span id="cb771-11"><a href="regularización-elasticnet.html#cb771-11" aria-hidden="true" tabindex="-1"></a>  elasticnet_workflow,</span>
<span id="cb771-12"><a href="regularización-elasticnet.html#cb771-12" aria-hidden="true" tabindex="-1"></a>  <span class="at">resamples =</span> ames_folds,</span>
<span id="cb771-13"><a href="regularización-elasticnet.html#cb771-13" aria-hidden="true" tabindex="-1"></a>  <span class="at">grid =</span> elasticnet_param_grid,</span>
<span id="cb771-14"><a href="regularización-elasticnet.html#cb771-14" aria-hidden="true" tabindex="-1"></a>  <span class="at">metrics =</span> <span class="fu">metric_set</span>(mae, mape, rmse, rsq),</span>
<span id="cb771-15"><a href="regularización-elasticnet.html#cb771-15" aria-hidden="true" tabindex="-1"></a>  <span class="at">control =</span> ctrl_grid</span>
<span id="cb771-16"><a href="regularización-elasticnet.html#cb771-16" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb771-17"><a href="regularización-elasticnet.html#cb771-17" aria-hidden="true" tabindex="-1"></a>elt2 <span class="ot">&lt;-</span> <span class="fu">Sys.time</span>(); elt2 <span class="sc">-</span> elt1</span>
<span id="cb771-18"><a href="regularización-elasticnet.html#cb771-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb771-19"><a href="regularización-elasticnet.html#cb771-19" aria-hidden="true" tabindex="-1"></a><span class="fu">stopCluster</span>(cluster)</span>
<span id="cb771-20"><a href="regularización-elasticnet.html#cb771-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb771-21"><a href="regularización-elasticnet.html#cb771-21" aria-hidden="true" tabindex="-1"></a>elasticnet_tune_result <span class="sc">%&gt;%</span> <span class="fu">saveRDS</span>(<span class="st">&quot;models/elasticnet_model_reg.rds&quot;</span>)</span></code></pre></div>
<div class="sourceCode" id="cb772"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb772-1"><a href="regularización-elasticnet.html#cb772-1" aria-hidden="true" tabindex="-1"></a>elasticnet_tune_result <span class="ot">&lt;-</span> <span class="fu">readRDS</span>(<span class="st">&quot;models/elasticnet_model_reg.rds&quot;</span>)</span></code></pre></div>
<p><strong>Paso 7: Análisis de métricas de error e hiperparámetros (Vuelve al paso 3, si es necesario)</strong></p>
<p>Podemos obtener las métricas de cada <em>fold</em> con el siguiente código:</p>
<div class="sourceCode" id="cb773"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb773-1"><a href="regularización-elasticnet.html#cb773-1" aria-hidden="true" tabindex="-1"></a><span class="fu">collect_metrics</span>(elasticnet_tune_result)</span></code></pre></div>
<pre><code>## # A tibble: 400 × 8
##     penalty mixture .metric .estimator      mean     n   std_err .config        
##       &lt;dbl&gt;   &lt;dbl&gt; &lt;chr&gt;   &lt;chr&gt;          &lt;dbl&gt; &lt;int&gt;     &lt;dbl&gt; &lt;chr&gt;          
##  1 3.81e-12  0.0139 mae     standard   32607.       10  544.     Preprocessor1_…
##  2 3.81e-12  0.0139 mape    standard      19.1      10    0.268  Preprocessor1_…
##  3 3.81e-12  0.0139 rmse    standard   48347.       10 1024.     Preprocessor1_…
##  4 3.81e-12  0.0139 rsq     standard       0.641    10    0.0176 Preprocessor1_…
##  5 4.32e- 2  0.0160 mae     standard   32609.       10  543.     Preprocessor1_…
##  6 4.32e- 2  0.0160 mape    standard      19.1      10    0.268  Preprocessor1_…
##  7 4.32e- 2  0.0160 rmse    standard   48347.       10 1025.     Preprocessor1_…
##  8 4.32e- 2  0.0160 rsq     standard       0.641    10    0.0177 Preprocessor1_…
##  9 7.31e- 8  0.0361 mae     standard   32617.       10  541.     Preprocessor1_…
## 10 7.31e- 8  0.0361 mape    standard      19.1      10    0.268  Preprocessor1_…
## # … with 390 more rows</code></pre>
<p>En la siguiente gráfica observamos las distintas métricas de error asociados a los hiperparámetros elegidos:</p>
<div class="sourceCode" id="cb775"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb775-1"><a href="regularización-elasticnet.html#cb775-1" aria-hidden="true" tabindex="-1"></a>elasticnet_tune_result <span class="sc">%&gt;%</span> <span class="fu">autoplot</span>()</span></code></pre></div>
<p><img src="amt22_aserta_intro2dsml_files/figure-html/unnamed-chunk-550-1.png" width="672" /></p>
<p>En la siguiente gráfica observamos el error cuadrático medio de las distintas métricas con distintos números de vecinos.</p>
<div class="sourceCode" id="cb776"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb776-1"><a href="regularización-elasticnet.html#cb776-1" aria-hidden="true" tabindex="-1"></a>elasticnet_tune_result <span class="sc">%&gt;%</span> <span class="fu">autoplot</span>(<span class="at">metric =</span> <span class="st">&quot;rsq&quot;</span>)</span></code></pre></div>
<p><img src="amt22_aserta_intro2dsml_files/figure-html/unnamed-chunk-551-1.png" width="672" /></p>
<p><strong>Paso 8: Selección de modelo a usar</strong></p>
<p>Con el siguiente código obtenemos los mejores 10 modelos respecto al <em>rmse</em>.</p>
<div class="sourceCode" id="cb777"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb777-1"><a href="regularización-elasticnet.html#cb777-1" aria-hidden="true" tabindex="-1"></a><span class="fu">show_best</span>(elasticnet_tune_result, <span class="at">n =</span> <span class="dv">10</span>, <span class="at">metric =</span> <span class="st">&quot;rmse&quot;</span>)</span></code></pre></div>
<pre><code>## # A tibble: 10 × 8
##     penalty mixture .metric .estimator   mean     n std_err .config             
##       &lt;dbl&gt;   &lt;dbl&gt; &lt;chr&gt;   &lt;chr&gt;       &lt;dbl&gt; &lt;int&gt;   &lt;dbl&gt; &lt;chr&gt;               
##  1 6.18e- 2  0.306  rmse    standard   48342.    10   1029. Preprocessor1_Model…
##  2 3.03e-11  0.301  rmse    standard   48344.    10   1030. Preprocessor1_Model…
##  3 8.01e- 6  0.301  rmse    standard   48344.    10   1030. Preprocessor1_Model…
##  4 9.54e-12  0.246  rmse    standard   48346.    10   1030. Preprocessor1_Model…
##  5 1.27e- 8  0.278  rmse    standard   48346.    10   1030. Preprocessor1_Model…
##  6 1.62e-15  0.252  rmse    standard   48346.    10   1029. Preprocessor1_Model…
##  7 1.91e- 9  0.283  rmse    standard   48346.    10   1030. Preprocessor1_Model…
##  8 2.17e-15  0.269  rmse    standard   48346.    10   1030. Preprocessor1_Model…
##  9 6.99e- 5  0.283  rmse    standard   48346.    10   1030. Preprocessor1_Model…
## 10 3.81e-12  0.0139 rmse    standard   48347.    10   1024. Preprocessor1_Model…</code></pre>
<p>Ahora obtendremos el modelo que mejor desempeño tiene tomando en cuenta el <em>rmse</em> y haremos las predicciones del conjunto de prueba con este modelo.</p>
<div class="sourceCode" id="cb779"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb779-1"><a href="regularización-elasticnet.html#cb779-1" aria-hidden="true" tabindex="-1"></a>best_elasticnet_regression_model <span class="ot">&lt;-</span> <span class="fu">select_best</span>(elasticnet_tune_result, <span class="at">metric =</span> <span class="st">&quot;rmse&quot;</span>)</span>
<span id="cb779-2"><a href="regularización-elasticnet.html#cb779-2" aria-hidden="true" tabindex="-1"></a>best_elasticnet_regression_model</span></code></pre></div>
<pre><code>## # A tibble: 1 × 3
##   penalty mixture .config               
##     &lt;dbl&gt;   &lt;dbl&gt; &lt;chr&gt;                 
## 1  0.0618   0.306 Preprocessor1_Model027</code></pre>
<p><strong>Paso 9: Ajuste de modelo final con todos los datos (Vuelve al paso 2, si es necesario)</strong></p>
<div class="sourceCode" id="cb781"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb781-1"><a href="regularización-elasticnet.html#cb781-1" aria-hidden="true" tabindex="-1"></a>final_elasticnet_regression_model <span class="ot">&lt;-</span> elasticnet_workflow <span class="sc">%&gt;%</span></span>
<span id="cb781-2"><a href="regularización-elasticnet.html#cb781-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">finalize_workflow</span>(best_elasticnet_regression_model) <span class="sc">%&gt;%</span></span>
<span id="cb781-3"><a href="regularización-elasticnet.html#cb781-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">fit</span>(<span class="at">data =</span> ames_train)</span></code></pre></div>
<p>Este último objeto es el modelo final entrenado, el cual contiene toda la información del pre-procesamiento de datos, por lo que en caso de ponerse en producción el modelo, sólo se necesita de este último elemento para poder realizar nuevas predicciones.</p>
<p>Antes de pasar al siguiente paso, es importante validar que hayamos hecho un uso correcto de las variables predictivas. En este momento es posible detectar variables que no estén aportando valor o variables que no debiéramos estar usando debido a que cometeríamos <a href="https://towardsdatascience.com/data-leakage-in-machine-learning-6161c167e8ba">data leakage</a>. Para enfrentar esto, ayuda estimar y ordenar el valor de importancia de cada variable en el modelo.</p>
<div class="sourceCode" id="cb782"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb782-1"><a href="regularización-elasticnet.html#cb782-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(vip)</span>
<span id="cb782-2"><a href="regularización-elasticnet.html#cb782-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb782-3"><a href="regularización-elasticnet.html#cb782-3" aria-hidden="true" tabindex="-1"></a>final_elasticnet_regression_model <span class="sc">%&gt;%</span> </span>
<span id="cb782-4"><a href="regularización-elasticnet.html#cb782-4" aria-hidden="true" tabindex="-1"></a> <span class="fu">extract_fit_parsnip</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb782-5"><a href="regularización-elasticnet.html#cb782-5" aria-hidden="true" tabindex="-1"></a> <span class="fu">vip</span>(<span class="at">geom =</span> <span class="st">&quot;col&quot;</span>) <span class="sc">+</span> </span>
<span id="cb782-6"><a href="regularización-elasticnet.html#cb782-6" aria-hidden="true" tabindex="-1"></a> <span class="fu">ggtitle</span>(<span class="st">&quot;Importancia de las variables&quot;</span>)</span></code></pre></div>
<p><img src="amt22_aserta_intro2dsml_files/figure-html/unnamed-chunk-555-1.png" width="672" /></p>
<p><strong>Paso 10: Validar poder predictivo con datos de prueba</strong></p>
<p>Imaginemos por un momento que pasa un mes de tiempo desde que hicimos nuestro modelo, es hora de ponerlo a prueba prediciendo valores de nuevos elementos:</p>
<div class="sourceCode" id="cb783"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb783-1"><a href="regularización-elasticnet.html#cb783-1" aria-hidden="true" tabindex="-1"></a>results <span class="ot">&lt;-</span> <span class="fu">predict</span>(final_elasticnet_regression_model, ames_test) <span class="sc">%&gt;%</span></span>
<span id="cb783-2"><a href="regularización-elasticnet.html#cb783-2" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">bind_cols</span>(<span class="at">Sale_Price =</span> ames_test<span class="sc">$</span>Sale_Price) <span class="sc">%&gt;%</span></span>
<span id="cb783-3"><a href="regularización-elasticnet.html#cb783-3" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">rename</span>(<span class="at">pred_elasticnet_reg =</span> .pred)</span>
<span id="cb783-4"><a href="regularización-elasticnet.html#cb783-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb783-5"><a href="regularización-elasticnet.html#cb783-5" aria-hidden="true" tabindex="-1"></a>results</span></code></pre></div>
<pre><code>## # A tibble: 733 × 2
##    pred_elasticnet_reg Sale_Price
##                  &lt;dbl&gt;      &lt;int&gt;
##  1              95091.     105000
##  2             175072.     185000
##  3             189332.     180400
##  4              85542.     141000
##  5             244179.     210000
##  6             214542.     216000
##  7             164313.     149900
##  8             122589.     105500
##  9             122589.      88000
## 10             164965.     146000
## # … with 723 more rows</code></pre>
<p><strong>Métricas de desempeño</strong></p>
<p>Ahora para calcular las métricas de desempeño usaremos la paquetería <em>MLmetrics</em>. Es posible definir nuestro propio conjunto de métricas que deseamos reportar creando el objeto <em>metric_set</em>:</p>
<div class="sourceCode" id="cb785"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb785-1"><a href="regularización-elasticnet.html#cb785-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(MLmetrics)</span>
<span id="cb785-2"><a href="regularización-elasticnet.html#cb785-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb785-3"><a href="regularización-elasticnet.html#cb785-3" aria-hidden="true" tabindex="-1"></a>multi_metric <span class="ot">&lt;-</span> <span class="fu">metric_set</span>(mae, mape, rmse, rsq, ccc)</span>
<span id="cb785-4"><a href="regularización-elasticnet.html#cb785-4" aria-hidden="true" tabindex="-1"></a><span class="fu">multi_metric</span>(results, <span class="at">truth =</span> Sale_Price, <span class="at">estimate =</span> pred_elasticnet_reg) <span class="sc">%&gt;%</span> </span>
<span id="cb785-5"><a href="regularización-elasticnet.html#cb785-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">.estimate =</span> <span class="fu">round</span>(.estimate, <span class="dv">2</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb785-6"><a href="regularización-elasticnet.html#cb785-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">-</span>.estimator)</span></code></pre></div>
<pre><code>## # A tibble: 5 × 2
##   .metric .estimate
##   &lt;chr&gt;       &lt;dbl&gt;
## 1 mae      34092   
## 2 mape        20.2 
## 3 rmse     49397   
## 4 rsq          0.63
## 5 ccc          0.76</code></pre>
<div class="sourceCode" id="cb787"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb787-1"><a href="regularización-elasticnet.html#cb787-1" aria-hidden="true" tabindex="-1"></a>results <span class="sc">%&gt;%</span> </span>
<span id="cb787-2"><a href="regularización-elasticnet.html#cb787-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> pred_elasticnet_reg, <span class="at">y =</span> Sale_Price)) <span class="sc">+</span></span>
<span id="cb787-3"><a href="regularización-elasticnet.html#cb787-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb787-4"><a href="regularización-elasticnet.html#cb787-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_abline</span>(<span class="at">color =</span> <span class="st">&quot;red&quot;</span>) <span class="sc">+</span></span>
<span id="cb787-5"><a href="regularización-elasticnet.html#cb787-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">&quot;Prediction&quot;</span>) <span class="sc">+</span></span>
<span id="cb787-6"><a href="regularización-elasticnet.html#cb787-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">&quot;Observation&quot;</span>) <span class="sc">+</span></span>
<span id="cb787-7"><a href="regularización-elasticnet.html#cb787-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">&quot;Comparisson&quot;</span>)</span></code></pre></div>
<p><img src="amt22_aserta_intro2dsml_files/figure-html/unnamed-chunk-558-1.png" width="672" /></p>
</div>
<div id="clasificación-6" class="section level3 hasAnchor" number="10.5.2">
<h3><span class="header-section-number">10.5.2</span> Clasificación<a href="regularización-elasticnet.html#clasificación-6" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p><strong>Paso 1: Separación inicial de datos (test, train)</strong></p>
<div class="sourceCode" id="cb788"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb788-1"><a href="regularización-elasticnet.html#cb788-1" aria-hidden="true" tabindex="-1"></a>telco <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="st">&quot;data/Churn.csv&quot;</span>)</span>
<span id="cb788-2"><a href="regularización-elasticnet.html#cb788-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb788-3"><a href="regularización-elasticnet.html#cb788-3" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1234</span>)</span>
<span id="cb788-4"><a href="regularización-elasticnet.html#cb788-4" aria-hidden="true" tabindex="-1"></a>telco_split <span class="ot">&lt;-</span> <span class="fu">initial_split</span>(telco, <span class="at">prop =</span> .<span class="dv">70</span>)</span>
<span id="cb788-5"><a href="regularización-elasticnet.html#cb788-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb788-6"><a href="regularización-elasticnet.html#cb788-6" aria-hidden="true" tabindex="-1"></a>telco_train <span class="ot">&lt;-</span> <span class="fu">training</span>(telco_split)</span>
<span id="cb788-7"><a href="regularización-elasticnet.html#cb788-7" aria-hidden="true" tabindex="-1"></a>telco_test  <span class="ot">&lt;-</span> <span class="fu">testing</span>(telco_split)</span>
<span id="cb788-8"><a href="regularización-elasticnet.html#cb788-8" aria-hidden="true" tabindex="-1"></a>telco_folds <span class="ot">&lt;-</span> <span class="fu">vfold_cv</span>(telco_train)</span>
<span id="cb788-9"><a href="regularización-elasticnet.html#cb788-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb788-10"><a href="regularización-elasticnet.html#cb788-10" aria-hidden="true" tabindex="-1"></a>telco_folds</span></code></pre></div>
<pre><code>## #  10-fold cross-validation 
## # A tibble: 10 × 2
##    splits             id    
##    &lt;list&gt;             &lt;chr&gt; 
##  1 &lt;split [4437/493]&gt; Fold01
##  2 &lt;split [4437/493]&gt; Fold02
##  3 &lt;split [4437/493]&gt; Fold03
##  4 &lt;split [4437/493]&gt; Fold04
##  5 &lt;split [4437/493]&gt; Fold05
##  6 &lt;split [4437/493]&gt; Fold06
##  7 &lt;split [4437/493]&gt; Fold07
##  8 &lt;split [4437/493]&gt; Fold08
##  9 &lt;split [4437/493]&gt; Fold09
## 10 &lt;split [4437/493]&gt; Fold10</code></pre>
<p><strong>Paso 2: Pre-procesamiento e ingeniería de variables</strong></p>
<div class="sourceCode" id="cb790"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb790-1"><a href="regularización-elasticnet.html#cb790-1" aria-hidden="true" tabindex="-1"></a>telco_rec <span class="ot">&lt;-</span> <span class="fu">recipe</span>(</span>
<span id="cb790-2"><a href="regularización-elasticnet.html#cb790-2" aria-hidden="true" tabindex="-1"></a>  Churn <span class="sc">~</span> customerID <span class="sc">+</span> TotalCharges <span class="sc">+</span> MonthlyCharges <span class="sc">+</span> SeniorCitizen <span class="sc">+</span> Contract, </span>
<span id="cb790-3"><a href="regularización-elasticnet.html#cb790-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> telco_train) <span class="sc">%&gt;%</span> </span>
<span id="cb790-4"><a href="regularización-elasticnet.html#cb790-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">update_role</span>(customerID, <span class="at">new_role =</span> <span class="st">&quot;id variable&quot;</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb790-5"><a href="regularización-elasticnet.html#cb790-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">step_mutate</span>(<span class="at">Contract =</span> <span class="fu">as.factor</span>(Contract)) <span class="sc">%&gt;%</span> </span>
<span id="cb790-6"><a href="regularización-elasticnet.html#cb790-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">step_impute_median</span>(<span class="fu">all_numeric_predictors</span>()) <span class="sc">%&gt;%</span> </span>
<span id="cb790-7"><a href="regularización-elasticnet.html#cb790-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">step_normalize</span>(<span class="fu">all_numeric_predictors</span>()) <span class="sc">%&gt;%</span> </span>
<span id="cb790-8"><a href="regularización-elasticnet.html#cb790-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">step_dummy</span>(<span class="fu">all_nominal_predictors</span>()) <span class="sc">%&gt;%</span> </span>
<span id="cb790-9"><a href="regularización-elasticnet.html#cb790-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">prep</span>()</span>
<span id="cb790-10"><a href="regularización-elasticnet.html#cb790-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb790-11"><a href="regularización-elasticnet.html#cb790-11" aria-hidden="true" tabindex="-1"></a>telco_rec</span></code></pre></div>
<pre><code>## Recipe
## 
## Inputs:
## 
##         role #variables
##  id variable          1
##      outcome          1
##    predictor          4
## 
## Training data contained 4930 data points and 10 incomplete rows. 
## 
## Operations:
## 
## Variable mutation for ~as.factor(Contract) [trained]
## Median imputation for TotalCharges, MonthlyCharges, SeniorCitizen [trained]
## Centering and scaling for TotalCharges, MonthlyCharges, SeniorCitizen [trained]
## Dummy variables from Contract [trained]</code></pre>
<p><strong>Paso 3: Selección de tipo de modelo con hiperparámetros iniciales</strong></p>
<div class="sourceCode" id="cb792"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb792-1"><a href="regularización-elasticnet.html#cb792-1" aria-hidden="true" tabindex="-1"></a>elasticnet_class_model <span class="ot">&lt;-</span> <span class="fu">logistic_reg</span>(</span>
<span id="cb792-2"><a href="regularización-elasticnet.html#cb792-2" aria-hidden="true" tabindex="-1"></a>   <span class="at">mixture =</span> <span class="fu">tune</span>(), </span>
<span id="cb792-3"><a href="regularización-elasticnet.html#cb792-3" aria-hidden="true" tabindex="-1"></a>   <span class="at">penalty =</span> <span class="fu">tune</span>()) <span class="sc">%&gt;%</span> </span>
<span id="cb792-4"><a href="regularización-elasticnet.html#cb792-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">set_mode</span>(<span class="st">&#39;classification&#39;</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb792-5"><a href="regularización-elasticnet.html#cb792-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">set_engine</span>(<span class="st">&quot;glmnet&quot;</span>) </span>
<span id="cb792-6"><a href="regularización-elasticnet.html#cb792-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb792-7"><a href="regularización-elasticnet.html#cb792-7" aria-hidden="true" tabindex="-1"></a>elasticnet_class_model</span></code></pre></div>
<pre><code>## Logistic Regression Model Specification (classification)
## 
## Main Arguments:
##   penalty = tune()
##   mixture = tune()
## 
## Computational engine: glmnet</code></pre>
<p><strong>Paso 4: Inicialización de workflow o pipeline</strong></p>
<div class="sourceCode" id="cb794"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb794-1"><a href="regularización-elasticnet.html#cb794-1" aria-hidden="true" tabindex="-1"></a>elasticnet_workflow <span class="ot">&lt;-</span> <span class="fu">workflow</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb794-2"><a href="regularización-elasticnet.html#cb794-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">add_model</span>(elasticnet_class_model) <span class="sc">%&gt;%</span> </span>
<span id="cb794-3"><a href="regularización-elasticnet.html#cb794-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">add_recipe</span>(telco_rec)</span>
<span id="cb794-4"><a href="regularización-elasticnet.html#cb794-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb794-5"><a href="regularización-elasticnet.html#cb794-5" aria-hidden="true" tabindex="-1"></a>elasticnet_workflow</span></code></pre></div>
<pre><code>## ══ Workflow ══════════════════
## Preprocessor: Recipe
## Model: logistic_reg()
## 
## ── Preprocessor ──────────────
## 4 Recipe Steps
## 
## • step_mutate()
## • step_impute_median()
## • step_normalize()
## • step_dummy()
## 
## ── Model ─────────────────────
## Logistic Regression Model Specification (classification)
## 
## Main Arguments:
##   penalty = tune()
##   mixture = tune()
## 
## Computational engine: glmnet</code></pre>
<p><strong>Paso 5: Creación de grid search</strong></p>
<div class="sourceCode" id="cb796"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb796-1"><a href="regularización-elasticnet.html#cb796-1" aria-hidden="true" tabindex="-1"></a>elasticnet_param_grid <span class="ot">&lt;-</span> <span class="fu">grid_random</span>(</span>
<span id="cb796-2"><a href="regularización-elasticnet.html#cb796-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">penalty</span>(</span>
<span id="cb796-3"><a href="regularización-elasticnet.html#cb796-3" aria-hidden="true" tabindex="-1"></a>    <span class="at">range =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">4</span>, <span class="fl">0.1</span>),</span>
<span id="cb796-4"><a href="regularización-elasticnet.html#cb796-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">trans =</span> <span class="fu">log10_trans</span>()</span>
<span id="cb796-5"><a href="regularización-elasticnet.html#cb796-5" aria-hidden="true" tabindex="-1"></a>  ),</span>
<span id="cb796-6"><a href="regularización-elasticnet.html#cb796-6" aria-hidden="true" tabindex="-1"></a>  dials<span class="sc">::</span><span class="fu">mixture</span>(<span class="at">range =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">1</span>)),</span>
<span id="cb796-7"><a href="regularización-elasticnet.html#cb796-7" aria-hidden="true" tabindex="-1"></a>  <span class="at">size =</span> <span class="dv">50</span></span>
<span id="cb796-8"><a href="regularización-elasticnet.html#cb796-8" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb796-9"><a href="regularización-elasticnet.html#cb796-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb796-10"><a href="regularización-elasticnet.html#cb796-10" aria-hidden="true" tabindex="-1"></a>elasticnet_param_grid</span></code></pre></div>
<pre><code>## # A tibble: 50 × 2
##     penalty mixture
##       &lt;dbl&gt;   &lt;dbl&gt;
##  1 0.000172   0.756
##  2 0.194      0.460
##  3 0.0430     0.978
##  4 0.0102     0.909
##  5 0.000735   0.635
##  6 0.00285    0.129
##  7 0.172      0.965
##  8 0.0433     0.723
##  9 0.000138   0.643
## 10 0.000504   0.239
## # … with 40 more rows</code></pre>
<p><strong>Paso 6: Entrenamiento de modelos con hiperparámetros definidos</strong></p>
<div class="sourceCode" id="cb798"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb798-1"><a href="regularización-elasticnet.html#cb798-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(doParallel)</span>
<span id="cb798-2"><a href="regularización-elasticnet.html#cb798-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb798-3"><a href="regularización-elasticnet.html#cb798-3" aria-hidden="true" tabindex="-1"></a>UseCores <span class="ot">&lt;-</span> <span class="fu">detectCores</span>() <span class="sc">-</span> <span class="dv">1</span></span>
<span id="cb798-4"><a href="regularización-elasticnet.html#cb798-4" aria-hidden="true" tabindex="-1"></a>cluster <span class="ot">&lt;-</span> <span class="fu">makeCluster</span>(UseCores)</span>
<span id="cb798-5"><a href="regularización-elasticnet.html#cb798-5" aria-hidden="true" tabindex="-1"></a><span class="fu">registerDoParallel</span>(cluster)</span>
<span id="cb798-6"><a href="regularización-elasticnet.html#cb798-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb798-7"><a href="regularización-elasticnet.html#cb798-7" aria-hidden="true" tabindex="-1"></a>ctrl_grid <span class="ot">&lt;-</span> <span class="fu">control_grid</span>(<span class="at">save_pred =</span> T, <span class="at">verbose =</span> T)</span>
<span id="cb798-8"><a href="regularización-elasticnet.html#cb798-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb798-9"><a href="regularización-elasticnet.html#cb798-9" aria-hidden="true" tabindex="-1"></a>etnt1 <span class="ot">&lt;-</span> <span class="fu">Sys.time</span>()</span>
<span id="cb798-10"><a href="regularización-elasticnet.html#cb798-10" aria-hidden="true" tabindex="-1"></a>elasticnet_tune_result <span class="ot">&lt;-</span> <span class="fu">tune_grid</span>(</span>
<span id="cb798-11"><a href="regularización-elasticnet.html#cb798-11" aria-hidden="true" tabindex="-1"></a>  elasticnet_workflow,</span>
<span id="cb798-12"><a href="regularización-elasticnet.html#cb798-12" aria-hidden="true" tabindex="-1"></a>  <span class="at">resamples =</span> telco_folds,</span>
<span id="cb798-13"><a href="regularización-elasticnet.html#cb798-13" aria-hidden="true" tabindex="-1"></a>  <span class="at">grid =</span> elasticnet_param_grid,</span>
<span id="cb798-14"><a href="regularización-elasticnet.html#cb798-14" aria-hidden="true" tabindex="-1"></a>  <span class="at">metrics =</span> <span class="fu">metric_set</span>(roc_auc, pr_auc)</span>
<span id="cb798-15"><a href="regularización-elasticnet.html#cb798-15" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb798-16"><a href="regularización-elasticnet.html#cb798-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb798-17"><a href="regularización-elasticnet.html#cb798-17" aria-hidden="true" tabindex="-1"></a>etn2 <span class="ot">&lt;-</span> <span class="fu">Sys.time</span>(); etn2 <span class="sc">-</span> etnt1</span>
<span id="cb798-18"><a href="regularización-elasticnet.html#cb798-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb798-19"><a href="regularización-elasticnet.html#cb798-19" aria-hidden="true" tabindex="-1"></a><span class="fu">stopCluster</span>(cluster)</span>
<span id="cb798-20"><a href="regularización-elasticnet.html#cb798-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb798-21"><a href="regularización-elasticnet.html#cb798-21" aria-hidden="true" tabindex="-1"></a>elasticnet_tune_result <span class="sc">%&gt;%</span> <span class="fu">saveRDS</span>(<span class="st">&quot;models/elasticnet_class_model.rds&quot;</span>)</span></code></pre></div>
<p><strong>Paso 7: Análisis de métricas de error e hiperparámetros (Vuelve al paso 3, si es necesario)</strong></p>
<div class="sourceCode" id="cb799"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb799-1"><a href="regularización-elasticnet.html#cb799-1" aria-hidden="true" tabindex="-1"></a>elasticnet_tune_result <span class="ot">&lt;-</span> <span class="fu">readRDS</span>(<span class="st">&quot;models/elasticnet_class_model.rds&quot;</span>)</span>
<span id="cb799-2"><a href="regularización-elasticnet.html#cb799-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb799-3"><a href="regularización-elasticnet.html#cb799-3" aria-hidden="true" tabindex="-1"></a><span class="fu">collect_metrics</span>(elasticnet_tune_result)</span></code></pre></div>
<pre><code>## # A tibble: 100 × 8
##     penalty  mixture .metric .estimator  mean     n std_err .config             
##       &lt;dbl&gt;    &lt;dbl&gt; &lt;chr&gt;   &lt;chr&gt;      &lt;dbl&gt; &lt;int&gt;   &lt;dbl&gt; &lt;chr&gt;               
##  1 0.0494   0.000985 pr_auc  binary     0.928    10 0.00365 Preprocessor1_Model…
##  2 0.0494   0.000985 roc_auc binary     0.822    10 0.00629 Preprocessor1_Model…
##  3 0.000837 0.0152   pr_auc  binary     0.928    10 0.00362 Preprocessor1_Model…
##  4 0.000837 0.0152   roc_auc binary     0.823    10 0.00626 Preprocessor1_Model…
##  5 0.181    0.0240   pr_auc  binary     0.927    10 0.00381 Preprocessor1_Model…
##  6 0.181    0.0240   roc_auc binary     0.819    10 0.00643 Preprocessor1_Model…
##  7 0.155    0.0244   pr_auc  binary     0.927    10 0.00380 Preprocessor1_Model…
##  8 0.155    0.0244   roc_auc binary     0.819    10 0.00645 Preprocessor1_Model…
##  9 0.0147   0.0368   pr_auc  binary     0.929    10 0.00359 Preprocessor1_Model…
## 10 0.0147   0.0368   roc_auc binary     0.823    10 0.00626 Preprocessor1_Model…
## # … with 90 more rows</code></pre>
<p>En la siguiente gráfica observamos las distintas métricas de error asociados a los hiperparámetros elegidos:</p>
<div class="sourceCode" id="cb801"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb801-1"><a href="regularización-elasticnet.html#cb801-1" aria-hidden="true" tabindex="-1"></a><span class="fu">autoplot</span>(elasticnet_tune_result)</span></code></pre></div>
<p><img src="amt22_aserta_intro2dsml_files/figure-html/unnamed-chunk-566-1.png" width="672" /></p>
<div class="sourceCode" id="cb802"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb802-1"><a href="regularización-elasticnet.html#cb802-1" aria-hidden="true" tabindex="-1"></a><span class="fu">show_best</span>(elasticnet_tune_result, <span class="at">n =</span> <span class="dv">10</span>, <span class="at">metric =</span> <span class="st">&quot;roc_auc&quot;</span>) </span></code></pre></div>
<pre><code>## # A tibble: 10 × 8
##     penalty mixture .metric .estimator  mean     n std_err .config              
##       &lt;dbl&gt;   &lt;dbl&gt; &lt;chr&gt;   &lt;chr&gt;      &lt;dbl&gt; &lt;int&gt;   &lt;dbl&gt; &lt;chr&gt;                
##  1 0.00333   0.0764 roc_auc binary     0.823    10 0.00627 Preprocessor1_Model07
##  2 0.00561   0.174  roc_auc binary     0.823    10 0.00628 Preprocessor1_Model11
##  3 0.00513   0.710  roc_auc binary     0.823    10 0.00626 Preprocessor1_Model34
##  4 0.00283   0.739  roc_auc binary     0.823    10 0.00626 Preprocessor1_Model38
##  5 0.000202  0.792  roc_auc binary     0.823    10 0.00626 Preprocessor1_Model40
##  6 0.000216  0.674  roc_auc binary     0.823    10 0.00626 Preprocessor1_Model31
##  7 0.00272   0.442  roc_auc binary     0.823    10 0.00627 Preprocessor1_Model19
##  8 0.00383   0.717  roc_auc binary     0.823    10 0.00625 Preprocessor1_Model35
##  9 0.000101  0.682  roc_auc binary     0.823    10 0.00625 Preprocessor1_Model32
## 10 0.000232  0.731  roc_auc binary     0.823    10 0.00626 Preprocessor1_Model37</code></pre>
<div class="sourceCode" id="cb804"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb804-1"><a href="regularización-elasticnet.html#cb804-1" aria-hidden="true" tabindex="-1"></a><span class="fu">show_best</span>(elasticnet_tune_result, <span class="at">n =</span> <span class="dv">10</span>, <span class="at">metric =</span> <span class="st">&quot;pr_auc&quot;</span>) </span></code></pre></div>
<pre><code>## # A tibble: 10 × 8
##    penalty mixture .metric .estimator  mean     n std_err .config              
##      &lt;dbl&gt;   &lt;dbl&gt; &lt;chr&gt;   &lt;chr&gt;      &lt;dbl&gt; &lt;int&gt;   &lt;dbl&gt; &lt;chr&gt;                
##  1 0.0197   0.369  pr_auc  binary     0.929    10 0.00357 Preprocessor1_Model18
##  2 0.0201   0.613  pr_auc  binary     0.929    10 0.00358 Preprocessor1_Model29
##  3 0.0132   0.120  pr_auc  binary     0.929    10 0.00359 Preprocessor1_Model08
##  4 0.0187   0.702  pr_auc  binary     0.929    10 0.00357 Preprocessor1_Model33
##  5 0.00513  0.710  pr_auc  binary     0.929    10 0.00361 Preprocessor1_Model34
##  6 0.0272   0.916  pr_auc  binary     0.929    10 0.00357 Preprocessor1_Model46
##  7 0.00942  0.851  pr_auc  binary     0.929    10 0.00360 Preprocessor1_Model43
##  8 0.0147   0.0368 pr_auc  binary     0.929    10 0.00359 Preprocessor1_Model05
##  9 0.00561  0.174  pr_auc  binary     0.929    10 0.00360 Preprocessor1_Model11
## 10 0.0127   0.923  pr_auc  binary     0.929    10 0.00360 Preprocessor1_Model47</code></pre>
<p><strong>Paso 8: Selección de modelo a usar</strong></p>
<div class="sourceCode" id="cb806"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb806-1"><a href="regularización-elasticnet.html#cb806-1" aria-hidden="true" tabindex="-1"></a>best_elasticnet_class_model <span class="ot">&lt;-</span> <span class="fu">select_best</span>(elasticnet_tune_result, <span class="at">metric =</span> <span class="st">&quot;pr_auc&quot;</span>)</span>
<span id="cb806-2"><a href="regularización-elasticnet.html#cb806-2" aria-hidden="true" tabindex="-1"></a>best_elasticnet_class_model</span></code></pre></div>
<pre><code>## # A tibble: 1 × 3
##   penalty mixture .config              
##     &lt;dbl&gt;   &lt;dbl&gt; &lt;chr&gt;                
## 1  0.0197   0.369 Preprocessor1_Model18</code></pre>
<div class="sourceCode" id="cb808"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb808-1"><a href="regularización-elasticnet.html#cb808-1" aria-hidden="true" tabindex="-1"></a>best_elasticnet_class_model_1se <span class="ot">&lt;-</span> elasticnet_tune_result <span class="sc">%&gt;%</span> </span>
<span id="cb808-2"><a href="regularización-elasticnet.html#cb808-2" aria-hidden="true" tabindex="-1"></a> <span class="fu">select_by_one_std_err</span>(<span class="at">metric =</span> <span class="st">&quot;pr_auc&quot;</span>, <span class="st">&quot;pr_auc&quot;</span>)</span>
<span id="cb808-3"><a href="regularización-elasticnet.html#cb808-3" aria-hidden="true" tabindex="-1"></a>best_elasticnet_class_model_1se</span></code></pre></div>
<pre><code>## # A tibble: 1 × 10
##   penalty  mixture .metric .estimator  mean     n std_err .config   .best .bound
##     &lt;dbl&gt;    &lt;dbl&gt; &lt;chr&gt;   &lt;chr&gt;      &lt;dbl&gt; &lt;int&gt;   &lt;dbl&gt; &lt;chr&gt;     &lt;dbl&gt;  &lt;dbl&gt;
## 1  0.0494 0.000985 pr_auc  binary     0.928    10 0.00365 Preproce… 0.929  0.925</code></pre>
<p><strong>Paso 9: Ajuste de modelo final con todos los datos (Vuelve al paso 2, si es necesario)</strong></p>
<div class="sourceCode" id="cb810"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb810-1"><a href="regularización-elasticnet.html#cb810-1" aria-hidden="true" tabindex="-1"></a>final_elasticnet_class_model <span class="ot">&lt;-</span> elasticnet_workflow <span class="sc">%&gt;%</span> </span>
<span id="cb810-2"><a href="regularización-elasticnet.html#cb810-2" aria-hidden="true" tabindex="-1"></a>  <span class="co">#finalize_workflow(best_elasticnet_class_model) %&gt;% </span></span>
<span id="cb810-3"><a href="regularización-elasticnet.html#cb810-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">finalize_workflow</span>(best_elasticnet_class_model_1se) <span class="sc">%&gt;%</span> </span>
<span id="cb810-4"><a href="regularización-elasticnet.html#cb810-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">fit</span>(<span class="at">data =</span> telco_test)</span></code></pre></div>
<p>Como hemos hablado anteriormente, este último objeto es el modelo final entrenado, el cual contiene toda la información del pre-procesamiento de datos, por lo que en caso de ponerse en producción el modelo, sólo se necesita de este último elemento para poder realizar nuevas predicciones.</p>
<p>Antes de pasar al siguiente paso, es importante validar que hayamos hecho un uso correcto de las variables predictivas. En este momento es posible detectar variables que no estén aportando valor o variables que no debiéramos estar usando debido a que cometeríamos data leakage. Para enfrentar esto, ayuda estimar y ordenar el valor de importancia del modelo.</p>
<div class="sourceCode" id="cb811"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb811-1"><a href="regularización-elasticnet.html#cb811-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(vip)</span>
<span id="cb811-2"><a href="regularización-elasticnet.html#cb811-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb811-3"><a href="regularización-elasticnet.html#cb811-3" aria-hidden="true" tabindex="-1"></a>final_elasticnet_class_model <span class="sc">%&gt;%</span></span>
<span id="cb811-4"><a href="regularización-elasticnet.html#cb811-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">extract_fit_parsnip</span>() <span class="sc">%&gt;%</span></span>
<span id="cb811-5"><a href="regularización-elasticnet.html#cb811-5" aria-hidden="true" tabindex="-1"></a>  vip<span class="sc">::</span><span class="fu">vip</span>() <span class="sc">+</span> </span>
<span id="cb811-6"><a href="regularización-elasticnet.html#cb811-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">&quot;Importancia de las variables&quot;</span>)</span></code></pre></div>
<p><img src="amt22_aserta_intro2dsml_files/figure-html/unnamed-chunk-571-1.png" width="672" /></p>
<p><strong>Paso 10: Validar poder predictivo con datos de prueba</strong></p>
<p>Imaginemos por un momento que pasa un mes de tiempo desde que hicimos nuestro modelo, es hora de ponerlo a prueba prediciendo valores de nuevos elementos:</p>
<div class="sourceCode" id="cb812"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb812-1"><a href="regularización-elasticnet.html#cb812-1" aria-hidden="true" tabindex="-1"></a>class_results <span class="ot">&lt;-</span> <span class="fu">predict</span>(final_elasticnet_class_model, telco_test, <span class="at">type =</span> <span class="st">&quot;prob&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb812-2"><a href="regularización-elasticnet.html#cb812-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">bind_cols</span>(<span class="at">Churn =</span> telco_test<span class="sc">$</span>Churn) <span class="sc">%&gt;%</span> </span>
<span id="cb812-3"><a href="regularización-elasticnet.html#cb812-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Churn =</span> <span class="fu">factor</span>(Churn, <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">&#39;Yes&#39;</span>, <span class="st">&#39;No&#39;</span>), <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">&#39;Yes&#39;</span>, <span class="st">&#39;No&#39;</span>))) </span>
<span id="cb812-4"><a href="regularización-elasticnet.html#cb812-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb812-5"><a href="regularización-elasticnet.html#cb812-5" aria-hidden="true" tabindex="-1"></a>class_results</span></code></pre></div>
<pre><code>## # A tibble: 2,113 × 3
##    .pred_No .pred_Yes Churn
##       &lt;dbl&gt;     &lt;dbl&gt; &lt;fct&gt;
##  1    0.848    0.152  No   
##  2    0.442    0.558  Yes  
##  3    0.715    0.285  No   
##  4    0.922    0.0782 No   
##  5    0.921    0.0788 No   
##  6    0.543    0.457  No   
##  7    0.883    0.117  No   
##  8    0.726    0.274  No   
##  9    0.700    0.300  Yes  
## 10    0.926    0.0738 No   
## # … with 2,103 more rows</code></pre>
<div class="sourceCode" id="cb814"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb814-1"><a href="regularización-elasticnet.html#cb814-1" aria-hidden="true" tabindex="-1"></a><span class="fu">bind_rows</span>(</span>
<span id="cb814-2"><a href="regularización-elasticnet.html#cb814-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">roc_auc</span>(class_results, <span class="at">truth =</span> Churn, <span class="at">estimate =</span> .pred_Yes),</span>
<span id="cb814-3"><a href="regularización-elasticnet.html#cb814-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pr_auc</span>(class_results, <span class="at">truth =</span> Churn, <span class="at">estimate =</span> .pred_Yes)</span>
<span id="cb814-4"><a href="regularización-elasticnet.html#cb814-4" aria-hidden="true" tabindex="-1"></a>)</span></code></pre></div>
<pre><code>## # A tibble: 2 × 3
##   .metric .estimator .estimate
##   &lt;chr&gt;   &lt;chr&gt;          &lt;dbl&gt;
## 1 roc_auc binary         0.824
## 2 pr_auc  binary         0.609</code></pre>
<p>A continuación, conoceremos el nivel de sensitividad y especificidad para cada punto de corte:</p>
<div class="sourceCode" id="cb816"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb816-1"><a href="regularización-elasticnet.html#cb816-1" aria-hidden="true" tabindex="-1"></a>roc_curve_data <span class="ot">&lt;-</span> <span class="fu">roc_curve</span>(</span>
<span id="cb816-2"><a href="regularización-elasticnet.html#cb816-2" aria-hidden="true" tabindex="-1"></a>  class_results, </span>
<span id="cb816-3"><a href="regularización-elasticnet.html#cb816-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">truth =</span> Churn, </span>
<span id="cb816-4"><a href="regularización-elasticnet.html#cb816-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">estimate =</span> .pred_Yes</span>
<span id="cb816-5"><a href="regularización-elasticnet.html#cb816-5" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb816-6"><a href="regularización-elasticnet.html#cb816-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb816-7"><a href="regularización-elasticnet.html#cb816-7" aria-hidden="true" tabindex="-1"></a>roc_curve_data</span></code></pre></div>
<pre><code>## # A tibble: 2,085 × 3
##    .threshold specificity sensitivity
##         &lt;dbl&gt;       &lt;dbl&gt;       &lt;dbl&gt;
##  1  -Inf         0                  1
##  2     0.0617    0                  1
##  3     0.0622    0.000646           1
##  4     0.0625    0.00129            1
##  5     0.0626    0.00194            1
##  6     0.0627    0.00259            1
##  7     0.0629    0.00323            1
##  8     0.0629    0.00388            1
##  9     0.0630    0.00452            1
## 10     0.0630    0.00517            1
## # … with 2,075 more rows</code></pre>
<p>A través de estas métricas es posible crear la curva ROC:</p>
<div class="sourceCode" id="cb818"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb818-1"><a href="regularización-elasticnet.html#cb818-1" aria-hidden="true" tabindex="-1"></a>roc_curve_plot <span class="ot">&lt;-</span> roc_curve_data <span class="sc">%&gt;%</span> </span>
<span id="cb818-2"><a href="regularización-elasticnet.html#cb818-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> <span class="dv">1</span> <span class="sc">-</span> specificity, <span class="at">y =</span> sensitivity)) <span class="sc">+</span></span>
<span id="cb818-3"><a href="regularización-elasticnet.html#cb818-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_path</span>(<span class="at">size =</span> <span class="dv">1</span>, <span class="at">colour =</span> <span class="st">&#39;lightblue&#39;</span>) <span class="sc">+</span></span>
<span id="cb818-4"><a href="regularización-elasticnet.html#cb818-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_abline</span>() <span class="sc">+</span></span>
<span id="cb818-5"><a href="regularización-elasticnet.html#cb818-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_equal</span>() <span class="sc">+</span></span>
<span id="cb818-6"><a href="regularización-elasticnet.html#cb818-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">&quot;ROC Curve&quot;</span>)<span class="sc">+</span></span>
<span id="cb818-7"><a href="regularización-elasticnet.html#cb818-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span>
<span id="cb818-8"><a href="regularización-elasticnet.html#cb818-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb818-9"><a href="regularización-elasticnet.html#cb818-9" aria-hidden="true" tabindex="-1"></a>roc_curve_plot</span></code></pre></div>
<p><img src="amt22_aserta_intro2dsml_files/figure-html/unnamed-chunk-575-1.png" width="672" /></p>
<p>De igual manera, podemos calcular la precisión y cobertura para cada punte de corte:</p>
<div class="sourceCode" id="cb819"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb819-1"><a href="regularización-elasticnet.html#cb819-1" aria-hidden="true" tabindex="-1"></a>pr_curve_data <span class="ot">&lt;-</span> <span class="fu">pr_curve</span>(</span>
<span id="cb819-2"><a href="regularización-elasticnet.html#cb819-2" aria-hidden="true" tabindex="-1"></a>  class_results, </span>
<span id="cb819-3"><a href="regularización-elasticnet.html#cb819-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">truth =</span> Churn, </span>
<span id="cb819-4"><a href="regularización-elasticnet.html#cb819-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">estimate =</span> .pred_Yes</span>
<span id="cb819-5"><a href="regularización-elasticnet.html#cb819-5" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb819-6"><a href="regularización-elasticnet.html#cb819-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb819-7"><a href="regularización-elasticnet.html#cb819-7" aria-hidden="true" tabindex="-1"></a>pr_curve_data</span></code></pre></div>
<pre><code>## # A tibble: 2,084 × 3
##    .threshold  recall precision
##         &lt;dbl&gt;   &lt;dbl&gt;     &lt;dbl&gt;
##  1    Inf     0           1    
##  2      0.695 0.00177     1    
##  3      0.666 0.00353     1    
##  4      0.660 0.00530     1    
##  5      0.644 0.00530     0.75 
##  6      0.640 0.00707     0.8  
##  7      0.638 0.00883     0.833
##  8      0.633 0.0106      0.857
##  9      0.632 0.0124      0.875
## 10      0.629 0.0141      0.889
## # … with 2,074 more rows</code></pre>
<p>Y graficar su respectiva curva:</p>
<div class="sourceCode" id="cb821"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb821-1"><a href="regularización-elasticnet.html#cb821-1" aria-hidden="true" tabindex="-1"></a>pr_curve_plot <span class="ot">&lt;-</span> pr_curve_data <span class="sc">%&gt;%</span> </span>
<span id="cb821-2"><a href="regularización-elasticnet.html#cb821-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> recall, <span class="at">y =</span> precision)) <span class="sc">+</span></span>
<span id="cb821-3"><a href="regularización-elasticnet.html#cb821-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylim</span>(<span class="dv">0</span>, <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb821-4"><a href="regularización-elasticnet.html#cb821-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_abline</span>(<span class="at">slope =</span> <span class="sc">-</span><span class="dv">1</span>, <span class="at">intercept =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb821-5"><a href="regularización-elasticnet.html#cb821-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_path</span>(<span class="at">size =</span> <span class="dv">1</span>, <span class="at">colour =</span> <span class="st">&#39;lightblue&#39;</span>) <span class="sc">+</span></span>
<span id="cb821-6"><a href="regularización-elasticnet.html#cb821-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_equal</span>() <span class="sc">+</span></span>
<span id="cb821-7"><a href="regularización-elasticnet.html#cb821-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">&quot;Precision vs Recall&quot;</span>)<span class="sc">+</span></span>
<span id="cb821-8"><a href="regularización-elasticnet.html#cb821-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span>
<span id="cb821-9"><a href="regularización-elasticnet.html#cb821-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb821-10"><a href="regularización-elasticnet.html#cb821-10" aria-hidden="true" tabindex="-1"></a>pr_curve_plot</span></code></pre></div>
<p><img src="amt22_aserta_intro2dsml_files/figure-html/unnamed-chunk-577-1.png" width="672" /></p>

<div class="watermark">
<p><img src="img/header.png" width="400"/></p>
</div>
</div>
</div>
</div>
<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
<script>

$('.pipehover_incremental tr').hover(function() {
  $(this).removeClass()
  $(this).prevAll().removeClass()
  $(this).nextAll().removeClass()
  $(this).addClass('hover');
  $(this).prevAll().addClass('hover');
  $(this).closest('div').next().find('img').attr("src", $(this).attr("link"));
});


$('.pipehover_select_one_row tr').hover(function() {
  $(this).removeClass()
  $(this).prevAll().removeClass()
  $(this).nextAll().removeClass()
  $(this).addClass('hover');
  $(this).closest('div').next().find('img').attr("src", $(this).attr("link"));
});

</script>
            </section>

          </div>
        </div>
      </div>
<a href="árboles-de-decisión.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="workflowsets-stacking.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["amt22_aserta_intro2dsml.pdf"],
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/latest.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
